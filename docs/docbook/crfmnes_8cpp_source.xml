<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_crfmnes_8cpp_source" xml:lang="en-US">
<title>crfmnes.cpp</title>
<indexterm><primary>_fcmaescpp/crfmnes.cpp</primary></indexterm>
Go to the documentation of this file.<programlisting linenumbering="unnumbered"><anchor xml:id="_crfmnes_8cpp_source_1l00001"/>00001 <emphasis role="comment">//&#32;Copyright&#32;(c)&#32;Dietmar&#32;Wolz.</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00002"/>00002 <emphasis role="comment">//</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00003"/>00003 <emphasis role="comment">//&#32;This&#32;source&#32;code&#32;is&#32;licensed&#32;under&#32;the&#32;MIT&#32;license&#32;found&#32;in&#32;the</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00004"/>00004 <emphasis role="comment">//&#32;LICENSE&#32;file&#32;in&#32;the&#32;root&#32;directory.</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00005"/>00005 
<anchor xml:id="_crfmnes_8cpp_source_1l00006"/>00006 <emphasis role="comment">//&#32;Eigen&#32;based&#32;implementation&#32;of&#32;Fast&#32;Moving&#32;Natural&#32;Evolution&#32;Strategy</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00007"/>00007 <emphasis role="comment">//&#32;&#32;&#32;&#32;for&#32;High-Dimensional&#32;Problems&#32;(CR-FM-NES),&#32;see&#32;https://arxiv.org/abs/2201.11422&#32;.</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00008"/>00008 <emphasis role="comment">//&#32;&#32;&#32;&#32;Derived&#32;from&#32;https://github.com/nomuramasahir0/crfmnes&#32;.</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00009"/>00009 <emphasis role="comment">//</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00010"/>00010 <emphasis role="comment">//&#32;Requires&#32;Eigen&#32;version&#32;&gt;=&#32;3.4&#32;because&#32;new&#32;slicing&#32;capabilities&#32;are&#32;used,&#32;see</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00011"/>00011 <emphasis role="comment">//&#32;https://eigen.tuxfamily.org/dox-devel/group__TutorialSlicingIndexing.html</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00012"/>00012 <emphasis role="comment">//&#32;requires&#32;https://github.com/bab2min/EigenRand&#32;for&#32;random&#32;number&#32;generation.</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00013"/>00013 
<anchor xml:id="_crfmnes_8cpp_source_1l00014"/>00014 <emphasis role="preprocessor">#include&#32;&lt;Eigen/Core&gt;</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00015"/>00015 <emphasis role="preprocessor">#include&#32;&lt;Eigen/Eigenvalues&gt;</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00016"/>00016 <emphasis role="preprocessor">#include&#32;&lt;iostream&gt;</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00017"/>00017 <emphasis role="preprocessor">#include&#32;&lt;random&gt;</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00018"/>00018 <emphasis role="preprocessor">#include&#32;&lt;float.h&gt;</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00019"/>00019 <emphasis role="preprocessor">#include&#32;&lt;stdint.h&gt;</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00020"/>00020 <emphasis role="preprocessor">#include&#32;&lt;ctime&gt;</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00021"/>00021 <emphasis role="preprocessor">#include&#32;&lt;inttypes.h&gt;</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00022"/>00022 <emphasis role="preprocessor">#include&#32;&quot;<link linkend="_evaluator_8h">evaluator.h</link>&quot;</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00023"/>00023 
<anchor xml:id="_crfmnes_8cpp_source_1l00024"/>00024 <emphasis role="keyword">using&#32;namespace&#32;</emphasis>std;
<anchor xml:id="_crfmnes_8cpp_source_1l00025"/>00025 
<anchor xml:id="_crfmnes_8cpp_source_1l00026"/><link linkend="_namespacecrmfnes">00026</link> <emphasis role="keyword">namespace&#32;</emphasis><link linkend="_namespacecrmfnes">crmfnes</link>&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00027"/>00027 
<anchor xml:id="_crfmnes_8cpp_source_1l00028"/><link linkend="_namespacecrmfnes_1a37f765d781ba1148662c876fc40498b8">00028</link> <emphasis role="keyword">static</emphasis>&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;<link linkend="_namespacecrmfnes_1a37f765d781ba1148662c876fc40498b8">sequence</link>(<emphasis role="keywordtype">double</emphasis>&#32;start,&#32;<emphasis role="keywordtype">double</emphasis>&#32;end,&#32;<emphasis role="keywordtype">double</emphasis>&#32;step)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00029"/>00029 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;size&#32;=&#32;(int)&#32;((end&#32;-&#32;start)&#32;/&#32;step&#32;+&#32;1);
<anchor xml:id="_crfmnes_8cpp_source_1l00030"/>00030 &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;d(size);
<anchor xml:id="_crfmnes_8cpp_source_1l00031"/>00031 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;value&#32;=&#32;start;
<anchor xml:id="_crfmnes_8cpp_source_1l00032"/>00032 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;r&#32;=&#32;0;&#32;r&#32;&lt;&#32;size;&#32;r++)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00033"/>00033 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;d(r)&#32;=&#32;value;
<anchor xml:id="_crfmnes_8cpp_source_1l00034"/>00034 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;value&#32;+=&#32;step;
<anchor xml:id="_crfmnes_8cpp_source_1l00035"/>00035 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00036"/>00036 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;d;
<anchor xml:id="_crfmnes_8cpp_source_1l00037"/>00037 }
<anchor xml:id="_crfmnes_8cpp_source_1l00038"/>00038 
<anchor xml:id="_crfmnes_8cpp_source_1l00039"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer">00039</link> <emphasis role="keyword">class&#32;</emphasis><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a05253e344b7c87ba83627a8b15bf384b">CrfmnesOptimizer</link>&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00040"/>00040 
<anchor xml:id="_crfmnes_8cpp_source_1l00041"/>00041 <emphasis role="keyword">public</emphasis>:
<anchor xml:id="_crfmnes_8cpp_source_1l00042"/>00042 
<anchor xml:id="_crfmnes_8cpp_source_1l00043"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a05253e344b7c87ba83627a8b15bf384b">00043</link> &#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a05253e344b7c87ba83627a8b15bf384b">CrfmnesOptimizer</link>(int64_t&#32;&#32;runid_,&#32;<link linkend="_class_fitness">Fitness</link>*&#32;fitfun_,&#32;<emphasis role="keywordtype">int</emphasis>&#32;dim_,&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;m_,&#32;<emphasis role="keywordtype">double</emphasis>&#32;sigma_,&#32;<emphasis role="keywordtype">int</emphasis>&#32;lamb_,
<anchor xml:id="_crfmnes_8cpp_source_1l00044"/>00044 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;maxEvaluations_,&#32;<emphasis role="keywordtype">double</emphasis>&#32;stopfitness_,
<anchor xml:id="_crfmnes_8cpp_source_1l00045"/>00045 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;penalty_coef_,&#32;<emphasis role="keywordtype">bool</emphasis>&#32;use_constraint_violation_,&#32;int64_t&#32;&#32;seed)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00046"/>00046 
<anchor xml:id="_crfmnes_8cpp_source_1l00047"/>00047 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a94ef5ecb5b443d6bea2755f8f5ff101e">runid</link>&#32;=&#32;runid_;
<anchor xml:id="_crfmnes_8cpp_source_1l00048"/>00048 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df">fitfun</link>&#32;=&#32;fitfun_;
<anchor xml:id="_crfmnes_8cpp_source_1l00049"/>00049 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>&#32;=&#32;dim_;
<anchor xml:id="_crfmnes_8cpp_source_1l00050"/>00050 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af0db5eb5a3f56f27d4b98d761e72d1a0">m</link>&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df">fitfun</link>-&gt;encode(m_);
<anchor xml:id="_crfmnes_8cpp_source_1l00051"/>00051 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a4c0820d04c88fd8fee328b76e876b802">sigma</link>&#32;=&#32;sigma_;
<anchor xml:id="_crfmnes_8cpp_source_1l00052"/>00052 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>&#32;=&#32;lamb_;
<anchor xml:id="_crfmnes_8cpp_source_1l00053"/>00053 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a36b0425100406234215eea1c9b13e9ce">mu</link>&#32;=&#32;lamb_/2;
<anchor xml:id="_crfmnes_8cpp_source_1l00054"/>00054 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1abbde930c83008df3cc0ffc0274f9d42f">maxEvaluations</link>&#32;=&#32;maxEvaluations_;
<anchor xml:id="_crfmnes_8cpp_source_1l00055"/>00055 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae32d48173c079d73cce875635b480add">stopfitness</link>&#32;=&#32;stopfitness_;
<anchor xml:id="_crfmnes_8cpp_source_1l00056"/>00056 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a8e0fa412cfd0b5c7e65ecab47b329cdc">penalty_coef</link>&#32;=&#32;penalty_coef_&#32;&gt;&#32;0&#32;?&#32;penalty_coef_&#32;:&#32;1e5;
<anchor xml:id="_crfmnes_8cpp_source_1l00057"/>00057 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a129a0aa8de197876c8b303efb52aec42">use_constraint_violation</link>&#32;=&#32;use_constraint_violation_;
<anchor xml:id="_crfmnes_8cpp_source_1l00058"/>00058 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aadf548da26f22c15246e777fd2a5f850">rs</link>&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;pcg64(seed);
<anchor xml:id="_crfmnes_8cpp_source_1l00059"/>00059 
<anchor xml:id="_crfmnes_8cpp_source_1l00060"/>00060 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a052fd208dd9ea12039373c6fc9d3f272">stop</link>&#32;=&#32;0;
<anchor xml:id="_crfmnes_8cpp_source_1l00061"/>00061 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1acbc3a84327f441962eeda759eb1e888c">v</link>&#32;=&#32;<link linkend="_evaluator_8h_1a5b652df2286e1f0c4dae7d4dd841bb8f">normalVec</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>,&#32;*<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aadf548da26f22c15246e777fd2a5f850">rs</link>)&#32;/&#32;sqrt(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>);
<anchor xml:id="_crfmnes_8cpp_source_1l00062"/>00062 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5">D</link>&#32;=&#32;<link linkend="_evaluator_8h_1a493b3a74ec3481711548e4b506b009cd">constant</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>,&#32;1);
<anchor xml:id="_crfmnes_8cpp_source_1l00063"/>00063 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a276111d6b0fdeb972925d988901da9b4">w_rank_hat</link>&#32;=&#32;((log(<link linkend="_namespacecrmfnes_1a37f765d781ba1148662c876fc40498b8">sequence</link>(1,&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>,&#32;1).array())&#32;*&#32;-1.)&#32;+&#32;log(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a36b0425100406234215eea1c9b13e9ce">mu</link>&#32;+&#32;1)).cwiseMax(0);
<anchor xml:id="_crfmnes_8cpp_source_1l00064"/>00064 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a696d7a7a6fa5842a0aefc5c61de232b6">w_rank</link>&#32;=&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a276111d6b0fdeb972925d988901da9b4">w_rank_hat</link>&#32;/&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a276111d6b0fdeb972925d988901da9b4">w_rank_hat</link>.sum()).array()&#32;-&#32;(1.&#32;/&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>);
<anchor xml:id="_crfmnes_8cpp_source_1l00065"/>00065 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;wlamb&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a696d7a7a6fa5842a0aefc5c61de232b6">w_rank</link>.array()&#32;+&#32;(1.&#32;/&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>);
<anchor xml:id="_crfmnes_8cpp_source_1l00066"/>00066 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c">mueff</link>&#32;=&#32;1.&#32;/&#32;(wlamb.transpose()&#32;*&#32;wlamb)(0,0);
<anchor xml:id="_crfmnes_8cpp_source_1l00067"/>00067 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aff1006f7662b3b17b824b151b40a8165">cs</link>&#32;=&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c">mueff</link>&#32;+&#32;2.)&#32;/&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>&#32;+&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c">mueff</link>&#32;+&#32;5.);
<anchor xml:id="_crfmnes_8cpp_source_1l00068"/>00068 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa5bfe0c1ff87f0fefc54e2246a06c2ad">cc</link>&#32;=&#32;(4.&#32;+&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c">mueff</link>&#32;/&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>)&#32;/&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>&#32;+&#32;4.&#32;+&#32;2.&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c">mueff</link>&#32;/&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>);
<anchor xml:id="_crfmnes_8cpp_source_1l00069"/>00069 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1acf5da4897c7d05b4a560483aa902dc85">c1_cma</link>&#32;=&#32;2.&#32;/&#32;(pow(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>&#32;+&#32;1.3,&#32;2)&#32;+&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c">mueff</link>);
<anchor xml:id="_crfmnes_8cpp_source_1l00070"/>00070 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;initialization</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00071"/>00071 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa5b420b40b5781750b33e17ccdb2d2d6">chiN</link>&#32;=&#32;sqrt(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>)&#32;*&#32;(1.&#32;-&#32;1.&#32;/&#32;(4.&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>)&#32;+&#32;1.&#32;/&#32;(21.&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>));
<anchor xml:id="_crfmnes_8cpp_source_1l00072"/>00072 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ac80232587fb6c3f7ee255f6f008cde98">pc</link>&#32;=&#32;<link linkend="_evaluator_8h_1a909812174fa9829bc49f6e00edb00b90">zeros</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>);
<anchor xml:id="_crfmnes_8cpp_source_1l00073"/>00073 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae3129ee6c7c9205a66634a2f2df6ae0b">ps</link>&#32;=&#32;<link linkend="_evaluator_8h_1a909812174fa9829bc49f6e00edb00b90">zeros</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>);
<anchor xml:id="_crfmnes_8cpp_source_1l00074"/>00074 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;distance&#32;weight&#32;parameter</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00075"/>00075 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5">h_inv</link>&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af30c10c32f611845931c3a8dc034874f">get_h_inv</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>);
<anchor xml:id="_crfmnes_8cpp_source_1l00076"/>00076 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;learning&#32;rate</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00077"/>00077 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a352856a88945aa103202f415a9b8b90f">eta_m</link>&#32;=&#32;1.0;
<anchor xml:id="_crfmnes_8cpp_source_1l00078"/>00078 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa686eecadca99ea7ee1064afda80c369">eta_move_sigma</link>&#32;=&#32;1.;
<anchor xml:id="_crfmnes_8cpp_source_1l00079"/>00079 
<anchor xml:id="_crfmnes_8cpp_source_1l00080"/>00080 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aad0299e6e1ed76e143db1ef75d1a3c7b">g</link>&#32;=&#32;0;
<anchor xml:id="_crfmnes_8cpp_source_1l00081"/>00081 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a85f1a006b0a3aa878e22e0b65517142e">no_of_evals</link>&#32;=&#32;0;
<anchor xml:id="_crfmnes_8cpp_source_1l00082"/>00082 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1">z</link>&#32;=&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>,&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>);
<anchor xml:id="_crfmnes_8cpp_source_1l00083"/>00083 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae7104ec4f55d2e4bedb9ac8e885cc3d9">f_best</link>&#32;=&#32;INFINITY;
<anchor xml:id="_crfmnes_8cpp_source_1l00084"/>00084 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af415b05895f150b3f59613fb3e5a67ed">x_best</link>&#32;=&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>);
<anchor xml:id="_crfmnes_8cpp_source_1l00085"/>00085 &#32;&#32;&#32;&#32;};
<anchor xml:id="_crfmnes_8cpp_source_1l00086"/>00086 
<anchor xml:id="_crfmnes_8cpp_source_1l00087"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a23aa6d542c16d17a68a0fd29b13b36b9">00087</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">virtual</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a23aa6d542c16d17a68a0fd29b13b36b9">~CrfmnesOptimizer</link>()&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00088"/>00088 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">delete</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aadf548da26f22c15246e777fd2a5f850">rs</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00089"/>00089 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00090"/>00090 
<anchor xml:id="_crfmnes_8cpp_source_1l00091"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa451fe19e5c4b4617099daf96ed4d171">00091</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa451fe19e5c4b4617099daf96ed4d171">doOptimize</link>()&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00092"/>00092 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;--------------------&#32;Generation&#32;Loop&#32;--------------------------------</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00093"/>00093 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a9979f360a5500c2e9eb53522659bd745">iterations</link>&#32;=&#32;1;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df">fitfun</link>-&gt;evaluations()&#32;&lt;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1abbde930c83008df3cc0ffc0274f9d42f">maxEvaluations</link>&#32;&amp;&amp;&#32;!<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df">fitfun</link>-&gt;terminate();
<anchor xml:id="_crfmnes_8cpp_source_1l00094"/>00094 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a9979f360a5500c2e9eb53522659bd745">iterations</link>++)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00095"/>00095 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;generate&#32;and&#32;evaluate&#32;lamb&#32;offspring</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00096"/>00096 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">try</emphasis>&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00097"/>00097 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;xs&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ac3695788414c855140e6615040309e42">ask</link>();
<anchor xml:id="_crfmnes_8cpp_source_1l00098"/>00098 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;evs(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>);
<anchor xml:id="_crfmnes_8cpp_source_1l00099"/>00099 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df">fitfun</link>-&gt;values(xs,&#32;evs);
<anchor xml:id="_crfmnes_8cpp_source_1l00100"/>00100 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aae1806b3f5cca0f2f27363c38c83a836">tell</link>(evs);
<anchor xml:id="_crfmnes_8cpp_source_1l00101"/>00101 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}&#32;<emphasis role="keywordflow">catch</emphasis>&#32;(std::exception&#32;&amp;e)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00102"/>00102 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a052fd208dd9ea12039373c6fc9d3f272">stop</link>&#32;=&#32;-1;
<anchor xml:id="_crfmnes_8cpp_source_1l00103"/>00103 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00104"/>00104 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a052fd208dd9ea12039373c6fc9d3f272">stop</link>&#32;!=&#32;0)
<anchor xml:id="_crfmnes_8cpp_source_1l00105"/>00105 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>;
<anchor xml:id="_crfmnes_8cpp_source_1l00106"/>00106 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00107"/>00107 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00108"/>00108 
<anchor xml:id="_crfmnes_8cpp_source_1l00109"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a2351c27b7cd4710d802d0a86dd6ea39f">00109</link> &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a2351c27b7cd4710d802d0a86dd6ea39f">getPopulation</link>()&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00110"/>00110 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ad68ee5ba071c8eb355a3fbe1b306adb7">xs_no_sort</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00111"/>00111 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00112"/>00112 
<anchor xml:id="_crfmnes_8cpp_source_1l00113"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a7ee78ff487813e794ab15e0374a35f6c">00113</link> &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a7ee78ff487813e794ab15e0374a35f6c">getBestX</link>()&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00114"/>00114 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af415b05895f150b3f59613fb3e5a67ed">x_best</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00115"/>00115 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00116"/>00116 
<anchor xml:id="_crfmnes_8cpp_source_1l00117"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1abea9bcf06910aef210b31f43504c340c">00117</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1abea9bcf06910aef210b31f43504c340c">getBestValue</link>()&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00118"/>00118 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae7104ec4f55d2e4bedb9ac8e885cc3d9">f_best</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00119"/>00119 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00120"/>00120 
<anchor xml:id="_crfmnes_8cpp_source_1l00121"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a4735fca2ded46c9ae1e713ae3d77b152">00121</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a4735fca2ded46c9ae1e713ae3d77b152">getIterations</link>()&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00122"/>00122 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a9979f360a5500c2e9eb53522659bd745">iterations</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00123"/>00123 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00124"/>00124 
<anchor xml:id="_crfmnes_8cpp_source_1l00125"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1acdb727b084e729ed508db581aaee4ee7">00125</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1acdb727b084e729ed508db581aaee4ee7">getStop</link>()&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00126"/>00126 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a052fd208dd9ea12039373c6fc9d3f272">stop</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00127"/>00127 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00128"/>00128 
<anchor xml:id="_crfmnes_8cpp_source_1l00129"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a07a2bffa713685aa8e13ff615d46081c">00129</link> &#32;&#32;&#32;&#32;<link linkend="_class_fitness">Fitness</link>*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a07a2bffa713685aa8e13ff615d46081c">getFitfun</link>()&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00130"/>00130 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df">fitfun</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00131"/>00131 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00132"/>00132 
<anchor xml:id="_crfmnes_8cpp_source_1l00133"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a7f114cfa6d21f79ace8fed2094960cce">00133</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a7f114cfa6d21f79ace8fed2094960cce">getDim</link>()&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00134"/>00134 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00135"/>00135 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00136"/>00136 
<anchor xml:id="_crfmnes_8cpp_source_1l00137"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab5d2acf44525abcdfae3a8ec346f345a">00137</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab5d2acf44525abcdfae3a8ec346f345a">getPopsize</link>()&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00138"/>00138 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00139"/>00139 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00140"/>00140 
<anchor xml:id="_crfmnes_8cpp_source_1l00141"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ac3695788414c855140e6615040309e42">00141</link> &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ac3695788414c855140e6615040309e42">ask</link>()&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00142"/>00142 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;zhalf&#32;=&#32;<link linkend="_evaluator_8h_1a231544ac51b3f9312c104a3b7a3c49a6">normal</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>,&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a36b0425100406234215eea1c9b13e9ce">mu</link>,&#32;*<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aadf548da26f22c15246e777fd2a5f850">rs</link>);
<anchor xml:id="_crfmnes_8cpp_source_1l00143"/>00143 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;i&#32;=&#32;0;&#32;i&#32;&lt;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>;&#32;i++)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00144"/>00144 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(i&#32;&lt;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a36b0425100406234215eea1c9b13e9ce">mu</link>)&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1">z</link>.col(i)&#32;=&#32;zhalf.col(i);
<anchor xml:id="_crfmnes_8cpp_source_1l00145"/>00145 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">else</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1">z</link>.col(i)&#32;=&#32;-zhalf.col(i-<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a36b0425100406234215eea1c9b13e9ce">mu</link>);
<anchor xml:id="_crfmnes_8cpp_source_1l00146"/>00146 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00147"/>00147 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a7bc978613195f2ba7b83cc3a48e102ba">normv</link>&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1acbc3a84327f441962eeda759eb1e888c">v</link>.norm();
<anchor xml:id="_crfmnes_8cpp_source_1l00148"/>00148 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e">normv2</link>&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a7bc978613195f2ba7b83cc3a48e102ba">normv</link>*<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a7bc978613195f2ba7b83cc3a48e102ba">normv</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00149"/>00149 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb">vbar</link>&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1acbc3a84327f441962eeda759eb1e888c">v</link>&#32;/&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a7bc978613195f2ba7b83cc3a48e102ba">normv</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00150"/>00150 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a70a1083d613aed87133542c0817f0df9">y</link>&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1">z</link>&#32;+&#32;((sqrt(1&#32;+&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e">normv2</link>)&#32;-&#32;1.)&#32;*&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb">vbar</link>&#32;&#32;*&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb">vbar</link>.transpose()&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1">z</link>)));
<anchor xml:id="_crfmnes_8cpp_source_1l00151"/>00151 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab3f078f7cce59803c94ed53e685f2e3b">x</link>&#32;=&#32;((<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a4c0820d04c88fd8fee328b76e876b802">sigma</link>&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a70a1083d613aed87133542c0817f0df9">y</link>.array()).colwise()&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5">D</link>.array()).colwise()&#32;+&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af0db5eb5a3f56f27d4b98d761e72d1a0">m</link>.array();
<anchor xml:id="_crfmnes_8cpp_source_1l00152"/>00152 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab3f078f7cce59803c94ed53e685f2e3b">x</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00153"/>00153 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00154"/>00154 
<anchor xml:id="_crfmnes_8cpp_source_1l00155"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aae1806b3f5cca0f2f27363c38c83a836">00155</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aae1806b3f5cca0f2f27363c38c83a836">tell</link>(<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;&amp;evs)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00156"/>00156 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a676c36938614690f4db2c6d9ccee7df4">evals_no_sort</link>&#32;=&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>(evs);
<anchor xml:id="_crfmnes_8cpp_source_1l00157"/>00157 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;k&#32;=&#32;0;&#32;k&#32;&lt;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>;&#32;k++)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00158"/>00158 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(!isfinite(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a676c36938614690f4db2c6d9ccee7df4">evals_no_sort</link>[k]))
<anchor xml:id="_crfmnes_8cpp_source_1l00159"/>00159 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a676c36938614690f4db2c6d9ccee7df4">evals_no_sort</link>[k]&#32;=&#32;DBL_MAX;
<anchor xml:id="_crfmnes_8cpp_source_1l00160"/>00160 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00161"/>00161 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ad68ee5ba071c8eb355a3fbe1b306adb7">xs_no_sort</link>&#32;=&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab3f078f7cce59803c94ed53e685f2e3b">x</link>);
<anchor xml:id="_crfmnes_8cpp_source_1l00162"/>00162 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d">ivec</link>&#32;sorted_indices;
<anchor xml:id="_crfmnes_8cpp_source_1l00163"/>00163 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a129a0aa8de197876c8b303efb52aec42">use_constraint_violation</link>)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00164"/>00164 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;violations&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df">fitfun</link>-&gt;violations(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab3f078f7cce59803c94ed53e685f2e3b">x</link>,&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a8e0fa412cfd0b5c7e65ecab47b329cdc">penalty_coef</link>);
<anchor xml:id="_crfmnes_8cpp_source_1l00165"/>00165 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;sorted_indices&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a914d39cf65f7277f14b0ed3cbf4e0d73">sort_indices_by</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a676c36938614690f4db2c6d9ccee7df4">evals_no_sort</link>&#32;+&#32;violations,&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1">z</link>);
<anchor xml:id="_crfmnes_8cpp_source_1l00166"/>00166 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}&#32;<emphasis role="keywordflow">else</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00167"/>00167 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;sorted_indices&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a914d39cf65f7277f14b0ed3cbf4e0d73">sort_indices_by</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a676c36938614690f4db2c6d9ccee7df4">evals_no_sort</link>,&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1">z</link>);
<anchor xml:id="_crfmnes_8cpp_source_1l00168"/>00168 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;best_eval_id&#32;=&#32;sorted_indices[0];
<anchor xml:id="_crfmnes_8cpp_source_1l00169"/>00169 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;f_best_&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a676c36938614690f4db2c6d9ccee7df4">evals_no_sort</link>[best_eval_id];
<anchor xml:id="_crfmnes_8cpp_source_1l00170"/>00170 
<anchor xml:id="_crfmnes_8cpp_source_1l00171"/>00171 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1">z</link>&#32;=&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1">z</link>)(Eigen::indexing::all,&#32;sorted_indices);
<anchor xml:id="_crfmnes_8cpp_source_1l00172"/>00172 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a70a1083d613aed87133542c0817f0df9">y</link>&#32;=&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a70a1083d613aed87133542c0817f0df9">y</link>)(Eigen::indexing::all,&#32;sorted_indices);
<anchor xml:id="_crfmnes_8cpp_source_1l00173"/>00173 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab3f078f7cce59803c94ed53e685f2e3b">x</link>&#32;=&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab3f078f7cce59803c94ed53e685f2e3b">x</link>)(Eigen::indexing::all,&#32;sorted_indices);
<anchor xml:id="_crfmnes_8cpp_source_1l00174"/>00174 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a85f1a006b0a3aa878e22e0b65517142e">no_of_evals</link>&#32;+=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00175"/>00175 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aad0299e6e1ed76e143db1ef75d1a3c7b">g</link>&#32;+=&#32;1;
<anchor xml:id="_crfmnes_8cpp_source_1l00176"/>00176 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(f_best_&#32;&lt;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae7104ec4f55d2e4bedb9ac8e885cc3d9">f_best</link>)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00177"/>00177 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae7104ec4f55d2e4bedb9ac8e885cc3d9">f_best</link>&#32;=&#32;f_best_;
<anchor xml:id="_crfmnes_8cpp_source_1l00178"/>00178 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af415b05895f150b3f59613fb3e5a67ed">x_best</link>&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df">fitfun</link>-&gt;decode(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ad68ee5ba071c8eb355a3fbe1b306adb7">xs_no_sort</link>.col(best_eval_id));
<anchor xml:id="_crfmnes_8cpp_source_1l00179"/>00179 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae7104ec4f55d2e4bedb9ac8e885cc3d9">f_best</link>&#32;&lt;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae32d48173c079d73cce875635b480add">stopfitness</link>)
<anchor xml:id="_crfmnes_8cpp_source_1l00180"/>00180 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a052fd208dd9ea12039373c6fc9d3f272">stop</link>&#32;=&#32;1;
<anchor xml:id="_crfmnes_8cpp_source_1l00181"/>00181 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//cout&#32;&lt;&lt;&#32;f_best&#32;&lt;&lt;&#32;endl;</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00182"/>00182 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00183"/>00183 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;This&#32;operation&#32;assumes&#32;that&#32;if&#32;the&#32;solution&#32;is&#32;infeasible,&#32;infinity&#32;comes&#32;in&#32;as&#32;input.</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00184"/>00184 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;lambF&#32;=&#32;0;
<anchor xml:id="_crfmnes_8cpp_source_1l00185"/>00185 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;k&#32;=&#32;0;&#32;k&#32;&lt;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>;&#32;k++)
<anchor xml:id="_crfmnes_8cpp_source_1l00186"/>00186 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a676c36938614690f4db2c6d9ccee7df4">evals_no_sort</link>[k]&#32;&lt;&#32;DBL_MAX)&#32;lambF++;
<anchor xml:id="_crfmnes_8cpp_source_1l00187"/>00187 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;evolution&#32;path&#32;p_sigma</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00188"/>00188 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae3129ee6c7c9205a66634a2f2df6ae0b">ps</link>&#32;=&#32;(1&#32;-&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aff1006f7662b3b17b824b151b40a8165">cs</link>)&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae3129ee6c7c9205a66634a2f2df6ae0b">ps</link>&#32;+&#32;sqrt(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aff1006f7662b3b17b824b151b40a8165">cs</link>&#32;*&#32;(2.&#32;-&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aff1006f7662b3b17b824b151b40a8165">cs</link>)&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c">mueff</link>)&#32;*&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1">z</link>&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a696d7a7a6fa5842a0aefc5c61de232b6">w_rank</link>);
<anchor xml:id="_crfmnes_8cpp_source_1l00189"/>00189 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;ps_norm&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae3129ee6c7c9205a66634a2f2df6ae0b">ps</link>.norm();
<anchor xml:id="_crfmnes_8cpp_source_1l00190"/>00190 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;distance&#32;weight</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00191"/>00191 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;w_tmp(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>);
<anchor xml:id="_crfmnes_8cpp_source_1l00192"/>00192 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;k&#32;=&#32;0;&#32;k&#32;&lt;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>;&#32;k++)
<anchor xml:id="_crfmnes_8cpp_source_1l00193"/>00193 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;w_tmp[k]&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a276111d6b0fdeb972925d988901da9b4">w_rank_hat</link>[k]&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ad0e305a53657d5e357d198610c0c21e3">w_dist_hat</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1">z</link>.col(k),&#32;lambF);
<anchor xml:id="_crfmnes_8cpp_source_1l00194"/>00194 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;weights_dist&#32;=&#32;(w_tmp&#32;/&#32;w_tmp.sum()).array()&#32;-&#32;1.&#32;/&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00195"/>00195 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;switching&#32;weights&#32;and&#32;learning&#32;rate</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00196"/>00196 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;weights&#32;=&#32;ps_norm&#32;&gt;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa5b420b40b5781750b33e17ccdb2d2d6">chiN</link>&#32;?&#32;weights_dist&#32;:&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a696d7a7a6fa5842a0aefc5c61de232b6">w_rank</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00197"/>00197 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;eta_sigma&#32;=&#32;ps_norm&#32;&gt;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa5b420b40b5781750b33e17ccdb2d2d6">chiN</link>&#32;?&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa686eecadca99ea7ee1064afda80c369">eta_move_sigma</link>&#32;:
<anchor xml:id="_crfmnes_8cpp_source_1l00198"/>00198 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;(ps_norm&#32;&gt;=&#32;0.1&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa5b420b40b5781750b33e17ccdb2d2d6">chiN</link>&#32;?&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1afa07fb187d0982f0bdcf00c943e9e641">eta_stag_sigma</link>(lambF)&#32;:&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a1748dadb5cbf900c7835cabfbb898456">eta_conv_sigma</link>(lambF));
<anchor xml:id="_crfmnes_8cpp_source_1l00199"/>00199 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;update&#32;pc,&#32;m</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00200"/>00200 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;wxm&#32;=&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab3f078f7cce59803c94ed53e685f2e3b">x</link>.array().colwise()&#32;-&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af0db5eb5a3f56f27d4b98d761e72d1a0">m</link>.array()).matrix()&#32;*&#32;weights;
<anchor xml:id="_crfmnes_8cpp_source_1l00201"/>00201 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ac80232587fb6c3f7ee255f6f008cde98">pc</link>&#32;=&#32;(1.&#32;-&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa5bfe0c1ff87f0fefc54e2246a06c2ad">cc</link>)&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ac80232587fb6c3f7ee255f6f008cde98">pc</link>&#32;+&#32;sqrt(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa5bfe0c1ff87f0fefc54e2246a06c2ad">cc</link>&#32;*&#32;(2.&#32;-&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa5bfe0c1ff87f0fefc54e2246a06c2ad">cc</link>)&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c">mueff</link>)&#32;*&#32;wxm&#32;/&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a4c0820d04c88fd8fee328b76e876b802">sigma</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00202"/>00202 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af0db5eb5a3f56f27d4b98d761e72d1a0">m</link>&#32;+=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a352856a88945aa103202f415a9b8b90f">eta_m</link>&#32;*&#32;wxm;
<anchor xml:id="_crfmnes_8cpp_source_1l00203"/>00203 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;calculate&#32;s,&#32;t</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00204"/>00204 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;step1</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00205"/>00205 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;normv4&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e">normv2</link>&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e">normv2</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00206"/>00206 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;exY(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>,&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>+1);
<anchor xml:id="_crfmnes_8cpp_source_1l00207"/>00207 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;k&#32;=&#32;0;&#32;k&#32;&lt;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>;&#32;k++)
<anchor xml:id="_crfmnes_8cpp_source_1l00208"/>00208 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;exY.col(k)&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a70a1083d613aed87133542c0817f0df9">y</link>.col(k);
<anchor xml:id="_crfmnes_8cpp_source_1l00209"/>00209 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;exY.col(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>)&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ac80232587fb6c3f7ee255f6f008cde98">pc</link>.array()&#32;/&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5">D</link>.array();
<anchor xml:id="_crfmnes_8cpp_source_1l00210"/>00210 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;yy&#32;=&#32;exY.array()&#32;*&#32;exY.array();&#32;&#32;<emphasis role="comment">//&#32;dim&#32;x&#32;lamb+1</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00211"/>00211 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;ip_yvbar&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb">vbar</link>.transpose()&#32;*&#32;exY;
<anchor xml:id="_crfmnes_8cpp_source_1l00212"/>00212 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;yvbar&#32;=&#32;exY.array().colwise()&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb">vbar</link>.array();&#32;<emphasis role="comment">//&#32;dim&#32;x&#32;lamb+1.&#32;exYvbar</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00213"/>00213 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;gammav&#32;=&#32;1.&#32;+&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e">normv2</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00214"/>00214 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;vbarbar&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb">vbar</link>.array()&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb">vbar</link>.array();
<anchor xml:id="_crfmnes_8cpp_source_1l00215"/>00215 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;alphavd&#32;=&#32;min(1.,&#32;sqrt(normv4&#32;+&#32;(2&#32;*&#32;gammav&#32;-&#32;sqrt(gammav))&#32;/&#32;vbarbar.maxCoeff())&#32;/&#32;(2.&#32;+&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e">normv2</link>));&#32;&#32;<emphasis role="comment">//&#32;scalar</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00216"/>00216 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;vbar_bc&#32;=&#32;<link linkend="_evaluator_8h_1a909812174fa9829bc49f6e00edb00b90">zeros</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>,&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>+1).colwise()&#32;+&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb">vbar</link>;&#32;<emphasis role="comment">//&#32;broadcasting&#32;vbar</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00217"/>00217 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;ibg&#32;=&#32;(ip_yvbar.array()*ip_yvbar.array())&#32;+&#32;gammav;
<anchor xml:id="_crfmnes_8cpp_source_1l00218"/>00218 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;t&#32;=&#32;(exY.array().rowwise()&#32;*&#32;ip_yvbar.transpose().array())&#32;-
<anchor xml:id="_crfmnes_8cpp_source_1l00219"/>00219 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;(vbar_bc.array().rowwise()&#32;*&#32;ibg.transpose().array())&#32;/&#32;2.;
<anchor xml:id="_crfmnes_8cpp_source_1l00220"/>00220 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;b&#32;=&#32;-(1&#32;-&#32;alphavd&#32;*&#32;alphavd)&#32;*&#32;normv4&#32;/&#32;gammav&#32;+&#32;2&#32;*&#32;alphavd&#32;*&#32;alphavd;
<anchor xml:id="_crfmnes_8cpp_source_1l00221"/>00221 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;H&#32;=&#32;<link linkend="_evaluator_8h_1a493b3a74ec3481711548e4b506b009cd">constant</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>,&#32;2.)&#32;-&#32;(b&#32;+&#32;2&#32;*&#32;alphavd&#32;*&#32;alphavd)&#32;*&#32;vbarbar;&#32;&#32;<emphasis role="comment">//&#32;dim&#32;x&#32;1</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00222"/>00222 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;invH&#32;=&#32;1.&#32;/&#32;H.array();
<anchor xml:id="_crfmnes_8cpp_source_1l00223"/>00223 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;s_step1&#32;=&#32;yy.array()&#32;-&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e">normv2</link>&#32;/&#32;gammav&#32;*&#32;(yvbar.array().rowwise()&#32;*&#32;ip_yvbar.transpose().array()).array()
<anchor xml:id="_crfmnes_8cpp_source_1l00224"/>00224 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;-&#32;<link linkend="_evaluator_8h_1a493b3a74ec3481711548e4b506b009cd">constant</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>,&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>+1,&#32;1.).array();&#32;<emphasis role="comment">//&#32;dim&#32;x&#32;lamb+1</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00225"/>00225 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;ip_vbart&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb">vbar</link>.transpose()&#32;*&#32;t;&#32;&#32;<emphasis role="comment">//&#32;1&#32;x&#32;lamb+1</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00226"/>00226 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;s_step2&#32;=&#32;s_step1.array()
<anchor xml:id="_crfmnes_8cpp_source_1l00227"/>00227 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;-&#32;(alphavd&#32;/&#32;gammav&#32;*&#32;((2&#32;+&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e">normv2</link>)&#32;*&#32;(t.array().colwise()&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb">vbar</link>.array()).array()
<anchor xml:id="_crfmnes_8cpp_source_1l00228"/>00228 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;-&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e">normv2</link>&#32;*&#32;(vbarbar&#32;*&#32;ip_vbart.transpose())).array()));&#32;&#32;<emphasis role="comment">//&#32;dim&#32;x&#32;lamb+1</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00229"/>00229 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;invHvbarbar&#32;=&#32;invH.array()&#32;*&#32;vbarbar.array();
<anchor xml:id="_crfmnes_8cpp_source_1l00230"/>00230 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;ip_s_step2invHvbarbar&#32;=&#32;invHvbarbar.transpose()&#32;*&#32;s_step2;&#32;&#32;<emphasis role="comment">//&#32;1&#32;x&#32;lamb+1</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00231"/>00231 
<anchor xml:id="_crfmnes_8cpp_source_1l00232"/>00232 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;div&#32;=&#32;1&#32;+&#32;b&#32;*&#32;(vbarbar.transpose()&#32;*&#32;invHvbarbar)(0,0);
<anchor xml:id="_crfmnes_8cpp_source_1l00233"/>00233 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(div&#32;==&#32;0)
<anchor xml:id="_crfmnes_8cpp_source_1l00234"/>00234 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;div&#32;=&#32;1E-13;int</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00235"/>00235 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">throw</emphasis>&#32;std::invalid_argument(&#32;<emphasis role="stringliteral">&quot;division&#32;by&#32;0&quot;</emphasis>&#32;);
<anchor xml:id="_crfmnes_8cpp_source_1l00236"/>00236 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;s&#32;=&#32;(s_step2.array().colwise()&#32;*&#32;invH.array()).array()
<anchor xml:id="_crfmnes_8cpp_source_1l00237"/>00237 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;-&#32;((b&#32;/&#32;div)&#32;*&#32;(invHvbarbar&#32;*&#32;ip_s_step2invHvbarbar.transpose())).array();&#32;&#32;<emphasis role="comment">//&#32;dim&#32;x&#32;lamb+1</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00238"/>00238 
<anchor xml:id="_crfmnes_8cpp_source_1l00239"/>00239 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;ip_svbarbar&#32;=&#32;vbarbar.transpose()&#32;*&#32;s;&#32;&#32;<emphasis role="comment">//&#32;1&#32;x&#32;lamb+1</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00240"/>00240 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;t&#32;=&#32;t.array()&#32;-&#32;alphavd&#32;*&#32;((2&#32;+&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e">normv2</link>)&#32;*&#32;(s.array().colwise()&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb">vbar</link>.array()).array()
<anchor xml:id="_crfmnes_8cpp_source_1l00241"/>00241 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;-&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb">vbar</link>&#32;*&#32;ip_svbarbar.transpose()).array());&#32;&#32;<emphasis role="comment">//&#32;dim&#32;x&#32;lamb+1</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00242"/>00242 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;update&#32;v,&#32;D</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00243"/>00243 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;exw(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>+1);
<anchor xml:id="_crfmnes_8cpp_source_1l00244"/>00244 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;k&#32;=&#32;0;&#32;k&#32;&lt;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>;&#32;k++)
<anchor xml:id="_crfmnes_8cpp_source_1l00245"/>00245 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;exw[k]&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae0b69c9a8ba0266efb3fe667de42134f">eta_B</link>(lambF)&#32;*&#32;weights[k];
<anchor xml:id="_crfmnes_8cpp_source_1l00246"/>00246 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;exw[<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>]&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a61b800bdcb2be2c0add38eabc9bb2df5">c1</link>(lambF);
<anchor xml:id="_crfmnes_8cpp_source_1l00247"/>00247 
<anchor xml:id="_crfmnes_8cpp_source_1l00248"/>00248 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1acbc3a84327f441962eeda759eb1e888c">v</link>&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1acbc3a84327f441962eeda759eb1e888c">v</link>.array()&#32;+&#32;(t&#32;*&#32;exw).array()&#32;/&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a7bc978613195f2ba7b83cc3a48e102ba">normv</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00249"/>00249 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5">D</link>&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5">D</link>.array()&#32;+&#32;(s&#32;*&#32;exw).array()&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5">D</link>.array();
<anchor xml:id="_crfmnes_8cpp_source_1l00250"/>00250 
<anchor xml:id="_crfmnes_8cpp_source_1l00251"/>00251 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;calculate&#32;detA</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00252"/>00252 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5">D</link>.minCoeff()&#32;&lt;&#32;0)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00253"/>00253 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//throw&#32;std::invalid_argument(&#32;&quot;D&#32;&lt;&#32;0&quot;&#32;);</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00254"/>00254 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a052fd208dd9ea12039373c6fc9d3f272">stop</link>&#32;=&#32;-1;
<anchor xml:id="_crfmnes_8cpp_source_1l00255"/>00255 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>;
<anchor xml:id="_crfmnes_8cpp_source_1l00256"/>00256 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00257"/>00257 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;nthrootdetA&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a1c0bc5770261a21ed819387c339b3c05">cexp</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5">D</link>.array().log().sum()&#32;/&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>&#32;+&#32;log(1&#32;+&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1acbc3a84327f441962eeda759eb1e888c">v</link>.transpose()&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1acbc3a84327f441962eeda759eb1e888c">v</link>)(0,0))&#32;/&#32;(2&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>));
<anchor xml:id="_crfmnes_8cpp_source_1l00258"/>00258 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5">D</link>&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5">D</link>.array()&#32;/&#32;nthrootdetA;
<anchor xml:id="_crfmnes_8cpp_source_1l00259"/>00259 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;update&#32;sigma</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00260"/>00260 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;G_s&#32;=&#32;(((<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1">z</link>.array()&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1">z</link>.array()).array()&#32;-&#32;<link linkend="_evaluator_8h_1a493b3a74ec3481711548e4b506b009cd">constant</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>,&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>,&#32;1.).array()).matrix()&#32;*&#32;weights).sum()&#32;/&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00261"/>00261 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a4c0820d04c88fd8fee328b76e876b802">sigma</link>&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a4c0820d04c88fd8fee328b76e876b802">sigma</link>&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a1c0bc5770261a21ed819387c339b3c05">cexp</link>(eta_sigma&#32;/&#32;2&#32;*&#32;G_s);
<anchor xml:id="_crfmnes_8cpp_source_1l00262"/>00262 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00263"/>00263 
<anchor xml:id="_crfmnes_8cpp_source_1l00264"/>00264 <emphasis role="keyword">private</emphasis>:
<anchor xml:id="_crfmnes_8cpp_source_1l00265"/>00265 
<anchor xml:id="_crfmnes_8cpp_source_1l00266"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a1c0bc5770261a21ed819387c339b3c05">00266</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a1c0bc5770261a21ed819387c339b3c05">cexp</link>(<emphasis role="keywordtype">double</emphasis>&#32;a)&#32;{&#32;<emphasis role="keywordflow">return</emphasis>&#32;exp(min(a,&#32;100.0));&#32;}&#32;<emphasis role="comment">//&#32;avoid&#32;overflow</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00267"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a61b800bdcb2be2c0add38eabc9bb2df5">00267</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a61b800bdcb2be2c0add38eabc9bb2df5">c1</link>(<emphasis role="keywordtype">double</emphasis>&#32;lambF)&#32;{&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1acf5da4897c7d05b4a560483aa902dc85">c1_cma</link>&#32;*&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>&#32;-&#32;5)&#32;/&#32;6&#32;*&#32;(lambF&#32;/&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>);&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00268"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae0b69c9a8ba0266efb3fe667de42134f">00268</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae0b69c9a8ba0266efb3fe667de42134f">eta_B</link>(<emphasis role="keywordtype">double</emphasis>&#32;lambF)&#32;{&#32;<emphasis role="keywordflow">return</emphasis>&#32;tanh((min(0.02&#32;*&#32;lambF,&#32;3&#32;*&#32;log(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>))&#32;+&#32;5)&#32;/&#32;(0.23&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>&#32;+&#32;25));&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00269"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a13448f49cc0f161fa5fdbd6430cc7804">00269</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a13448f49cc0f161fa5fdbd6430cc7804">alpha_dist</link>(<emphasis role="keywordtype">double</emphasis>&#32;lambF)&#32;{&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5">h_inv</link>&#32;*&#32;min(1.,&#32;sqrt(((<emphasis role="keywordtype">double</emphasis>)<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>)&#32;/&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>))&#32;*&#32;sqrt(((<emphasis role="keywordtype">double</emphasis>)lambF)&#32;/&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>);&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00270"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ad0e305a53657d5e357d198610c0c21e3">00270</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ad0e305a53657d5e357d198610c0c21e3">w_dist_hat</link>(<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1">z</link>,&#32;<emphasis role="keywordtype">double</emphasis>&#32;lambF)&#32;{&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a1c0bc5770261a21ed819387c339b3c05">cexp</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a13448f49cc0f161fa5fdbd6430cc7804">alpha_dist</link>(lambF)&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1">z</link>.norm());&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00271"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1afa07fb187d0982f0bdcf00c943e9e641">00271</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1afa07fb187d0982f0bdcf00c943e9e641">eta_stag_sigma</link>(<emphasis role="keywordtype">double</emphasis>&#32;lambF)&#32;{&#32;<emphasis role="keywordflow">return</emphasis>&#32;tanh((0.024&#32;*&#32;lambF&#32;+&#32;0.7&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>&#32;+&#32;20.)&#32;/&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>&#32;+&#32;12.));&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00272"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a1748dadb5cbf900c7835cabfbb898456">00272</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a1748dadb5cbf900c7835cabfbb898456">eta_conv_sigma</link>(<emphasis role="keywordtype">double</emphasis>&#32;lambF)&#32;{&#32;<emphasis role="keywordflow">return</emphasis>&#32;2.&#32;*&#32;tanh((0.025&#32;*&#32;lambF&#32;+&#32;0.75&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>&#32;+&#32;10.)&#32;/&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>&#32;+&#32;4.));&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00273"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a8f9c2b6e89e25a5c3e0d50a8eb4011be">00273</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a8f9c2b6e89e25a5c3e0d50a8eb4011be">f</link>(<emphasis role="keywordtype">double</emphasis>&#32;a)&#32;{&#32;<emphasis role="keywordflow">return</emphasis>&#32;&#32;((1.&#32;+&#32;a&#32;*&#32;a)&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a1c0bc5770261a21ed819387c339b3c05">cexp</link>(a&#32;*&#32;a&#32;/&#32;2.)&#32;/&#32;0.24)&#32;-&#32;10.&#32;-&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00274"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a7f306ac3a58b6ed9f29babc44fbe466b">00274</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a7f306ac3a58b6ed9f29babc44fbe466b">f_prime</link>(<emphasis role="keywordtype">double</emphasis>&#32;a)&#32;{&#32;<emphasis role="keywordflow">return</emphasis>&#32;&#32;(1.&#32;/&#32;0.24)&#32;*&#32;a&#32;*&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a1c0bc5770261a21ed819387c339b3c05">cexp</link>(a&#32;*&#32;a&#32;/&#32;2.)&#32;*&#32;(3.&#32;+&#32;a&#32;*&#32;a);&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00275"/>00275 
<anchor xml:id="_crfmnes_8cpp_source_1l00276"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af30c10c32f611845931c3a8dc034874f">00276</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af30c10c32f611845931c3a8dc034874f">get_h_inv</link>(<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00277"/>00277 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5">h_inv</link>&#32;=&#32;1.0;
<anchor xml:id="_crfmnes_8cpp_source_1l00278"/>00278 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">while</emphasis>&#32;(abs(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a8f9c2b6e89e25a5c3e0d50a8eb4011be">f</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5">h_inv</link>))&#32;&gt;&#32;1e-10)
<anchor xml:id="_crfmnes_8cpp_source_1l00279"/>00279 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5">h_inv</link>&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5">h_inv</link>&#32;-&#32;0.5&#32;*&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a8f9c2b6e89e25a5c3e0d50a8eb4011be">f</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5">h_inv</link>)&#32;/&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a7f306ac3a58b6ed9f29babc44fbe466b">f_prime</link>(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5">h_inv</link>));
<anchor xml:id="_crfmnes_8cpp_source_1l00280"/>00280 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5">h_inv</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00281"/>00281 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00282"/>00282 
<anchor xml:id="_crfmnes_8cpp_source_1l00283"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1adae78062208e6dc79abad146a0461ec3">00283</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1adae78062208e6dc79abad146a0461ec3">num_feasible</link>(<emphasis role="keyword">const</emphasis>&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;&amp;evals)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00284"/>00284 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;n&#32;=&#32;0;
<anchor xml:id="_crfmnes_8cpp_source_1l00285"/>00285 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;i&#32;=&#32;0;&#32;i&#32;&lt;&#32;evals.size();&#32;i++)
<anchor xml:id="_crfmnes_8cpp_source_1l00286"/>00286 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(evals[i]&#32;!=&#32;INFINITY)&#32;n++;
<anchor xml:id="_crfmnes_8cpp_source_1l00287"/>00287 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;n;
<anchor xml:id="_crfmnes_8cpp_source_1l00288"/>00288 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00289"/>00289 
<anchor xml:id="_crfmnes_8cpp_source_1l00290"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a914d39cf65f7277f14b0ed3cbf4e0d73">00290</link> &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d">ivec</link>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a914d39cf65f7277f14b0ed3cbf4e0d73">sort_indices_by</link>(<emphasis role="keyword">const</emphasis>&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;&amp;evals,&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1">z</link>)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00291"/>00291 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;lam&#32;=&#32;evals.size();
<anchor xml:id="_crfmnes_8cpp_source_1l00292"/>00292 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d">ivec</link>&#32;sorted_indices&#32;=&#32;<link linkend="_evaluator_8h_1a7689f88ea48c85c22d9b34208decd67c">sort_index</link>(evals);
<anchor xml:id="_crfmnes_8cpp_source_1l00293"/>00293 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;sorted_evals&#32;=&#32;evals(sorted_indices);
<anchor xml:id="_crfmnes_8cpp_source_1l00294"/>00294 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;no_of_feasible_solutions&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1adae78062208e6dc79abad146a0461ec3">num_feasible</link>(sorted_evals);
<anchor xml:id="_crfmnes_8cpp_source_1l00295"/>00295 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(no_of_feasible_solutions&#32;!=&#32;lam)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00296"/>00296 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;distances(lam&#32;-&#32;no_of_feasible_solutions);
<anchor xml:id="_crfmnes_8cpp_source_1l00297"/>00297 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;n&#32;=&#32;0;
<anchor xml:id="_crfmnes_8cpp_source_1l00298"/>00298 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;i&#32;=&#32;0;&#32;i&#32;&lt;&#32;lam;&#32;i++)
<anchor xml:id="_crfmnes_8cpp_source_1l00299"/>00299 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(evals[i]&#32;==&#32;INFINITY)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00300"/>00300 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;distances[n]&#32;=&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1">z</link>.col(i).squaredNorm();
<anchor xml:id="_crfmnes_8cpp_source_1l00301"/>00301 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;n++;
<anchor xml:id="_crfmnes_8cpp_source_1l00302"/>00302 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00303"/>00303 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d">ivec</link>&#32;indices_sorted_by_distance&#32;=&#32;<link linkend="_evaluator_8h_1a7689f88ea48c85c22d9b34208decd67c">sort_index</link>(distances);
<anchor xml:id="_crfmnes_8cpp_source_1l00304"/>00304 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;i&#32;=&#32;no_of_feasible_solutions;&#32;i&#32;&lt;&#32;lam;&#32;i++)
<anchor xml:id="_crfmnes_8cpp_source_1l00305"/>00305 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;sorted_indices[i]&#32;=&#32;sorted_indices[no_of_feasible_solutions
<anchor xml:id="_crfmnes_8cpp_source_1l00306"/>00306 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;+&#32;indices_sorted_by_distance[i-no_of_feasible_solutions]];
<anchor xml:id="_crfmnes_8cpp_source_1l00307"/>00307 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00308"/>00308 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;sorted_indices;
<anchor xml:id="_crfmnes_8cpp_source_1l00309"/>00309 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00310"/>00310 
<anchor xml:id="_crfmnes_8cpp_source_1l00311"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a94ef5ecb5b443d6bea2755f8f5ff101e">00311</link> &#32;&#32;&#32;&#32;int64_t&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a94ef5ecb5b443d6bea2755f8f5ff101e">runid</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00312"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df">00312</link> &#32;&#32;&#32;&#32;<link linkend="_class_fitness">Fitness</link>&#32;*<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df">fitfun</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00313"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">00313</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b">dim</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00314"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af0db5eb5a3f56f27d4b98d761e72d1a0">00314</link> &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af0db5eb5a3f56f27d4b98d761e72d1a0">m</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00315"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a4c0820d04c88fd8fee328b76e876b802">00315</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a4c0820d04c88fd8fee328b76e876b802">sigma</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00316"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">00316</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd">lamb</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00317"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a36b0425100406234215eea1c9b13e9ce">00317</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a36b0425100406234215eea1c9b13e9ce">mu</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00318"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a129a0aa8de197876c8b303efb52aec42">00318</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">bool</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a129a0aa8de197876c8b303efb52aec42">use_constraint_violation</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00319"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aadf548da26f22c15246e777fd2a5f850">00319</link> &#32;&#32;&#32;&#32;pcg64&#32;*<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aadf548da26f22c15246e777fd2a5f850">rs</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00320"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1acbc3a84327f441962eeda759eb1e888c">00320</link> &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1acbc3a84327f441962eeda759eb1e888c">v</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00321"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5">00321</link> &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5">D</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00322"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a8e0fa412cfd0b5c7e65ecab47b329cdc">00322</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a8e0fa412cfd0b5c7e65ecab47b329cdc">penalty_coef</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00323"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a276111d6b0fdeb972925d988901da9b4">00323</link> &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a276111d6b0fdeb972925d988901da9b4">w_rank_hat</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00324"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a696d7a7a6fa5842a0aefc5c61de232b6">00324</link> &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a696d7a7a6fa5842a0aefc5c61de232b6">w_rank</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00325"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c">00325</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c">mueff</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00326"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aff1006f7662b3b17b824b151b40a8165">00326</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aff1006f7662b3b17b824b151b40a8165">cs</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00327"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa5bfe0c1ff87f0fefc54e2246a06c2ad">00327</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa5bfe0c1ff87f0fefc54e2246a06c2ad">cc</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00328"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1acf5da4897c7d05b4a560483aa902dc85">00328</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1acf5da4897c7d05b4a560483aa902dc85">c1_cma</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00329"/>00329 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;initialization</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00330"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa5b420b40b5781750b33e17ccdb2d2d6">00330</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa5b420b40b5781750b33e17ccdb2d2d6">chiN</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00331"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ac80232587fb6c3f7ee255f6f008cde98">00331</link> &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ac80232587fb6c3f7ee255f6f008cde98">pc</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00332"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae3129ee6c7c9205a66634a2f2df6ae0b">00332</link> &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae3129ee6c7c9205a66634a2f2df6ae0b">ps</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00333"/>00333 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;distance&#32;weight&#32;parameter</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00334"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5">00334</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5">h_inv</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00335"/>00335 &#32;&#32;&#32;&#32;<emphasis role="comment">//&#32;learning&#32;rate</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00336"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a352856a88945aa103202f415a9b8b90f">00336</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a352856a88945aa103202f415a9b8b90f">eta_m</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00337"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa686eecadca99ea7ee1064afda80c369">00337</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa686eecadca99ea7ee1064afda80c369">eta_move_sigma</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00338"/>00338 
<anchor xml:id="_crfmnes_8cpp_source_1l00339"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aad0299e6e1ed76e143db1ef75d1a3c7b">00339</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aad0299e6e1ed76e143db1ef75d1a3c7b">g</link>&#32;=&#32;0;
<anchor xml:id="_crfmnes_8cpp_source_1l00340"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a85f1a006b0a3aa878e22e0b65517142e">00340</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a85f1a006b0a3aa878e22e0b65517142e">no_of_evals</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00341"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1">00341</link> &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1">z</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00342"/>00342 
<anchor xml:id="_crfmnes_8cpp_source_1l00343"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae7104ec4f55d2e4bedb9ac8e885cc3d9">00343</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae7104ec4f55d2e4bedb9ac8e885cc3d9">f_best</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00344"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af415b05895f150b3f59613fb3e5a67ed">00344</link> &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1af415b05895f150b3f59613fb3e5a67ed">x_best</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00345"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ad68ee5ba071c8eb355a3fbe1b306adb7">00345</link> &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ad68ee5ba071c8eb355a3fbe1b306adb7">xs_no_sort</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00346"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a676c36938614690f4db2c6d9ccee7df4">00346</link> &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a676c36938614690f4db2c6d9ccee7df4">evals_no_sort</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00347"/>00347 
<anchor xml:id="_crfmnes_8cpp_source_1l00348"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a9979f360a5500c2e9eb53522659bd745">00348</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a9979f360a5500c2e9eb53522659bd745">iterations</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00349"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1abbde930c83008df3cc0ffc0274f9d42f">00349</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1abbde930c83008df3cc0ffc0274f9d42f">maxEvaluations</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00350"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae32d48173c079d73cce875635b480add">00350</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ae32d48173c079d73cce875635b480add">stopfitness</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00351"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a052fd208dd9ea12039373c6fc9d3f272">00351</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a052fd208dd9ea12039373c6fc9d3f272">stop</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00352"/>00352 
<anchor xml:id="_crfmnes_8cpp_source_1l00353"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a7bc978613195f2ba7b83cc3a48e102ba">00353</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a7bc978613195f2ba7b83cc3a48e102ba">normv</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00354"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e">00354</link> &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e">normv2</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00355"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb">00355</link> &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb">vbar</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00356"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a70a1083d613aed87133542c0817f0df9">00356</link> &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1a70a1083d613aed87133542c0817f0df9">y</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00357"/><link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab3f078f7cce59803c94ed53e685f2e3b">00357</link> &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer_1ab3f078f7cce59803c94ed53e685f2e3b">x</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00358"/>00358 
<anchor xml:id="_crfmnes_8cpp_source_1l00359"/>00359 };
<anchor xml:id="_crfmnes_8cpp_source_1l00360"/>00360 }
<anchor xml:id="_crfmnes_8cpp_source_1l00361"/>00361 
<anchor xml:id="_crfmnes_8cpp_source_1l00362"/>00362 <emphasis role="keyword">using&#32;namespace&#32;</emphasis><link linkend="_namespacecrmfnes">crmfnes</link>;
<anchor xml:id="_crfmnes_8cpp_source_1l00363"/>00363 
<anchor xml:id="_crfmnes_8cpp_source_1l00364"/>00364 <emphasis role="keyword">extern</emphasis>&#32;<emphasis role="stringliteral">&quot;C&quot;</emphasis>&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00365"/><link linkend="_crfmnes_8cpp_1a9081791c22cd931e965641b985273b52">00365</link> <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_crfmnes_8cpp_1a9081791c22cd931e965641b985273b52">optimizeCRFMNES_C</link>(int64_t&#32;&#32;runid,&#32;<link linkend="_evaluator_8h_1a1adc681c70e547867358d25d5cf7eedc">callback_parallel</link>&#32;func_par,&#32;<emphasis role="keywordtype">int</emphasis>&#32;dim,
<anchor xml:id="_crfmnes_8cpp_source_1l00366"/>00366 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;*init,&#32;<emphasis role="keywordtype">double</emphasis>&#32;*lower,&#32;<emphasis role="keywordtype">double</emphasis>&#32;*upper,&#32;<emphasis role="keywordtype">double</emphasis>&#32;sigma,
<anchor xml:id="_crfmnes_8cpp_source_1l00367"/>00367 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;maxEvals,&#32;<emphasis role="keywordtype">double</emphasis>&#32;stopfitness,&#32;<emphasis role="keywordtype">int</emphasis>&#32;popsize,
<anchor xml:id="_crfmnes_8cpp_source_1l00368"/>00368 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;int64_t&#32;&#32;seed,&#32;<emphasis role="keywordtype">double</emphasis>&#32;penalty_coef,&#32;<emphasis role="keywordtype">bool</emphasis>&#32;use_constraint_violation,&#32;<emphasis role="keywordtype">bool</emphasis>&#32;normalize,&#32;<emphasis role="keywordtype">double</emphasis>*&#32;res)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00369"/>00369 
<anchor xml:id="_crfmnes_8cpp_source_1l00370"/>00370 &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;guess(dim),&#32;lower_limit(dim),&#32;upper_limit(dim);
<anchor xml:id="_crfmnes_8cpp_source_1l00371"/>00371 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;i&#32;=&#32;0;&#32;i&#32;&lt;&#32;dim;&#32;i++)&#32;<emphasis role="comment">//&#32;guess&#32;is&#32;mandatory</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00372"/>00372 &#32;&#32;&#32;&#32;&#32;guess[i]&#32;=&#32;init[i];
<anchor xml:id="_crfmnes_8cpp_source_1l00373"/>00373 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(lower&#32;!=&#32;NULL&#32;&amp;&amp;&#32;upper&#32;!=&#32;NULL)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00374"/>00374 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;i&#32;=&#32;0;&#32;i&#32;&lt;&#32;dim;&#32;i++)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00375"/>00375 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;guess[i]&#32;=&#32;init[i];
<anchor xml:id="_crfmnes_8cpp_source_1l00376"/>00376 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;lower_limit[i]&#32;=&#32;lower[i];
<anchor xml:id="_crfmnes_8cpp_source_1l00377"/>00377 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;upper_limit[i]&#32;=&#32;upper[i];
<anchor xml:id="_crfmnes_8cpp_source_1l00378"/>00378 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00379"/>00379 &#32;&#32;&#32;&#32;}&#32;<emphasis role="keywordflow">else</emphasis>&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00380"/>00380 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;lower_limit.resize(0);
<anchor xml:id="_crfmnes_8cpp_source_1l00381"/>00381 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;upper_limit.resize(0);
<anchor xml:id="_crfmnes_8cpp_source_1l00382"/>00382 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;normalize&#32;=&#32;<emphasis role="keyword">false</emphasis>;
<anchor xml:id="_crfmnes_8cpp_source_1l00383"/>00383 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00384"/>00384 
<anchor xml:id="_crfmnes_8cpp_source_1l00385"/>00385 &#32;&#32;&#32;&#32;<link linkend="_class_fitness">Fitness</link>&#32;fitfun(<link linkend="_evaluator_8h_1ad0943ebd623281f526e5aee2aa818895">noop_callback</link>,&#32;func_par,&#32;dim,&#32;1,&#32;lower_limit,&#32;upper_limit);
<anchor xml:id="_crfmnes_8cpp_source_1l00386"/>00386 &#32;&#32;&#32;&#32;fitfun.<link linkend="_class_fitness_1a31beb7ecb5fa49ac03b43abe444ab9a6">setNormalize</link>(normalize);
<anchor xml:id="_crfmnes_8cpp_source_1l00387"/>00387 
<anchor xml:id="_crfmnes_8cpp_source_1l00388"/>00388 &#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer">CrfmnesOptimizer</link>&#32;opt(runid,&#32;&amp;fitfun,&#32;dim,&#32;guess,&#32;sigma,&#32;popsize,
<anchor xml:id="_crfmnes_8cpp_source_1l00389"/>00389 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;maxEvals,&#32;stopfitness,&#32;penalty_coef,&#32;use_constraint_violation,&#32;seed);
<anchor xml:id="_crfmnes_8cpp_source_1l00390"/>00390 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">try</emphasis>&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00391"/>00391 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;opt.doOptimize();
<anchor xml:id="_crfmnes_8cpp_source_1l00392"/>00392 &#32;&#32;&#32;&#32;}&#32;<emphasis role="keywordflow">catch</emphasis>&#32;(std::exception&#32;&amp;e)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00393"/>00393 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;cout&#32;&lt;&lt;&#32;e.what()&#32;&lt;&lt;&#32;endl;
<anchor xml:id="_crfmnes_8cpp_source_1l00394"/>00394 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00395"/>00395 &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;bestX&#32;=&#32;opt.getBestX();
<anchor xml:id="_crfmnes_8cpp_source_1l00396"/>00396 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;bestY&#32;=&#32;opt.getBestValue();
<anchor xml:id="_crfmnes_8cpp_source_1l00397"/>00397 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;i&#32;=&#32;0;&#32;i&#32;&lt;&#32;dim;&#32;i++)
<anchor xml:id="_crfmnes_8cpp_source_1l00398"/>00398 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;res[i]&#32;=&#32;bestX[i];
<anchor xml:id="_crfmnes_8cpp_source_1l00399"/>00399 &#32;&#32;&#32;&#32;res[dim]&#32;=&#32;bestY;
<anchor xml:id="_crfmnes_8cpp_source_1l00400"/>00400 &#32;&#32;&#32;&#32;res[dim&#32;+&#32;1]&#32;=&#32;fitfun.<link linkend="_class_fitness_1aba60038eac4e0e15d995e57f4ba079e1">evaluations</link>();
<anchor xml:id="_crfmnes_8cpp_source_1l00401"/>00401 &#32;&#32;&#32;&#32;res[dim&#32;+&#32;2]&#32;=&#32;opt.getIterations();
<anchor xml:id="_crfmnes_8cpp_source_1l00402"/>00402 &#32;&#32;&#32;&#32;res[dim&#32;+&#32;3]&#32;=&#32;opt.getStop();
<anchor xml:id="_crfmnes_8cpp_source_1l00403"/>00403 }
<anchor xml:id="_crfmnes_8cpp_source_1l00404"/>00404 
<anchor xml:id="_crfmnes_8cpp_source_1l00405"/><link linkend="_crfmnes_8cpp_1a8ad70c1b6cadd1ed7b3bfa0d60d96911">00405</link> uintptr_t&#32;<link linkend="_crfmnes_8cpp_1a8ad70c1b6cadd1ed7b3bfa0d60d96911">initCRFMNES_C</link>(int64_t&#32;&#32;runid,&#32;<emphasis role="keywordtype">int</emphasis>&#32;dim,
<anchor xml:id="_crfmnes_8cpp_source_1l00406"/>00406 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;*init,&#32;<emphasis role="keywordtype">double</emphasis>&#32;*lower,&#32;<emphasis role="keywordtype">double</emphasis>&#32;*upper,&#32;<emphasis role="keywordtype">double</emphasis>&#32;sigma,
<anchor xml:id="_crfmnes_8cpp_source_1l00407"/>00407 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;popsize,&#32;int64_t&#32;&#32;seed,&#32;<emphasis role="keywordtype">double</emphasis>&#32;penalty_coef,&#32;<emphasis role="keywordtype">bool</emphasis>&#32;use_constraint_violation,&#32;<emphasis role="keywordtype">bool</emphasis>&#32;normalize)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00408"/>00408 
<anchor xml:id="_crfmnes_8cpp_source_1l00409"/>00409 &#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;guess(dim),&#32;lower_limit(dim),&#32;upper_limit(dim);
<anchor xml:id="_crfmnes_8cpp_source_1l00410"/>00410 &#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;i&#32;=&#32;0;&#32;i&#32;&lt;&#32;dim;&#32;i++)&#32;<emphasis role="comment">//&#32;guess&#32;is&#32;mandatory</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00411"/>00411 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;guess[i]&#32;=&#32;init[i];
<anchor xml:id="_crfmnes_8cpp_source_1l00412"/>00412 &#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;(lower&#32;!=&#32;NULL&#32;&amp;&amp;&#32;upper&#32;!=&#32;NULL)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00413"/>00413 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;i&#32;=&#32;0;&#32;i&#32;&lt;&#32;dim;&#32;i++)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00414"/>00414 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;guess[i]&#32;=&#32;init[i];
<anchor xml:id="_crfmnes_8cpp_source_1l00415"/>00415 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;lower_limit[i]&#32;=&#32;lower[i];
<anchor xml:id="_crfmnes_8cpp_source_1l00416"/>00416 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;upper_limit[i]&#32;=&#32;upper[i];
<anchor xml:id="_crfmnes_8cpp_source_1l00417"/>00417 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00418"/>00418 &#32;&#32;&#32;&#32;&#32;}&#32;<emphasis role="keywordflow">else</emphasis>&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00419"/>00419 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;lower_limit.resize(0);
<anchor xml:id="_crfmnes_8cpp_source_1l00420"/>00420 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;upper_limit.resize(0);
<anchor xml:id="_crfmnes_8cpp_source_1l00421"/>00421 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;normalize&#32;=&#32;<emphasis role="keyword">false</emphasis>;
<anchor xml:id="_crfmnes_8cpp_source_1l00422"/>00422 &#32;&#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00423"/>00423 &#32;&#32;&#32;&#32;&#32;<link linkend="_class_fitness">Fitness</link>*&#32;fitfun&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;<link linkend="_class_fitness">Fitness</link>(<link linkend="_evaluator_8h_1ad0943ebd623281f526e5aee2aa818895">noop_callback</link>,&#32;<link linkend="_evaluator_8h_1ac05c49788a31e5f7cb8efbe8ca3b548e">noop_callback_par</link>,&#32;dim,&#32;1,&#32;lower_limit,&#32;upper_limit);
<anchor xml:id="_crfmnes_8cpp_source_1l00424"/>00424 &#32;&#32;&#32;&#32;&#32;fitfun-&gt;<link linkend="_class_fitness_1a31beb7ecb5fa49ac03b43abe444ab9a6">setNormalize</link>(normalize);
<anchor xml:id="_crfmnes_8cpp_source_1l00425"/>00425 
<anchor xml:id="_crfmnes_8cpp_source_1l00426"/>00426 &#32;&#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer">CrfmnesOptimizer</link>*&#32;opt&#32;=&#32;<emphasis role="keyword">new</emphasis>&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer">CrfmnesOptimizer</link>(runid,&#32;fitfun,&#32;dim,&#32;guess,&#32;sigma,&#32;popsize,
<anchor xml:id="_crfmnes_8cpp_source_1l00427"/>00427 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;0,&#32;-DBL_MAX,&#32;penalty_coef,&#32;use_constraint_violation,&#32;seed);
<anchor xml:id="_crfmnes_8cpp_source_1l00428"/>00428 
<anchor xml:id="_crfmnes_8cpp_source_1l00429"/>00429 &#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;(uintptr_t)&#32;opt;
<anchor xml:id="_crfmnes_8cpp_source_1l00430"/>00430 }
<anchor xml:id="_crfmnes_8cpp_source_1l00431"/>00431 
<anchor xml:id="_crfmnes_8cpp_source_1l00432"/><link linkend="_crfmnes_8cpp_1a22d09131327c77abfd090eaa649faf5d">00432</link> <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_crfmnes_8cpp_1a22d09131327c77abfd090eaa649faf5d">destroyCRFMNES_C</link>(uintptr_t&#32;ptr)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00433"/>00433 &#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer">CrfmnesOptimizer</link>*&#32;opt&#32;=&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer">CrfmnesOptimizer</link>*)ptr;
<anchor xml:id="_crfmnes_8cpp_source_1l00434"/>00434 &#32;&#32;&#32;&#32;<link linkend="_class_fitness">Fitness</link>*&#32;fitfun&#32;=&#32;opt-&gt;getFitfun();
<anchor xml:id="_crfmnes_8cpp_source_1l00435"/>00435 &#32;&#32;&#32;&#32;<emphasis role="keyword">delete</emphasis>&#32;fitfun;
<anchor xml:id="_crfmnes_8cpp_source_1l00436"/>00436 &#32;&#32;&#32;&#32;<emphasis role="keyword">delete</emphasis>&#32;opt;
<anchor xml:id="_crfmnes_8cpp_source_1l00437"/>00437 }
<anchor xml:id="_crfmnes_8cpp_source_1l00438"/>00438 
<anchor xml:id="_crfmnes_8cpp_source_1l00439"/><link linkend="_crfmnes_8cpp_1aa1796ba79109494532e2a57b9555b7e5">00439</link> <emphasis role="keywordtype">void</emphasis>&#32;<link linkend="_crfmnes_8cpp_1aa1796ba79109494532e2a57b9555b7e5">askCRFMNES_C</link>(uintptr_t&#32;ptr,&#32;<emphasis role="keywordtype">double</emphasis>*&#32;xs)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00440"/>00440 &#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer">CrfmnesOptimizer</link>&#32;*opt&#32;=&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer">CrfmnesOptimizer</link>*)&#32;ptr;
<anchor xml:id="_crfmnes_8cpp_source_1l00441"/>00441 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;n&#32;=&#32;opt-&gt;getDim();
<anchor xml:id="_crfmnes_8cpp_source_1l00442"/>00442 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;lamb&#32;=&#32;opt-&gt;getPopsize();
<anchor xml:id="_crfmnes_8cpp_source_1l00443"/>00443 &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;popX&#32;=&#32;opt-&gt;ask();
<anchor xml:id="_crfmnes_8cpp_source_1l00444"/>00444 &#32;&#32;&#32;&#32;<link linkend="_class_fitness">Fitness</link>*&#32;fitfun&#32;=&#32;opt-&gt;getFitfun();
<anchor xml:id="_crfmnes_8cpp_source_1l00445"/>00445 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;p&#32;=&#32;0;&#32;p&#32;&lt;&#32;lamb;&#32;p++)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00446"/>00446 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;x&#32;=&#32;fitfun-&gt;<link linkend="_class_fitness_1a2085e5ce1a0afa5949366f580d5ec5a4">getClosestFeasible</link>(fitfun-&gt;<link linkend="_class_fitness_1a7fdca1fda75e3976b91e1e9e0eb12057">decode</link>(popX.col(p)));
<anchor xml:id="_crfmnes_8cpp_source_1l00447"/>00447 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;i&#32;=&#32;0;&#32;i&#32;&lt;&#32;n;&#32;i++)
<anchor xml:id="_crfmnes_8cpp_source_1l00448"/>00448 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;xs[p&#32;*&#32;n&#32;+&#32;i]&#32;=&#32;x[i];
<anchor xml:id="_crfmnes_8cpp_source_1l00449"/>00449 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00450"/>00450 }
<anchor xml:id="_crfmnes_8cpp_source_1l00451"/>00451 
<anchor xml:id="_crfmnes_8cpp_source_1l00452"/><link linkend="_crfmnes_8cpp_1a39b04e71778a1006c8cc1bea2d082074">00452</link> <emphasis role="keywordtype">int</emphasis>&#32;<link linkend="_crfmnes_8cpp_1a39b04e71778a1006c8cc1bea2d082074">tellCRFMNES_C</link>(uintptr_t&#32;ptr,&#32;<emphasis role="keywordtype">double</emphasis>*&#32;ys)&#32;{<emphasis role="comment">//,&#32;double*&#32;xs)&#32;{</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00453"/>00453 &#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer">CrfmnesOptimizer</link>&#32;*opt&#32;=&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer">CrfmnesOptimizer</link>*)&#32;ptr;
<anchor xml:id="_crfmnes_8cpp_source_1l00454"/>00454 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;lamb&#32;=&#32;opt-&gt;getPopsize();
<anchor xml:id="_crfmnes_8cpp_source_1l00455"/>00455 <emphasis role="comment">//&#32;&#32;&#32;&#32;int&#32;dim&#32;=&#32;opt-&gt;getDim();</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00456"/>00456 <emphasis role="comment">//&#32;&#32;&#32;&#32;Fitness*&#32;fitfun&#32;=&#32;opt-&gt;getFitfun();</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00457"/>00457 <emphasis role="comment">//&#32;&#32;&#32;&#32;mat&#32;popX(dim,&#32;lamb);</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00458"/>00458 <emphasis role="comment">//&#32;&#32;&#32;&#32;for&#32;(int&#32;p&#32;=&#32;0;&#32;p&#32;&lt;&#32;lamb;&#32;p++)&#32;{</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00459"/>00459 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;vec&#32;x(dim);</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00460"/>00460 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;for&#32;(int&#32;i&#32;=&#32;0;&#32;i&#32;&lt;&#32;dim;&#32;i++)</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00461"/>00461 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;x[i]&#32;=&#32;xs[p&#32;*&#32;dim&#32;+&#32;i];</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00462"/>00462 <emphasis role="comment">//&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;popX.col(p)&#32;=&#32;fitfun-&gt;decode(x);</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00463"/>00463 <emphasis role="comment">//&#32;&#32;&#32;&#32;}</emphasis>
<anchor xml:id="_crfmnes_8cpp_source_1l00464"/>00464 &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;vals(lamb);
<anchor xml:id="_crfmnes_8cpp_source_1l00465"/>00465 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;i&#32;=&#32;0;&#32;i&#32;&lt;&#32;lamb;&#32;i++)
<anchor xml:id="_crfmnes_8cpp_source_1l00466"/>00466 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;vals[i]&#32;=&#32;ys[i];
<anchor xml:id="_crfmnes_8cpp_source_1l00467"/>00467 &#32;&#32;&#32;&#32;opt-&gt;tell(vals);
<anchor xml:id="_crfmnes_8cpp_source_1l00468"/>00468 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;opt-&gt;getStop();
<anchor xml:id="_crfmnes_8cpp_source_1l00469"/>00469 }
<anchor xml:id="_crfmnes_8cpp_source_1l00470"/>00470 
<anchor xml:id="_crfmnes_8cpp_source_1l00471"/><link linkend="_crfmnes_8cpp_1ae309750075a3655886dcf9647435b799">00471</link> <emphasis role="keywordtype">int</emphasis>&#32;<link linkend="_crfmnes_8cpp_1ae309750075a3655886dcf9647435b799">populationCRFMNES_C</link>(uintptr_t&#32;ptr,&#32;<emphasis role="keywordtype">double</emphasis>*&#32;xs)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00472"/>00472 &#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer">CrfmnesOptimizer</link>&#32;*opt&#32;=&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer">CrfmnesOptimizer</link>*)&#32;ptr;
<anchor xml:id="_crfmnes_8cpp_source_1l00473"/>00473 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;dim&#32;=&#32;opt-&gt;getDim();
<anchor xml:id="_crfmnes_8cpp_source_1l00474"/>00474 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;lamb&#32;=&#32;opt-&gt;getPopsize();
<anchor xml:id="_crfmnes_8cpp_source_1l00475"/>00475 &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc">mat</link>&#32;popX&#32;=&#32;opt-&gt;getPopulation();
<anchor xml:id="_crfmnes_8cpp_source_1l00476"/>00476 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;p&#32;=&#32;0;&#32;p&#32;&lt;&#32;lamb;&#32;p++)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00477"/>00477 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;x&#32;=&#32;popX.col(p);
<anchor xml:id="_crfmnes_8cpp_source_1l00478"/>00478 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;i&#32;=&#32;0;&#32;i&#32;&lt;&#32;dim;&#32;i++)
<anchor xml:id="_crfmnes_8cpp_source_1l00479"/>00479 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;x[i]&#32;=&#32;xs[p&#32;*&#32;dim&#32;+&#32;i];
<anchor xml:id="_crfmnes_8cpp_source_1l00480"/>00480 &#32;&#32;&#32;&#32;}
<anchor xml:id="_crfmnes_8cpp_source_1l00481"/>00481 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;opt-&gt;getStop();
<anchor xml:id="_crfmnes_8cpp_source_1l00482"/>00482 }
<anchor xml:id="_crfmnes_8cpp_source_1l00483"/>00483 
<anchor xml:id="_crfmnes_8cpp_source_1l00484"/><link linkend="_crfmnes_8cpp_1aefaccee22121ee2d0f43d33fd5968c22">00484</link> <emphasis role="keywordtype">int</emphasis>&#32;<link linkend="_crfmnes_8cpp_1aefaccee22121ee2d0f43d33fd5968c22">resultCRFMNES_C</link>(uintptr_t&#32;ptr,&#32;<emphasis role="keywordtype">double</emphasis>*&#32;res)&#32;{
<anchor xml:id="_crfmnes_8cpp_source_1l00485"/>00485 &#32;&#32;&#32;&#32;<link linkend="_classcrmfnes_1_1_crfmnes_optimizer">CrfmnesOptimizer</link>&#32;*opt&#32;=&#32;(<link linkend="_classcrmfnes_1_1_crfmnes_optimizer">CrfmnesOptimizer</link>*)&#32;ptr;
<anchor xml:id="_crfmnes_8cpp_source_1l00486"/>00486 &#32;&#32;&#32;&#32;<link linkend="_daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f">vec</link>&#32;bestX&#32;=&#32;opt-&gt;getBestX();
<anchor xml:id="_crfmnes_8cpp_source_1l00487"/>00487 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">double</emphasis>&#32;bestY&#32;=&#32;opt-&gt;getBestValue();
<anchor xml:id="_crfmnes_8cpp_source_1l00488"/>00488 &#32;&#32;&#32;&#32;<emphasis role="keywordtype">int</emphasis>&#32;n&#32;=&#32;bestX.size();
<anchor xml:id="_crfmnes_8cpp_source_1l00489"/>00489 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;(<emphasis role="keywordtype">int</emphasis>&#32;i&#32;=&#32;0;&#32;i&#32;&lt;&#32;bestX.size();&#32;i++)
<anchor xml:id="_crfmnes_8cpp_source_1l00490"/>00490 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;res[i]&#32;=&#32;bestX[i];
<anchor xml:id="_crfmnes_8cpp_source_1l00491"/>00491 &#32;&#32;&#32;&#32;res[n]&#32;=&#32;bestY;
<anchor xml:id="_crfmnes_8cpp_source_1l00492"/>00492 &#32;&#32;&#32;&#32;<link linkend="_class_fitness">Fitness</link>*&#32;fitfun&#32;=&#32;opt-&gt;getFitfun();
<anchor xml:id="_crfmnes_8cpp_source_1l00493"/>00493 &#32;&#32;&#32;&#32;res[n&#32;+&#32;1]&#32;=&#32;fitfun-&gt;<link linkend="_class_fitness_1aba60038eac4e0e15d995e57f4ba079e1">evaluations</link>();
<anchor xml:id="_crfmnes_8cpp_source_1l00494"/>00494 &#32;&#32;&#32;&#32;res[n&#32;+&#32;2]&#32;=&#32;opt-&gt;getIterations();
<anchor xml:id="_crfmnes_8cpp_source_1l00495"/>00495 &#32;&#32;&#32;&#32;res[n&#32;+&#32;3]&#32;=&#32;opt-&gt;getStop();
<anchor xml:id="_crfmnes_8cpp_source_1l00496"/>00496 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;opt-&gt;getStop();
<anchor xml:id="_crfmnes_8cpp_source_1l00497"/>00497 }
<anchor xml:id="_crfmnes_8cpp_source_1l00498"/>00498 
<anchor xml:id="_crfmnes_8cpp_source_1l00499"/>00499 }
</programlisting></section>
