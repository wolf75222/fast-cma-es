<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_rvt_8py_source" xml:lang="en-US">
<title>rvt.py</title>
<indexterm><primary>examples/kepler/rvt.py</primary></indexterm>
Go to the documentation of this file.<programlisting linenumbering="unnumbered"><anchor xml:id="_rvt_8py_source_1l00001"/><link linkend="_namespaceexamples_1_1kepler_1_1rvt">00001</link> <emphasis role="keyword">from</emphasis>&#32;math&#32;<emphasis role="keyword">import</emphasis>&#32;pi,&#32;sqrt,&#32;cos,&#32;sin
<anchor xml:id="_rvt_8py_source_1l00002"/>00002 <emphasis role="keyword">import</emphasis>&#32;math
<anchor xml:id="_rvt_8py_source_1l00003"/>00003 
<anchor xml:id="_rvt_8py_source_1l00004"/>00004 <emphasis role="keyword">from</emphasis>&#32;pykep.core&#32;<emphasis role="keyword">import</emphasis>&#32;AU,&#32;RAD2DEG,&#32;SEC2DAY
<anchor xml:id="_rvt_8py_source_1l00005"/>00005 <emphasis role="keyword">from</emphasis>&#32;pykep.core.core&#32;<emphasis role="keyword">import</emphasis>&#32;propagate_lagrangian,&#32;ic2par,&#32;epoch,&#32;\
<anchor xml:id="_rvt_8py_source_1l00006"/>00006 &#32;&#32;&#32;&#32;propagate_taylor
<anchor xml:id="_rvt_8py_source_1l00007"/>00007 
<anchor xml:id="_rvt_8py_source_1l00008"/>00008 <emphasis role="keyword">import</emphasis>&#32;numpy&#32;<emphasis role="keyword">as</emphasis>&#32;np
<anchor xml:id="_rvt_8py_source_1l00009"/>00009 <emphasis role="keyword">from</emphasis>&#32;kepler.kepler&#32;<emphasis role="keyword">import</emphasis>&#32;Kepler
<anchor xml:id="_rvt_8py_source_1l00010"/>00010 <emphasis role="keyword">from</emphasis>&#32;pykep.core.core&#32;<emphasis role="keyword">import</emphasis>&#32;ic2par,&#32;par2ic
<anchor xml:id="_rvt_8py_source_1l00011"/>00011 &#32;
<anchor xml:id="_rvt_8py_source_1l00012"/>00012 <emphasis role="keyword">class&#32;</emphasis><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt">rvt</link>:
<anchor xml:id="_rvt_8py_source_1l00013"/>00013 &#32;&#32;&#32;&#32;
<anchor xml:id="_rvt_8py_source_1l00014"/>00014 &#32;&#32;&#32;&#32;<emphasis role="stringliteral">&quot;&quot;&quot;</emphasis>
<anchor xml:id="_rvt_8py_source_1l00015"/><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt">00015</link> <emphasis role="stringliteral">&#32;&#32;&#32;&#32;Keplerian&#32;orbit&#32;represented&#32;by&#32;radius,&#32;velocity,&#32;time&#32;and&#32;mu.&#32;&#32;&#32;&#32;</emphasis>
<anchor xml:id="_rvt_8py_source_1l00016"/>00016 <emphasis role="stringliteral">&#32;&#32;&#32;&#32;&quot;&quot;&quot;</emphasis>
<anchor xml:id="_rvt_8py_source_1l00017"/>00017 &#32;&#32;&#32;&#32;
<anchor xml:id="_rvt_8py_source_1l00018"/>00018 &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a4221af848c64e34a0edb6c3cb775e39a">__init__</link>(self,&#32;r,&#32;v,&#32;time,&#32;mu):
<anchor xml:id="_rvt_8py_source_1l00019"/>00019 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="stringliteral">&quot;&quot;&quot;</emphasis>
<anchor xml:id="_rvt_8py_source_1l00020"/>00020 <emphasis role="stringliteral">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;Args:</emphasis>
<anchor xml:id="_rvt_8py_source_1l00021"/>00021 <emphasis role="stringliteral">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;-&#32;r&#32;(``tuple``&#32;of&#32;``float``):&#32;cartesian&#32;position&#32;in&#32;m.</emphasis>
<anchor xml:id="_rvt_8py_source_1l00022"/>00022 <emphasis role="stringliteral">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;-&#32;v:&#32;(``tuple``&#32;of&#32;``float``):&#32;velocity&#32;in&#32;m/s.</emphasis>
<anchor xml:id="_rvt_8py_source_1l00023"/>00023 <emphasis role="stringliteral">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;-&#32;time:&#32;(``float``):&#32;time&#32;in&#32;seconds.</emphasis>
<anchor xml:id="_rvt_8py_source_1l00024"/>00024 <emphasis role="stringliteral">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;-&#32;mu&#32;(`float``):&#32;gravity&#32;parameter&#32;of&#32;the&#32;central&#32;body.</emphasis>
<anchor xml:id="_rvt_8py_source_1l00025"/><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a4221af848c64e34a0edb6c3cb775e39a">00025</link> <emphasis role="stringliteral">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&quot;&quot;&quot;</emphasis>
<anchor xml:id="_rvt_8py_source_1l00026"/>00026 
<anchor xml:id="_rvt_8py_source_1l00027"/><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a29d745cf30a1183a4864388d4508a36a">00027</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a29d745cf30a1183a4864388d4508a36a">r</link>&#32;=&#32;r
<anchor xml:id="_rvt_8py_source_1l00028"/><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a15400b6669841eae54dc14817157e01b">00028</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a15400b6669841eae54dc14817157e01b">v</link>&#32;=&#32;v
<anchor xml:id="_rvt_8py_source_1l00029"/><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1ac929fbefb4b213b9704c21455c01f816">00029</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1ac929fbefb4b213b9704c21455c01f816">t</link>&#32;=&#32;time&#32;&#32;<emphasis role="comment">#&#32;in&#32;seconds</emphasis>
<anchor xml:id="_rvt_8py_source_1l00030"/><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a8493644f9fb90b7281e7d31c55ab28cd">00030</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a8493644f9fb90b7281e7d31c55ab28cd">mu</link>&#32;=&#32;mu
<anchor xml:id="_rvt_8py_source_1l00031"/>00031 
<anchor xml:id="_rvt_8py_source_1l00032"/>00032 &#32;&#32;&#32;&#32;<emphasis role="comment">#&#32;useful&#32;for&#32;debugging&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis>
<anchor xml:id="_rvt_8py_source_1l00033"/><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a74e74da30b1b1ea3677a80bd260d0f9b">00033</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a74e74da30b1b1ea3677a80bd260d0f9b">__str__</link>(self):
<anchor xml:id="_rvt_8py_source_1l00034"/>00034 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;a,&#32;e,&#32;i,&#32;_,&#32;_,&#32;_&#32;=&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a6b5028db713625237900f551e23f6045">kepler</link>()
<anchor xml:id="_rvt_8py_source_1l00035"/>00035 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;period&#32;=&#32;2&#32;*&#32;pi&#32;*&#32;sqrt(a&#32;**&#32;3&#32;/&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a8493644f9fb90b7281e7d31c55ab28cd">mu</link>)
<anchor xml:id="_rvt_8py_source_1l00036"/>00036 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;apo&#32;=&#32;a&#32;*&#32;(1&#32;+&#32;e)&#32;/&#32;AU
<anchor xml:id="_rvt_8py_source_1l00037"/>00037 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;per&#32;=&#32;a&#32;*&#32;(1&#32;-&#32;e)&#32;/&#32;AU
<anchor xml:id="_rvt_8py_source_1l00038"/>00038 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;str(self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a29d745cf30a1183a4864388d4508a36a">r</link>)&#32;+&#32;<emphasis role="stringliteral">&quot;&#32;&quot;</emphasis>&#32;+&#32;str(self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a15400b6669841eae54dc14817157e01b">v</link>)&#32;+&#32;<emphasis role="stringliteral">&quot;&#32;&quot;</emphasis>&#32;+&#32;str(self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1ac929fbefb4b213b9704c21455c01f816">t</link>&#32;*&#32;SEC2DAY)&#32;+&#32;<emphasis role="stringliteral">&quot;&#32;&quot;</emphasis>&#32;+&#32;\
<anchor xml:id="_rvt_8py_source_1l00039"/>00039 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;str(apo)&#32;+&#32;<emphasis role="stringliteral">&quot;&#32;&quot;</emphasis>&#32;+&#32;str(per)&#32;+&#32;<emphasis role="stringliteral">&quot;&#32;&quot;</emphasis>&#32;+&#32;\
<anchor xml:id="_rvt_8py_source_1l00040"/>00040 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;str(e)&#32;+&#32;<emphasis role="stringliteral">&quot;&#32;&quot;</emphasis>&#32;+&#32;str(i&#32;*&#32;RAD2DEG)&#32;+&#32;<emphasis role="stringliteral">&quot;&#32;&quot;</emphasis>&#32;+&#32;str(period&#32;*&#32;SEC2DAY)
<anchor xml:id="_rvt_8py_source_1l00041"/>00041 &#32;&#32;&#32;&#32;
<anchor xml:id="_rvt_8py_source_1l00042"/><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a8997e5792afd4f46259a6c8cf3658071">00042</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a8997e5792afd4f46259a6c8cf3658071">apply_dv</link>(self,&#32;dv):
<anchor xml:id="_rvt_8py_source_1l00043"/>00043 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;v&#32;=&#32;[a&#32;+&#32;b&#32;<emphasis role="keywordflow">for</emphasis>&#32;a,&#32;b&#32;<emphasis role="keywordflow">in</emphasis>&#32;zip(self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a15400b6669841eae54dc14817157e01b">v</link>,&#32;dv)]
<anchor xml:id="_rvt_8py_source_1l00044"/>00044 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt">rvt</link>(self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a29d745cf30a1183a4864388d4508a36a">r</link>,&#32;v,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1ac929fbefb4b213b9704c21455c01f816">t</link>,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a8493644f9fb90b7281e7d31c55ab28cd">mu</link>)
<anchor xml:id="_rvt_8py_source_1l00045"/>00045 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
<anchor xml:id="_rvt_8py_source_1l00046"/><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1abd80ce02a092e9baf6746864bc078142">00046</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1abd80ce02a092e9baf6746864bc078142">propagate_lagrangian</link>(self,&#32;tof):
<anchor xml:id="_rvt_8py_source_1l00047"/>00047 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;orb&#32;=&#32;<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt">rvt</link>(self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a29d745cf30a1183a4864388d4508a36a">r</link>,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a15400b6669841eae54dc14817157e01b">v</link>,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1ac929fbefb4b213b9704c21455c01f816">t</link>&#32;+&#32;tof,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a8493644f9fb90b7281e7d31c55ab28cd">mu</link>)
<anchor xml:id="_rvt_8py_source_1l00048"/>00048 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;orb.r,&#32;orb.v&#32;=&#32;<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1abd80ce02a092e9baf6746864bc078142">propagate_lagrangian</link>(orb.r,&#32;orb.v,&#32;tof,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a8493644f9fb90b7281e7d31c55ab28cd">mu</link>)
<anchor xml:id="_rvt_8py_source_1l00049"/>00049 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;orb
<anchor xml:id="_rvt_8py_source_1l00050"/>00050 &#32;
<anchor xml:id="_rvt_8py_source_1l00051"/><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1aabfdc3a9714df9af15eee10724eea95a">00051</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1aabfdc3a9714df9af15eee10724eea95a">propagatetaylor</link>(self,&#32;tof,&#32;m0,&#32;thrust,&#32;veff=1,&#32;log10tol=-15,&#32;log10rtol=-15):
<anchor xml:id="_rvt_8py_source_1l00052"/>00052 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;orb&#32;=&#32;<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt">rvt</link>(self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a29d745cf30a1183a4864388d4508a36a">r</link>,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a15400b6669841eae54dc14817157e01b">v</link>,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1ac929fbefb4b213b9704c21455c01f816">t</link>&#32;+&#32;tof,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a8493644f9fb90b7281e7d31c55ab28cd">mu</link>)
<anchor xml:id="_rvt_8py_source_1l00053"/>00053 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;orb.r,&#32;orb.v,&#32;m&#32;=&#32;propagate_taylor(orb.r,&#32;orb.v,&#32;m0,&#32;thrust,&#32;tof,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a8493644f9fb90b7281e7d31c55ab28cd">mu</link>,
<anchor xml:id="_rvt_8py_source_1l00054"/>00054 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;veff,&#32;log10tol,&#32;log10rtol)
<anchor xml:id="_rvt_8py_source_1l00055"/>00055 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;orb,&#32;m
<anchor xml:id="_rvt_8py_source_1l00056"/>00056 &#32;&#32;&#32;&#32;
<anchor xml:id="_rvt_8py_source_1l00057"/>00057 &#32;&#32;&#32;&#32;<emphasis role="comment">#&#32;keplarian&#32;parameters&#32;a,&#32;e,&#32;i,&#32;W,&#32;w,&#32;E&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis>
<anchor xml:id="_rvt_8py_source_1l00058"/><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a6b5028db713625237900f551e23f6045">00058</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis>kepler(self):
<anchor xml:id="_rvt_8py_source_1l00059"/>00059 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;ic2par(self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a29d745cf30a1183a4864388d4508a36a">r</link>,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a15400b6669841eae54dc14817157e01b">v</link>,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a8493644f9fb90b7281e7d31c55ab28cd">mu</link>)&#32;
<anchor xml:id="_rvt_8py_source_1l00060"/>00060 &#32;&#32;&#32;&#32;
<anchor xml:id="_rvt_8py_source_1l00061"/><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a03c381c47ce14d3a7f549118694cb8ab">00061</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a03c381c47ce14d3a7f549118694cb8ab">get_kepler</link>(self):
<anchor xml:id="_rvt_8py_source_1l00062"/>00062 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;kep&#32;=&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a6b5028db713625237900f551e23f6045">kepler</link>()
<anchor xml:id="_rvt_8py_source_1l00063"/>00063 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_classexamples_1_1kepler_1_1kepler_1_1_kepler">Kepler</link>(kep,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a8493644f9fb90b7281e7d31c55ab28cd">mu</link>,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1ac929fbefb4b213b9704c21455c01f816">t</link>)
<anchor xml:id="_rvt_8py_source_1l00064"/>00064 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
<anchor xml:id="_rvt_8py_source_1l00065"/>00065 &#32;&#32;&#32;&#32;<emphasis role="comment">#&#32;plots&#32;orbit&#32;from&#32;current&#32;time&#32;up&#32;to&#32;time&#32;+&#32;tof&#32;&#32;&#32;</emphasis>
<anchor xml:id="_rvt_8py_source_1l00066"/><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1ab071a9aa69e98d177ba2aa9b2d799320">00066</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1ab071a9aa69e98d177ba2aa9b2d799320">plot</link>(self,&#32;tof,&#32;N=60,&#32;units=AU,&#32;color=&quot;b&quot;,&#32;label=None,&#32;axes=None):
<anchor xml:id="_rvt_8py_source_1l00067"/>00067 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">from</emphasis>&#32;pykep.orbit_plots&#32;<emphasis role="keyword">import</emphasis>&#32;plot_kepler
<anchor xml:id="_rvt_8py_source_1l00068"/>00068 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;plot_kepler(r0=self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a29d745cf30a1183a4864388d4508a36a">r</link>,&#32;v0=self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a15400b6669841eae54dc14817157e01b">v</link>,&#32;tof=tof,
<anchor xml:id="_rvt_8py_source_1l00069"/>00069 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;mu=self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a8493644f9fb90b7281e7d31c55ab28cd">mu</link>,&#32;N=N,&#32;units=units,&#32;color=color,
<anchor xml:id="_rvt_8py_source_1l00070"/>00070 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;label=label,&#32;axes=axes)
<anchor xml:id="_rvt_8py_source_1l00071"/>00071 
<anchor xml:id="_rvt_8py_source_1l00072"/><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1adeb422336f723bde9931d8c3e226ca36">00072</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1adeb422336f723bde9931d8c3e226ca36">period</link>(self):
<anchor xml:id="_rvt_8py_source_1l00073"/>00073 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;kep&#32;=&#32;ic2par(self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a29d745cf30a1183a4864388d4508a36a">r</link>,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a15400b6669841eae54dc14817157e01b">v</link>,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a8493644f9fb90b7281e7d31c55ab28cd">mu</link>)&#32;
<anchor xml:id="_rvt_8py_source_1l00074"/>00074 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;a&#32;=&#32;kep[0]
<anchor xml:id="_rvt_8py_source_1l00075"/>00075 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;meanMotion&#32;=&#32;sqrt(self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a8493644f9fb90b7281e7d31c55ab28cd">mu</link>&#32;/&#32;(a&#32;**&#32;3))
<anchor xml:id="_rvt_8py_source_1l00076"/>00076 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;2.0&#32;*&#32;math.pi&#32;/&#32;meanMotion;&#32;&#32;<emphasis role="comment">#&#32;in&#32;seconds</emphasis>
<anchor xml:id="_rvt_8py_source_1l00077"/>00077 &#32;&#32;&#32;&#32;
<anchor xml:id="_rvt_8py_source_1l00078"/><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1aa7b28bbd31a31d3e581bb55442706e11">00078</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1aa7b28bbd31a31d3e581bb55442706e11">rotate</link>(self,&#32;k,&#32;theta):
<anchor xml:id="_rvt_8py_source_1l00079"/>00079 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;orb&#32;=&#32;<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt">rvt</link>(self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a29d745cf30a1183a4864388d4508a36a">r</link>,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a15400b6669841eae54dc14817157e01b">v</link>,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1ac929fbefb4b213b9704c21455c01f816">t</link>,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a8493644f9fb90b7281e7d31c55ab28cd">mu</link>)
<anchor xml:id="_rvt_8py_source_1l00080"/>00080 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;orb.r&#32;=&#32;<link linkend="_namespaceexamples_1_1kepler_1_1rvt_1aeb74e648c4036b6aaad59775e779a010">rotate_vector</link>(self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a29d745cf30a1183a4864388d4508a36a">r</link>,&#32;k,&#32;theta)
<anchor xml:id="_rvt_8py_source_1l00081"/>00081 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;orb.v&#32;=&#32;<link linkend="_namespaceexamples_1_1kepler_1_1rvt_1aeb74e648c4036b6aaad59775e779a010">rotate_vector</link>(self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a15400b6669841eae54dc14817157e01b">v</link>,&#32;k,&#32;theta)
<anchor xml:id="_rvt_8py_source_1l00082"/>00082 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;orb&#32;
<anchor xml:id="_rvt_8py_source_1l00083"/>00083 &#32;&#32;&#32;&#32;
<anchor xml:id="_rvt_8py_source_1l00084"/><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a747fb07fc3a13f967f0f3fd8ae48e584">00084</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a747fb07fc3a13f967f0f3fd8ae48e584">tof</link>(self,&#32;rvt2):
<anchor xml:id="_rvt_8py_source_1l00085"/>00085 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;rvt2.t&#32;-&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1ac929fbefb4b213b9704c21455c01f816">t</link>
<anchor xml:id="_rvt_8py_source_1l00086"/>00086 &#32;&#32;&#32;&#32;
<anchor xml:id="_rvt_8py_source_1l00087"/><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1ae8cd128d9131857db5d5695b6e48d0c0">00087</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis><link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1ae8cd128d9131857db5d5695b6e48d0c0">copy</link>(self):
<anchor xml:id="_rvt_8py_source_1l00088"/>00088 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt">rvt</link>(self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a29d745cf30a1183a4864388d4508a36a">r</link>,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a15400b6669841eae54dc14817157e01b">v</link>,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1ac929fbefb4b213b9704c21455c01f816">t</link>,&#32;self.<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt_1a8493644f9fb90b7281e7d31c55ab28cd">mu</link>)
<anchor xml:id="_rvt_8py_source_1l00089"/>00089 
<anchor xml:id="_rvt_8py_source_1l00090"/><link linkend="_namespaceexamples_1_1kepler_1_1rvt_1a0fb133f46a6fcb5df906d942441ec464">00090</link> <emphasis role="keyword">def&#32;</emphasis><link linkend="_namespaceexamples_1_1kepler_1_1rvt_1a0fb133f46a6fcb5df906d942441ec464">rvt_kepler</link>(kep):&#32;&#32;&#32;&#32;
<anchor xml:id="_rvt_8py_source_1l00091"/>00091 &#32;&#32;&#32;&#32;rv&#32;=&#32;par2ic(kep.kep(),&#32;kep.mu)
<anchor xml:id="_rvt_8py_source_1l00092"/>00092 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt">rvt</link>(rv[0],&#32;rv[1],&#32;kep.t,&#32;kep.mu)
<anchor xml:id="_rvt_8py_source_1l00093"/>00093 
<anchor xml:id="_rvt_8py_source_1l00094"/><link linkend="_namespaceexamples_1_1kepler_1_1rvt_1a6027e9c84ce0081e4d5a4cf0ed8bd9d4">00094</link> <emphasis role="keyword">def&#32;</emphasis><link linkend="_namespaceexamples_1_1kepler_1_1rvt_1a6027e9c84ce0081e4d5a4cf0ed8bd9d4">rvt_planet</link>(pl,&#32;time):
<anchor xml:id="_rvt_8py_source_1l00095"/>00095 &#32;&#32;&#32;&#32;r,&#32;v&#32;=&#32;pl.eph(epoch(time&#32;*&#32;SEC2DAY))
<anchor xml:id="_rvt_8py_source_1l00096"/>00096 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt">rvt</link>(r,&#32;v,&#32;time,&#32;pl.mu_central_body)
<anchor xml:id="_rvt_8py_source_1l00097"/>00097 
<anchor xml:id="_rvt_8py_source_1l00098"/><link linkend="_namespaceexamples_1_1kepler_1_1rvt_1aeb74e648c4036b6aaad59775e779a010">00098</link> <emphasis role="keyword">def&#32;</emphasis><link linkend="_namespaceexamples_1_1kepler_1_1rvt_1aeb74e648c4036b6aaad59775e779a010">rotate_vector</link>(v,&#32;k,&#32;theta):
<anchor xml:id="_rvt_8py_source_1l00099"/>00099 &#32;&#32;&#32;&#32;dP&#32;=&#32;np.dot(k,&#32;v)
<anchor xml:id="_rvt_8py_source_1l00100"/>00100 &#32;&#32;&#32;&#32;cosTheta&#32;=&#32;cos(theta)
<anchor xml:id="_rvt_8py_source_1l00101"/>00101 &#32;&#32;&#32;&#32;sinTheta&#32;=&#32;sin(theta)
<anchor xml:id="_rvt_8py_source_1l00102"/>00102 &#32;&#32;&#32;&#32;<emphasis role="comment">#&#32;rotate&#32;using&#32;Rodrigues&#32;rotation&#32;formula</emphasis>
<anchor xml:id="_rvt_8py_source_1l00103"/>00103 &#32;&#32;&#32;&#32;rrot&#32;=&#32;[
<anchor xml:id="_rvt_8py_source_1l00104"/>00104 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;a&#32;*&#32;cosTheta&#32;+&#32;b&#32;*&#32;sinTheta&#32;+&#32;c&#32;*&#32;(1&#32;-&#32;cosTheta)&#32;*&#32;dP
<anchor xml:id="_rvt_8py_source_1l00105"/>00105 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;a,&#32;b,&#32;c&#32;<emphasis role="keywordflow">in</emphasis>&#32;zip(v,&#32;np.cross(k,&#32;v),&#32;k)
<anchor xml:id="_rvt_8py_source_1l00106"/>00106 &#32;&#32;&#32;&#32;]
<anchor xml:id="_rvt_8py_source_1l00107"/>00107 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;rrot
<anchor xml:id="_rvt_8py_source_1l00108"/>00108 
</programlisting></section>
