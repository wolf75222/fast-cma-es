<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_gtoc12_8py_source" xml:lang="en-US">
<title>gtoc12.py</title>
<indexterm><primary>examples/gtoc12/gtoc12.py</primary></indexterm>
Go to the documentation of this file.<programlisting linenumbering="unnumbered"><anchor xml:id="_gtoc12_8py_source_1l00001"/><link linkend="_namespacegtoc12">00001</link> <emphasis role="stringliteral">&apos;&apos;&apos;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00002"/>00002 <emphasis role="stringliteral">GTOC&#32;(Global&#32;Trajectory&#32;Optimization&#32;Competition)&#32;was&#32;initiated&#32;20&#32;years&#32;ago&#32;by&#32;ESA&#32;to&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00003"/>00003 <emphasis role="stringliteral">provide&#32;a&#32;platform&#32;for&#32;Space&#32;Agencies&#32;to&#32;exchange&#32;ideas&#32;how&#32;to&#32;plan&#32;space&#32;flights.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00004"/>00004 <emphasis role="stringliteral">Every&#32;one&#32;or&#32;two&#32;years&#32;the&#32;best&#32;space&#32;trajectory&#32;planners&#32;in&#32;the&#32;world,&#32;including</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00005"/>00005 <emphasis role="stringliteral">JPL&#32;(NASA)&#32;and&#32;ESA,&#32;compete&#32;solving&#32;a&#32;complex&#32;task.&#32;This&#32;example&#32;is&#32;related&#32;to&#32;GTOC12,</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00006"/>00006 <emphasis role="stringliteral">which&#32;is&#32;about&#32;planning&#32;the&#32;mining&#32;of&#32;asteroids&#32;as&#32;efficiently&#32;as&#32;possible.</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00007"/>00007 <emphasis role="stringliteral"></emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00008"/>00008 <emphasis role="stringliteral">Each&#32;ship&#32;departs&#32;from&#32;and&#32;returns&#32;to&#32;earth,&#32;visiting&#32;a&#32;number&#32;of&#32;asteroids&#32;in&#32;between.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00009"/>00009 <emphasis role="stringliteral">At&#32;the&#32;first&#32;visit&#32;a&#32;miner&#32;is&#32;dropped,&#32;at&#32;the&#32;second&#32;visit&#32;the&#32;mined&#32;material&#32;is&#32;collected.</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00010"/>00010 <emphasis role="stringliteral">Each&#32;miner&#32;collects&#32;10&#32;kg&#32;material&#32;per&#32;year.&#32;&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00011"/>00011 <emphasis role="stringliteral">Only&#32;one&#32;miner&#32;per&#32;asteroid&#32;is&#32;allowed,&#32;and&#32;there&#32;are&#32;60000&#32;asteroids&#32;to&#32;choose&#32;from.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00012"/>00012 <emphasis role="stringliteral">Goal&#32;is&#32;to&#32;maximize&#32;the&#32;average&#32;material&#32;mined&#32;by&#32;each&#32;ship.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00013"/>00013 <emphasis role="stringliteral">The&#32;whole&#32;mining&#32;operation&#32;is&#32;limited&#32;to&#32;15&#32;years&#32;(epoch&#32;64328&#32;-&#32;epoch&#32;69807&#32;MJD),</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00014"/>00014 <emphasis role="stringliteral">see&#32;https://gtoc12.tsinghua.edu.cn/competition/theProblem&#32;for&#32;the&#32;original&#32;task&#32;description.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00015"/>00015 <emphasis role="stringliteral"></emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00016"/>00016 <emphasis role="stringliteral">This&#32;example&#32;solves&#32;a&#32;subtask&#32;of&#32;GTOC12,&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00017"/>00017 <emphasis role="stringliteral">For&#32;a&#32;cluster&#32;of&#32;44&#32;Asteroids&#32;taken&#32;from&#32;JPLs&#32;winning&#32;solution</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00018"/>00018 <emphasis role="stringliteral">we&#32;computed&#32;a&#32;full&#32;asteroid-asteroid&#32;transfer&#32;graph.&#32;This&#32;graph</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00019"/>00019 <emphasis role="stringliteral">excludes&#32;transfers/edges&#32;which&#32;are&#32;too&#32;early&#32;/&#32;too&#32;late&#32;to&#32;facilitate&#32;earth-&gt;asteroid</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00020"/>00020 <emphasis role="stringliteral">or&#32;asteroid-&gt;earth&#32;transfers.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00021"/>00021 <emphasis role="stringliteral"></emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00022"/>00022 <emphasis role="stringliteral">A&#32;possible&#32;transfer&#32;is&#32;defined&#32;by&#32;the&#32;tuple&#32;(a1,&#32;a2,&#32;dm,&#32;ep,&#32;tof)&#32;where:</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00023"/>00023 <emphasis role="stringliteral"></emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00024"/>00024 <emphasis role="stringliteral">Graph&#32;nodes:</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00025"/>00025 <emphasis role="stringliteral">a1:&#32;start&#32;asteroid&#32;of&#32;the&#32;transfer</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00026"/>00026 <emphasis role="stringliteral">a2:&#32;target&#32;asteroid&#32;of&#32;the&#32;transfer</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00027"/>00027 <emphasis role="stringliteral"></emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00028"/>00028 <emphasis role="stringliteral">Graph&#32;edge&#32;attributes:</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00029"/>00029 <emphasis role="stringliteral">dm:&#32;delta&#32;propellant&#32;mass,&#32;propellant&#32;consumption</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00030"/>00030 <emphasis role="stringliteral">ep:&#32;start&#32;epoch&#32;(day)</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00031"/>00031 <emphasis role="stringliteral">tof:&#32;time&#32;of&#32;flight,&#32;ep&#32;+&#32;tof&#32;is&#32;the&#32;arrival&#32;epoch</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00032"/>00032 <emphasis role="stringliteral"></emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00033"/>00033 <emphasis role="stringliteral">For&#32;a&#32;fixed&#32;number&#32;of&#32;ships,&#32;the&#32;task&#32;is&#32;now&#32;to&#32;maximize&#32;the&#32;mined&#32;material&#32;(per&#32;ship)</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00034"/>00034 <emphasis role="stringliteral">by&#32;finding&#32;graph&#32;paths&#32;corresponding&#32;to&#32;the&#32;ship&#32;trajectories&#32;fulfilling&#32;all</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00035"/>00035 <emphasis role="stringliteral">constraints:</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00036"/>00036 <emphasis role="stringliteral"></emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00037"/>00037 <emphasis role="stringliteral">-&#32;A&#32;ship&#32;may&#32;not&#32;start&#32;heading&#32;for&#32;the&#32;next&#32;asteroid&#32;before&#32;it&#32;arrives&#32;at&#32;an&#32;asteroid.</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00038"/>00038 <emphasis role="stringliteral">-&#32;Propellant&#32;consumption&#32;(sum&#32;of&#32;the&#32;dm&#32;values&#32;along&#32;the&#32;path)&#32;is&#32;limited&#32;(&lt;=&#32;1500&#32;kg)&#32;for&#32;each&#32;ship.</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00039"/>00039 <emphasis role="stringliteral">-&#32;Each&#32;asteroid&#32;can&#32;be&#32;visited&#32;at&#32;most&#32;twice.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00040"/>00040 <emphasis role="stringliteral">-&#32;If&#32;a&#32;ship&#32;arrives&#32;at&#32;an&#32;asteroid&#32;which&#32;was&#32;visited&#32;before,&#32;it&#32;collects&#32;10*y&#32;kg&#32;material,&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00041"/>00041 <emphasis role="stringliteral">&#32;&#32;where&#32;y&#32;is&#32;the&#32;time&#32;in&#32;years&#32;since&#32;the&#32;first&#32;visit.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00042"/>00042 <emphasis role="stringliteral">-&#32;If&#32;there&#32;is&#32;no&#32;edge&#32;to&#32;any&#32;target&#32;asteroid&#32;after&#32;the&#32;arrival&#32;time&#32;or&#32;propellant&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00043"/>00043 <emphasis role="stringliteral">&#32;&#32;consumption&#32;would&#32;exceed&#32;the&#32;limit&#32;the&#32;journey&#32;for&#32;the&#32;ship&#32;ends.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00044"/>00044 <emphasis role="stringliteral"></emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00045"/>00045 <emphasis role="stringliteral">This&#32;task,&#32;although&#32;quite&#32;similar&#32;to&#32;ESAs&#32;Wormhole&#32;task&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00046"/>00046 <emphasis role="stringliteral">https://optimise.esa.int/challenge/spoc-2-wormhole-transportation-network/p/wormhole-transportation-network</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00047"/>00047 <emphasis role="stringliteral">differs&#32;in&#32;several&#32;aspects:</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00048"/>00048 <emphasis role="stringliteral"></emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00049"/>00049 <emphasis role="stringliteral">-&#32;Much&#32;lower&#32;number&#32;of&#32;nodes&#32;-&#32;only&#32;44&#32;instead&#32;of&#32;10000.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00050"/>00050 <emphasis role="stringliteral">-&#32;All&#32;ships&#32;(and&#32;not&#32;only&#32;two)&#32;are&#32;relevant.</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00051"/>00051 <emphasis role="stringliteral">-&#32;Number&#32;of&#32;edges&#32;is&#32;similar&#32;-&#32;246736,&#32;but&#32;we&#32;have&#32;for&#32;each&#32;asteroid&#32;4000-8000&#32;outgoing&#32;edges&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00052"/>00052 <emphasis role="stringliteral">&#32;&#32;and&#32;on&#32;average&#32;130&#32;(up&#32;to&#32;444)&#32;edges&#32;between&#32;any&#32;two&#32;asteroids.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00053"/>00053 <emphasis role="stringliteral">-&#32;Any&#32;node&#32;can&#32;be&#32;used&#32;as&#32;start&#32;/&#32;target&#32;node.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00054"/>00054 <emphasis role="stringliteral"></emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00055"/>00055 <emphasis role="stringliteral">Independent&#32;from&#32;GTOC12&#32;the&#32;subtask&#32;shown&#32;here&#32;represents&#32;an&#32;interesting&#32;variation&#32;of&#32;the</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00056"/>00056 <emphasis role="stringliteral">Multiple&#32;Vehicle&#32;Routing&#32;Problem&#32;(https://developers.google.com/optimization/routing/vrp),&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00057"/>00057 <emphasis role="stringliteral">where&#32;instead&#32;of&#32;fixed&#32;distances&#32;between&#32;targets/asteroids&#32;there&#32;are&#32;many&#32;different&#32;time&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00058"/>00058 <emphasis role="stringliteral">dependent&#32;opportunities&#32;to&#32;fly&#32;from&#32;one&#32;asteroid&#32;to&#32;another.&#32;These&#32;opportunities&#32;differ</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00059"/>00059 <emphasis role="stringliteral">both&#32;in&#32;time&#32;of&#32;flight&#32;and&#32;propellant&#32;consumption.&#32;Solving&#32;this&#32;class&#32;of&#32;problems&#32;can</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00060"/>00060 <emphasis role="stringliteral">assist&#32;the&#32;planning&#32;of&#32;complex&#32;space&#32;flight&#32;operations&#32;involving&#32;many&#32;ships.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00061"/>00061 <emphasis role="stringliteral">Beside&#32;asteroid&#32;mining&#32;other&#32;applications&#32;could&#32;be&#32;space&#32;debris&#32;removal&#32;or&#32;maintenance/repair</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00062"/>00062 <emphasis role="stringliteral">of&#32;large&#32;satellite&#32;networks.</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00063"/>00063 <emphasis role="stringliteral"></emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00064"/>00064 <emphasis role="stringliteral">The&#32;task&#32;is&#32;at&#32;the&#32;same&#32;time&#32;quite&#32;simple&#32;and&#32;very&#32;hard&#32;to&#32;solve&#32;using&#32;search.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00065"/>00065 <emphasis role="stringliteral">Problem&#32;is&#32;the&#32;&quot;coordination&quot;&#32;of&#32;dropping&#32;the&#32;miner&#32;and&#32;collecting&#32;the&#32;mined&#32;material</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00066"/>00066 <emphasis role="stringliteral">between&#32;ships.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00067"/>00067 <emphasis role="stringliteral"></emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00068"/>00068 <emphasis role="stringliteral">If&#32;we&#32;expand&#32;the&#32;branches&#32;for&#32;all&#32;ships&#32;simultaneously&#32;the&#32;branching&#32;factor&#32;explodes.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00069"/>00069 <emphasis role="stringliteral">But&#32;if&#32;the&#32;ships&#32;are&#32;processed&#32;sequentially&#32;it&#32;is&#32;very&#32;hard&#32;to&#32;come&#32;up&#32;with&#32;a&#32;good&#32;heuristic</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00070"/>00070 <emphasis role="stringliteral">which&#32;branches&#32;to&#32;eliminate.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00071"/>00071 <emphasis role="stringliteral"></emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00072"/>00072 <emphasis role="stringliteral">Here&#32;we&#32;use&#32;continuous&#32;evolutionary&#32;optimization&#32;-&#32;the&#32;BiteOpt&#32;meta-algorithm&#32;which&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00073"/>00073 <emphasis role="stringliteral">dynamically&#32;adapts&#32;the&#32;population&#32;update&#32;method.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00074"/>00074 <emphasis role="stringliteral"></emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00075"/>00075 <emphasis role="stringliteral">The&#32;objective&#32;fitness&#32;function&#32;looks&#32;as&#32;follows:</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00076"/>00076 <emphasis role="stringliteral"></emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00077"/>00077 <emphasis role="stringliteral">-&#32;Let&#32;n&#32;=&#32;44&#32;be&#32;the&#32;number&#32;of&#32;asteroids&#32;in&#32;the&#32;cluster&#32;/&#32;the&#32;number&#32;of&#32;nodes.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00078"/>00078 <emphasis role="stringliteral">-&#32;X&#32;is&#32;the&#32;argument&#32;vector&#32;containing&#32;2*n=88&#32;decision&#32;variables&#32;in&#32;the&#32;interval&#32;[0,1].&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00079"/>00079 <emphasis role="stringliteral">-&#32;p&#32;=&#32;numpy.argsort(X)&#32;is&#32;a&#32;permutation&#32;of&#32;the&#32;integers&#32;between&#32;0&#32;and&#32;88&#32;dependent</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00080"/>00080 <emphasis role="stringliteral">&#32;&#32;on&#32;the&#32;argument&#32;vector&#32;X.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00081"/>00081 <emphasis role="stringliteral">-&#32;seq&#32;=&#32;[i&#32;%&#32;n&#32;for&#32;i&#32;in&#32;p]&#32;is&#32;a&#32;sequence&#32;of&#32;88&#32;asteroid&#32;indices&#32;where&#32;each&#32;asteroid&#32;occurs&#32;exactly&#32;twice.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00082"/>00082 <emphasis role="stringliteral">-&#32;remove&#32;asteroids&#32;from&#32;seq,&#32;starting&#32;from&#32;the&#32;first&#32;one&#32;(including&#32;its&#32;2nd&#32;occurrence)&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00083"/>00083 <emphasis role="stringliteral">&#32;&#32;until&#32;the&#32;asteroid&#32;sequence&#32;has&#32;a&#32;specific&#32;length&#32;l.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00084"/>00084 <emphasis role="stringliteral">&#32;&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00085"/>00085 <emphasis role="stringliteral">We&#32;end&#32;up&#32;with&#32;an&#32;asteroid&#32;sequence&#32;of&#32;length&#32;l&#32;depending&#32;on&#32;the&#32;argument&#32;vector&#32;X&#32;which&#32;contains</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00086"/>00086 <emphasis role="stringliteral">each&#32;asteroid&#32;exactly&#32;twice.&#32;l&#32;depends&#32;on&#32;the&#32;number&#32;of&#32;ships&#32;n&#32;and&#32;should&#32;be&#32;adjusted&#32;performing&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00087"/>00087 <emphasis role="stringliteral">test&#32;runs&#32;of&#32;the&#32;optimization.&#32;l&#32;limits&#32;the&#32;path&#32;length&#32;for&#32;each&#32;ship,&#32;but&#32;if&#32;chosen&#32;too&#32;high&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00088"/>00088 <emphasis role="stringliteral">the&#32;optimization&#32;itself&#32;has&#32;to&#32;ensure&#32;there&#32;are&#32;only&#32;asteroid&#32;pairs&#32;in&#32;all&#32;paths.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00089"/>00089 <emphasis role="stringliteral"></emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00090"/>00090 <emphasis role="stringliteral">Now&#32;we&#32;follow&#32;the&#32;graph&#32;using&#32;the&#32;sequence&#32;determined&#32;by&#32;the&#32;decision&#32;variables&#32;as&#32;&quot;guidance&quot;.</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00091"/>00091 <emphasis role="stringliteral">We&#32;always&#32;choose&#32;the&#32;first&#32;possible&#32;transfer&#32;between&#32;two&#32;asteroids/nodes.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00092"/>00092 <emphasis role="stringliteral">If&#32;there&#32;is&#32;no&#32;such&#32;transfer&#32;-&#32;or&#32;the&#32;ships&#32;fuel&#32;consumption&#32;would&#32;be&#32;above&#32;the&#32;limit,&#32;we&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00093"/>00093 <emphasis role="stringliteral">&quot;start&quot;&#32;the&#32;next&#32;ship&#32;/&#32;path.&#32;If&#32;there&#32;is&#32;no&#32;more&#32;ship&#32;available&#32;we&#32;compute&#32;the&#32;mined&#32;material</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00094"/>00094 <emphasis role="stringliteral">and&#32;use&#32;this&#32;as&#32;objective&#32;to&#32;maximize.&#32;Additional&#32;objectives&#32;are&#32;propellant&#32;consumption&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00095"/>00095 <emphasis role="stringliteral">and&#32;the&#32;sum&#32;of&#32;the&#32;length&#32;of&#32;all&#32;paths&#32;added&#32;using&#32;the</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00096"/>00096 <emphasis role="stringliteral">weighted&#32;sum&#32;approach.&#32;Although&#32;we&#32;are&#32;only&#32;interested&#32;in&#32;the&#32;mined&#32;material,&#32;the&#32;other</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00097"/>00097 <emphasis role="stringliteral">objectives&#32;serve&#32;as&#32;an&#32;heuristic&#32;&quot;guiding&quot;&#32;the&#32;optimization.</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00098"/>00098 <emphasis role="stringliteral"></emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00099"/>00099 <emphasis role="stringliteral">The&#32;result&#32;can&#32;further&#32;be&#32;enhanced&#32;by&#32;applying&#32;a&#32;second&#32;optimization&#32;(not&#32;include&#32;here,&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00100"/>00100 <emphasis role="stringliteral">left&#32;as&#32;exercise).&#32;This&#32;time&#32;the&#32;asteroid&#32;sequence&#32;is&#32;fixed,&#32;but&#32;instead&#32;of&#32;the&#32;first</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00101"/>00101 <emphasis role="stringliteral">possible&#32;transfer&#32;we&#32;choose&#32;the&#32;nth&#32;one,&#32;where&#32;n&#32;is&#32;selected&#32;according&#32;the&#32;continuous&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00102"/>00102 <emphasis role="stringliteral">argument&#32;vector.&#32;If&#32;n&#32;is&#32;in&#32;the&#32;interval&#32;[1,&#32;n_max]&#32;we&#32;convert&#32;the&#32;continuous&#32;argument&#32;vector</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00103"/>00103 <emphasis role="stringliteral">to&#32;integer&#32;values&#32;using&#32;ns&#32;=&#32;X.astype(int).&#32;You&#32;need&#32;to&#32;define&#32;a&#32;function</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00104"/>00104 <emphasis role="stringliteral">&apos;_transfer_n(n,&#32;a2,&#32;epoch_min,&#32;transfers,&#32;idx)&apos;&#32;selecting&#32;the&#32;nth&#32;instead&#32;of&#32;the&#32;first</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00105"/>00105 <emphasis role="stringliteral">possible&#32;transfer,&#32;and&#32;a&#32;function&#32;&apos;eval_sequence_n(sequence,&#32;ns)&apos;&#32;which&#32;applies&#32;it&#32;instead&#32;of&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00106"/>00106 <emphasis role="stringliteral">&apos;_transfer(a2,&#32;epoch_min,&#32;transfers,&#32;idx)&apos;.&#32;As&#32;optimizer&#32;parallel&#32;BiteOpt&#32;can&#32;be&#32;applied&#32;again.</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00107"/>00107 <emphasis role="stringliteral"></emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00108"/>00108 <emphasis role="stringliteral">Our&#32;chosen&#32;propellant&#32;limit&#32;of&#32;1500kg&#32;may&#32;be&#32;a&#32;bit&#32;high&#32;if&#32;you&#32;consider&#32;mined&#32;mass&#32;and</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00109"/>00109 <emphasis role="stringliteral">the&#32;propellant&#32;needed&#32;for&#32;the&#32;transfers&#32;from&#32;and&#32;to&#32;earth.&#32;Therefore&#32;we&#32;need&#32;the&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00110"/>00110 <emphasis role="stringliteral">second&#32;optimization&#32;phase&#32;to&#32;further&#32;reduce&#32;propellant&#32;consumption.&#32;The&#32;weighted&#32;sum&#32;of&#32;the</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00111"/>00111 <emphasis role="stringliteral">objective&#32;function&#32;needs&#32;to&#32;be&#32;adapted&#32;accordingly.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00112"/>00112 <emphasis role="stringliteral">&apos;&apos;&apos;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00113"/>00113 
<anchor xml:id="_gtoc12_8py_source_1l00114"/>00114 <emphasis role="keyword">import</emphasis>&#32;sys
<anchor xml:id="_gtoc12_8py_source_1l00115"/>00115 <emphasis role="keyword">import</emphasis>&#32;time
<anchor xml:id="_gtoc12_8py_source_1l00116"/>00116 
<anchor xml:id="_gtoc12_8py_source_1l00117"/>00117 <emphasis role="keyword">from</emphasis>&#32;fcmaes&#32;<emphasis role="keyword">import</emphasis>&#32;retry
<anchor xml:id="_gtoc12_8py_source_1l00118"/>00118 <emphasis role="keyword">from</emphasis>&#32;<link linkend="_namespacefcmaes_1_1optimizer">fcmaes.optimizer</link>&#32;<emphasis role="keyword">import</emphasis>&#32;dtime,&#32;Bite_cpp,&#32;Cma_cpp,&#32;Crfmnes_cpp
<anchor xml:id="_gtoc12_8py_source_1l00119"/>00119 <emphasis role="keyword">from</emphasis>&#32;loguru&#32;<emphasis role="keyword">import</emphasis>&#32;logger
<anchor xml:id="_gtoc12_8py_source_1l00120"/>00120 <emphasis role="keyword">from</emphasis>&#32;numba&#32;<emphasis role="keyword">import</emphasis>&#32;njit
<anchor xml:id="_gtoc12_8py_source_1l00121"/>00121 <emphasis role="keyword">import</emphasis>&#32;numba
<anchor xml:id="_gtoc12_8py_source_1l00122"/>00122 <emphasis role="keyword">from</emphasis>&#32;scipy.optimize&#32;<emphasis role="keyword">import</emphasis>&#32;Bounds
<anchor xml:id="_gtoc12_8py_source_1l00123"/>00123 
<anchor xml:id="_gtoc12_8py_source_1l00124"/>00124 <emphasis role="keyword">import</emphasis>&#32;ctypes&#32;<emphasis role="keyword">as</emphasis>&#32;ct
<anchor xml:id="_gtoc12_8py_source_1l00125"/>00125 <emphasis role="keyword">import</emphasis>&#32;multiprocessing&#32;<emphasis role="keyword">as</emphasis>&#32;mp&#32;
<anchor xml:id="_gtoc12_8py_source_1l00126"/>00126 <emphasis role="keyword">import</emphasis>&#32;numpy&#32;<emphasis role="keyword">as</emphasis>&#32;np&#32;
<anchor xml:id="_gtoc12_8py_source_1l00127"/>00127 
<anchor xml:id="_gtoc12_8py_source_1l00128"/>00128 
<anchor xml:id="_gtoc12_8py_source_1l00129"/>00129 logger.remove()
<anchor xml:id="_gtoc12_8py_source_1l00130"/><link linkend="_namespacegtoc12_1a18c2454c55e7bb3653a6c20cedb73564">00130</link> logger.add(sys.stdout,&#32;format=<emphasis role="stringliteral">&quot;{time:HH:mm:ss.SS}&#32;|&#32;{process}&#32;|&#32;{level}&#32;|&#32;{message}&quot;</emphasis>,&#32;level=<emphasis role="stringliteral">&quot;DEBUG&quot;</emphasis>)
<anchor xml:id="_gtoc12_8py_source_1l00131"/>00131 logger.add(<emphasis role="stringliteral">&quot;log_{time}.txt&quot;</emphasis>,&#32;format=<emphasis role="stringliteral">&quot;{time:HH:mm:ss.SS}&#32;|&#32;{process}&#32;|&#32;{level}&#32;|&#32;{message}&quot;</emphasis>,&#32;level=<emphasis role="stringliteral">&quot;DEBUG&quot;</emphasis>)
<anchor xml:id="_gtoc12_8py_source_1l00132"/>00132 
<anchor xml:id="_gtoc12_8py_source_1l00133"/><link linkend="_namespacegtoc12_1a8acad931f57ab9670ed027e4c654bcf4">00133</link> MIN_MJD&#32;=&#32;64328
<anchor xml:id="_gtoc12_8py_source_1l00134"/><link linkend="_namespacegtoc12_1a52ead272c2041fc35b63f1eaa61bc58b">00134</link> MAX_MJD&#32;=&#32;69807
<anchor xml:id="_gtoc12_8py_source_1l00135"/>00135 
<anchor xml:id="_gtoc12_8py_source_1l00136"/>00136 <emphasis role="comment">#&#32;Numba&#32;is&#32;used&#32;to&#32;dramatically&#32;speed&#32;up&#32;graph&#32;traversal&#32;and&#32;objective&#32;function&#32;execution</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00137"/>00137 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
<anchor xml:id="_gtoc12_8py_source_1l00138"/>00138 <emphasis role="preprocessor">@njit(fastmath=True,&#32;cache=True)</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00139"/><link linkend="_namespacegtoc12_1a26efcf6f474611baf2b8b91f3008f879">00139</link> <emphasis role="keyword">def&#32;</emphasis><link linkend="_namespacegtoc12_1a26efcf6f474611baf2b8b91f3008f879">_mined</link>(asteroids,&#32;epochs):&#32;<emphasis role="comment">#&#32;mined&#32;material&#32;for&#32;a&#32;sequence&#32;of&#32;asteroids&#32;and&#32;epochs</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00140"/>00140 &#32;&#32;&#32;&#32;mined&#32;=&#32;0
<anchor xml:id="_gtoc12_8py_source_1l00141"/>00141 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;i&#32;<emphasis role="keywordflow">in</emphasis>&#32;range(len(asteroids)-1):
<anchor xml:id="_gtoc12_8py_source_1l00142"/>00142 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;a1&#32;=&#32;asteroids[i]
<anchor xml:id="_gtoc12_8py_source_1l00143"/>00143 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;j&#32;<emphasis role="keywordflow">in</emphasis>&#32;range(i+1,&#32;len(asteroids)):
<anchor xml:id="_gtoc12_8py_source_1l00144"/>00144 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;asteroids[j]&#32;==&#32;a1:
<anchor xml:id="_gtoc12_8py_source_1l00145"/>00145 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;mined&#32;+=&#32;abs(epochs[j]&#32;-&#32;epochs[i])
<anchor xml:id="_gtoc12_8py_source_1l00146"/>00146 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">break</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00147"/>00147 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;10*mined/365.25&#32;<emphasis role="comment">#&#32;mined&#32;per&#32;year</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00148"/>00148 
<anchor xml:id="_gtoc12_8py_source_1l00149"/>00149 <emphasis role="preprocessor">@njit(fastmath=True,&#32;cache=True)</emphasis>&#32;<emphasis role="comment">#&#32;reduce&#32;sequence&#32;to&#32;ast_used&#32;asteroids&#32;maintaining&#32;asteroid&#32;pairs</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00150"/><link linkend="_namespacegtoc12_1a0550f7dc70affbfd3edcc196396272e3">00150</link> <emphasis role="keyword">def&#32;</emphasis><link linkend="_namespacegtoc12_1a0550f7dc70affbfd3edcc196396272e3">_reduce</link>(ast_num,&#32;ast_used,&#32;sequence0):&#32;<emphasis role="comment">#&#32;use&#32;first</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00151"/>00151 &#32;&#32;&#32;&#32;used&#32;=&#32;np.zeros(ast_num,&#32;dtype&#32;=&#32;numba.boolean)
<anchor xml:id="_gtoc12_8py_source_1l00152"/>00152 &#32;&#32;&#32;&#32;sequence&#32;=&#32;np.empty(ast_used,&#32;dtype&#32;=&#32;numba.int32)
<anchor xml:id="_gtoc12_8py_source_1l00153"/>00153 &#32;&#32;&#32;&#32;j&#32;=&#32;0&#32;<emphasis role="comment">#&#32;number&#32;in&#32;sequence</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00154"/>00154 &#32;&#32;&#32;&#32;n&#32;=&#32;0&#32;<emphasis role="comment">#&#32;number&#32;of&#32;asteroids&#32;used</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00155"/>00155 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;i&#32;<emphasis role="keywordflow">in</emphasis>&#32;range(len(sequence0)):
<anchor xml:id="_gtoc12_8py_source_1l00156"/>00156 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;asteroid&#32;=&#32;sequence0[i]
<anchor xml:id="_gtoc12_8py_source_1l00157"/>00157 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;used[asteroid]:
<anchor xml:id="_gtoc12_8py_source_1l00158"/>00158 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;sequence[j]&#32;=&#32;asteroid&#32;<emphasis role="comment">#&#32;always&#32;take&#32;asteroid&#32;already&#32;used</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00159"/>00159 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;j&#32;+=&#32;1
<anchor xml:id="_gtoc12_8py_source_1l00160"/>00160 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">else</emphasis>:
<anchor xml:id="_gtoc12_8py_source_1l00161"/>00161 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;n&#32;&lt;&#32;ast_used:&#32;<emphasis role="comment">#&#32;only&#32;take&#32;new&#32;asteroid&#32;if&#32;not&#32;already&#32;ast_used&#32;taken</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00162"/>00162 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;used[asteroid]&#32;=&#32;<emphasis role="keyword">True</emphasis>&#32;<emphasis role="comment">#&#32;mark&#32;asteroid&#32;as&#32;used&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00163"/>00163 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;n&#32;+=&#32;2
<anchor xml:id="_gtoc12_8py_source_1l00164"/>00164 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;sequence[j]&#32;=&#32;asteroid
<anchor xml:id="_gtoc12_8py_source_1l00165"/>00165 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;j&#32;+=&#32;1
<anchor xml:id="_gtoc12_8py_source_1l00166"/>00166 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;j&#32;&gt;=&#32;len(sequence):
<anchor xml:id="_gtoc12_8py_source_1l00167"/>00167 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;sequence
<anchor xml:id="_gtoc12_8py_source_1l00168"/>00168 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<emphasis role="keywordtype">None</emphasis>&#32;&#32;&#32;
<anchor xml:id="_gtoc12_8py_source_1l00169"/>00169 &#32;&#32;&#32;&#32;
<anchor xml:id="_gtoc12_8py_source_1l00170"/>00170 <emphasis role="preprocessor">@njit(fastmath=True,&#32;cache=True)</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00171"/><link linkend="_namespacegtoc12_1abc2ed451edb0f7c2113a840921194d6e">00171</link> <emphasis role="keyword">def&#32;</emphasis><link linkend="_namespacegtoc12_1abc2ed451edb0f7c2113a840921194d6e">_transfer</link>(a2,&#32;epoch_min,&#32;transfers,&#32;idx):&#32;<emphasis role="comment">#&#32;finds&#32;the&#32;next&#32;possible&#32;transfer&#32;to&#32;asteroid&#32;a2</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00172"/>00172 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;i&#32;<emphasis role="keywordflow">in</emphasis>&#32;idx:&#32;<emphasis role="comment">#&#32;indices&#32;are&#32;used&#32;to&#32;speed&#32;up&#32;graph&#32;traversal</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00173"/>00173 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;transfers[i][2]&#32;==&#32;a2:
<anchor xml:id="_gtoc12_8py_source_1l00174"/>00174 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;transfer&#32;<emphasis role="keywordflow">in</emphasis>&#32;transfers[i+1:]:&#32;<emphasis role="comment">#&#32;numba&#32;is&#32;essential&#32;for&#32;performance&#32;here</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00175"/>00175 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;transfer[0]&#32;&lt;&#32;0:&#32;<emphasis role="comment">#&#32;determines&#32;the&#32;asteroids</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00176"/>00176 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<emphasis role="keywordtype">None</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00177"/>00177 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;epoch&#32;=&#32;transfer[1]
<anchor xml:id="_gtoc12_8py_source_1l00178"/>00178 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;epoch&#32;&lt;&#32;epoch_min:
<anchor xml:id="_gtoc12_8py_source_1l00179"/>00179 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">continue</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00180"/>00180 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;transfer
<anchor xml:id="_gtoc12_8py_source_1l00181"/>00181 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<emphasis role="keywordtype">None</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00182"/>00182 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
<anchor xml:id="_gtoc12_8py_source_1l00183"/><link linkend="_classgtoc12_1_1_transfers">00183</link> <emphasis role="keyword">class&#32;</emphasis><link linkend="_classgtoc12_1_1_transfers">Transfers</link>(object):
<anchor xml:id="_gtoc12_8py_source_1l00184"/>00184 
<anchor xml:id="_gtoc12_8py_source_1l00185"/><link linkend="_classgtoc12_1_1_transfers_1aaaa424f6b67da45e9986fdc5667eb852">00185</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis><link linkend="_classgtoc12_1_1_transfers_1aaaa424f6b67da45e9986fdc5667eb852">__init__</link>(self,&#32;fname):&#32;<emphasis role="comment">#&#32;load&#32;compressed&#32;transfer&#32;graph</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00186"/>00186 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">with</emphasis>&#32;np.load(fname&#32;+&#32;<emphasis role="stringliteral">&apos;.npz&apos;</emphasis>,&#32;allow_pickle=<emphasis role="keyword">True</emphasis>)&#32;<emphasis role="keyword">as</emphasis>&#32;data:
<anchor xml:id="_gtoc12_8py_source_1l00187"/><link linkend="_classgtoc12_1_1_transfers_1abadd280cdaf8d67e168aefee0c239460">00187</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classgtoc12_1_1_transfers_1abadd280cdaf8d67e168aefee0c239460">tmap</link>&#32;=&#32;list(data[<emphasis role="stringliteral">&apos;tmap&apos;</emphasis>])&#32;<emphasis role="comment">#&#32;transfer&#32;graph</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00188"/><link linkend="_classgtoc12_1_1_transfers_1abcf80c94847bb73a34b100c60742e9e2">00188</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classgtoc12_1_1_transfers_1abcf80c94847bb73a34b100c60742e9e2">idx</link>&#32;=&#32;list(data[<emphasis role="stringliteral">&apos;idx&apos;</emphasis>])&#32;<emphasis role="comment">#&#32;indices&#32;to&#32;speed&#32;up&#32;graph&#32;traversal</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00189"/><link linkend="_classgtoc12_1_1_transfers_1a49d677369224818450f5b979a7a329f4">00189</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classgtoc12_1_1_transfers_1a49d677369224818450f5b979a7a329f4">ast_to_id</link>&#32;=&#32;data[<emphasis role="stringliteral">&apos;ast_to_id&apos;</emphasis>].item()&#32;<emphasis role="comment">#&#32;map&#32;to&#32;internal&#32;asteroid&#32;id</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00190"/><link linkend="_classgtoc12_1_1_transfers_1ab5b9afeaca61cdf3c25577629d728e5e">00190</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classgtoc12_1_1_transfers_1ab5b9afeaca61cdf3c25577629d728e5e">id_to_ast</link>&#32;=&#32;data[<emphasis role="stringliteral">&apos;id_to_ast&apos;</emphasis>].item()&#32;<emphasis role="comment">#&#32;map&#32;to&#32;original&#32;asteroid&#32;id</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00191"/><link linkend="_classgtoc12_1_1_transfers_1acd2b847c93a58a6780de47fd7d7782d7">00191</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classgtoc12_1_1_transfers_1acd2b847c93a58a6780de47fd7d7782d7">ast_num</link>&#32;=&#32;len(self.<link linkend="_classgtoc12_1_1_transfers_1a49d677369224818450f5b979a7a329f4">ast_to_id</link>)&#32;<emphasis role="comment">#&#32;number&#32;of&#32;asteroids</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00192"/>00192 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
<anchor xml:id="_gtoc12_8py_source_1l00193"/><link linkend="_classgtoc12_1_1_transfers_1a2809ae2208de935e198087eb7a409760">00193</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis><link linkend="_classgtoc12_1_1_transfers_1a2809ae2208de935e198087eb7a409760">get_transfer</link>(self,&#32;a1,&#32;a2,&#32;ep_min):&#32;<emphasis role="comment">#&#32;finds&#32;the&#32;next&#32;possible&#32;transfer&#32;from&#32;asteroid&#32;a1&#32;to&#32;&#32;a2</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00194"/>00194 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;<link linkend="_namespacegtoc12_1abc2ed451edb0f7c2113a840921194d6e">_transfer</link>(a2,&#32;ep_min,&#32;self.<link linkend="_classgtoc12_1_1_transfers_1abadd280cdaf8d67e168aefee0c239460">tmap</link>[a1],&#32;self.<link linkend="_classgtoc12_1_1_transfers_1abcf80c94847bb73a34b100c60742e9e2">idx</link>[a1])&#32;&#32;
<anchor xml:id="_gtoc12_8py_source_1l00195"/>00195 
<anchor xml:id="_gtoc12_8py_source_1l00196"/><link linkend="_namespacegtoc12_1ae69e77fa378b33f00726f3d6f69299bd">00196</link> <emphasis role="keyword">def&#32;</emphasis><link linkend="_namespacegtoc12_1ae69e77fa378b33f00726f3d6f69299bd">optimize</link>(fname,&#32;max_evals=200000,&#32;num_restarts=32,&#32;seq=None):
<anchor xml:id="_gtoc12_8py_source_1l00197"/>00197 &#32;&#32;&#32;&#32;transfers&#32;=&#32;<link linkend="_classgtoc12_1_1_transfers">Transfers</link>(fname)&#32;
<anchor xml:id="_gtoc12_8py_source_1l00198"/>00198 &#32;&#32;&#32;&#32;best_mined&#32;=&#32;mp.RawValue(ct.c_double,&#32;0)&#32;
<anchor xml:id="_gtoc12_8py_source_1l00199"/>00199 &#32;&#32;&#32;&#32;best_y&#32;=&#32;mp.RawValue(ct.c_double,&#32;1E99)&#32;
<anchor xml:id="_gtoc12_8py_source_1l00200"/>00200 &#32;&#32;&#32;&#32;t0&#32;=&#32;time.perf_counter()
<anchor xml:id="_gtoc12_8py_source_1l00201"/>00201 &#32;&#32;&#32;&#32;evals&#32;=&#32;mp.RawValue(ct.c_int,&#32;0)&#32;&#32;
<anchor xml:id="_gtoc12_8py_source_1l00202"/>00202 &#32;&#32;&#32;&#32;ast_num&#32;=&#32;transfers.ast_num
<anchor xml:id="_gtoc12_8py_source_1l00203"/>00203 
<anchor xml:id="_gtoc12_8py_source_1l00204"/>00204 &#32;&#32;&#32;&#32;ast_used&#32;=&#32;68&#32;<emphasis role="comment">#&#32;corresponds&#32;to&#32;&quot;l&quot;&#32;in&#32;the&#32;description&#32;above.&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00205"/>00205 &#32;&#32;&#32;&#32;ship_used&#32;=&#32;4&#32;<emphasis role="comment">#&#32;number&#32;of&#32;ships</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00206"/>00206 
<anchor xml:id="_gtoc12_8py_source_1l00207"/>00207 &#32;&#32;&#32;&#32;dim&#32;=&#32;2*ast_num
<anchor xml:id="_gtoc12_8py_source_1l00208"/>00208 &#32;&#32;&#32;&#32;bounds&#32;=&#32;Bounds([0]*dim,&#32;[1-1E-10]*dim)&#32;<emphasis role="comment">#&#32;continous&#32;decision&#32;variables&#32;in&#32;the&#32;[0,1]&#32;interval&#32;&#32;&#32;&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00209"/>00209 &#32;&#32;&#32;&#32;workers&#32;=&#32;mp.cpu_count()&#32;<emphasis role="comment">#&#32;we&#32;use&#32;all&#32;CPU&#32;cores&#32;&#32;&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00210"/>00210 &#32;&#32;&#32;&#32;
<anchor xml:id="_gtoc12_8py_source_1l00211"/>00211 &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis>fit(x):&#32;
<anchor xml:id="_gtoc12_8py_source_1l00212"/>00212 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;permutation&#32;=&#32;np.fromiter((a&#32;%&#32;ast_num&#32;<emphasis role="keywordflow">for</emphasis>&#32;a&#32;<emphasis role="keywordflow">in</emphasis>&#32;np.argsort(x)),&#32;dtype&#32;=&#32;int)
<anchor xml:id="_gtoc12_8py_source_1l00213"/>00213 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;sequence&#32;=&#32;<link linkend="_namespacegtoc12_1a0550f7dc70affbfd3edcc196396272e3">_reduce</link>(ast_num,&#32;ast_used,&#32;permutation)&#32;<emphasis role="comment">#&#32;shorten&#32;the&#32;sequence&#32;of&#32;asteroids</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00214"/>00214 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;eval_sequence(sequence)
<anchor xml:id="_gtoc12_8py_source_1l00215"/>00215 &#32;&#32;&#32;&#32;
<anchor xml:id="_gtoc12_8py_source_1l00216"/>00216 &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis>eval_sequence(sequence):&#32;
<anchor xml:id="_gtoc12_8py_source_1l00217"/>00217 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">try</emphasis>:
<anchor xml:id="_gtoc12_8py_source_1l00218"/>00218 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ships&#32;=&#32;0
<anchor xml:id="_gtoc12_8py_source_1l00219"/>00219 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;epoch&#32;=&#32;0
<anchor xml:id="_gtoc12_8py_source_1l00220"/>00220 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;mass&#32;=&#32;0
<anchor xml:id="_gtoc12_8py_source_1l00221"/>00221 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;all_mass&#32;=&#32;[]
<anchor xml:id="_gtoc12_8py_source_1l00222"/>00222 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;y&#32;=&#32;0
<anchor xml:id="_gtoc12_8py_source_1l00223"/>00223 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;epochs&#32;=&#32;[]
<anchor xml:id="_gtoc12_8py_source_1l00224"/>00224 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;asteroids&#32;=&#32;[]
<anchor xml:id="_gtoc12_8py_source_1l00225"/>00225 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;start_asts&#32;=&#32;[]
<anchor xml:id="_gtoc12_8py_source_1l00226"/>00226 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;i&#32;<emphasis role="keywordflow">in</emphasis>&#32;range(len(sequence)-1):
<anchor xml:id="_gtoc12_8py_source_1l00227"/>00227 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;a1&#32;=&#32;sequence[i]
<anchor xml:id="_gtoc12_8py_source_1l00228"/>00228 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;a2&#32;=&#32;sequence[i+1]&#32;&#32;&#32;
<anchor xml:id="_gtoc12_8py_source_1l00229"/>00229 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">#&#32;transfer&#32;=&#32;delta_mass,&#32;epoch_start,&#32;time_of_flight</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00230"/>00230 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;transfer&#32;=&#32;transfers.get_transfer(a1,&#32;a2,&#32;epoch)&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
<anchor xml:id="_gtoc12_8py_source_1l00231"/>00231 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;transfer&#32;<emphasis role="keywordflow">is</emphasis>&#32;<emphasis role="keywordtype">None</emphasis>&#32;<emphasis role="keywordflow">or</emphasis>&#32;mass&#32;+&#32;transfer[0]&#32;&gt;&#32;1500:&#32;<emphasis role="comment">#&#32;limit&#32;delta&#32;mass&#32;to&#32;1500&#32;kg</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00232"/>00232 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;ships&#32;+=&#32;1&#32;<emphasis role="comment">#&#32;last&#32;path&#32;ended,&#32;start&#32;a&#32;new&#32;ship&#32;/&#32;path</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00233"/>00233 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;epoch&#32;=&#32;0
<anchor xml:id="_gtoc12_8py_source_1l00234"/>00234 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;all_mass.append(mass)&#32;<emphasis role="comment">#&#32;accumulate&#32;propellant&#32;consumption&#32;for&#32;all&#32;paths</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00235"/>00235 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;mass&#32;=&#32;0
<anchor xml:id="_gtoc12_8py_source_1l00236"/>00236 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;ships&#32;&gt;=&#32;ship_used:&#32;
<anchor xml:id="_gtoc12_8py_source_1l00237"/>00237 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">break</emphasis>&#32;<emphasis role="comment">#&#32;no&#32;ship&#32;left</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00238"/>00238 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">else</emphasis>:
<anchor xml:id="_gtoc12_8py_source_1l00239"/>00239 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;delta_mass,&#32;epoch_start,&#32;time_of_flight&#32;=&#32;transfer
<anchor xml:id="_gtoc12_8py_source_1l00240"/>00240 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;epoch&#32;==&#32;0:&#32;<emphasis role="comment">#&#32;first&#32;asteroid&#32;of&#32;a&#32;path&#32;(coming&#32;from&#32;earth)</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00241"/>00241 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;epochs.append(epoch_start)
<anchor xml:id="_gtoc12_8py_source_1l00242"/>00242 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;asteroids.append(a1)
<anchor xml:id="_gtoc12_8py_source_1l00243"/>00243 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;start_asts.append(a1)
<anchor xml:id="_gtoc12_8py_source_1l00244"/>00244 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;epoch&#32;=&#32;epoch_start&#32;+&#32;time_of_flight
<anchor xml:id="_gtoc12_8py_source_1l00245"/>00245 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;asteroids.append(a2)&#32;<emphasis role="comment">#&#32;target&#32;asteroid&#32;a2</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00246"/>00246 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;epochs.append(epoch)
<anchor xml:id="_gtoc12_8py_source_1l00247"/>00247 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;mass&#32;+=&#32;delta_mass&#32;<emphasis role="comment">#&#32;accumulate&#32;propellant&#32;consumption&#32;for&#32;transfers</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00248"/>00248 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;mass&#32;&gt;&#32;0:&#32;<emphasis role="comment">#&#32;increase&#32;ast_used&#32;if&#32;this&#32;happens,&#32;sequence&#32;is&#32;too&#32;short&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00249"/>00249 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;all_mass.append(mass)&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
<anchor xml:id="_gtoc12_8py_source_1l00250"/>00250 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;mined&#32;=&#32;<link linkend="_namespacegtoc12_1a26efcf6f474611baf2b8b91f3008f879">_mined</link>(np.array(asteroids),&#32;np.array(epochs))&#32;/&#32;ship_used
<anchor xml:id="_gtoc12_8py_source_1l00251"/>00251 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;y&#32;=&#32;-mined&#32;+&#32;0.1*np.mean(all_mass)&#32;-&#32;2*len(asteroids)
<anchor xml:id="_gtoc12_8py_source_1l00252"/>00252 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;evals.value&#32;+=&#32;1
<anchor xml:id="_gtoc12_8py_source_1l00253"/>00253 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;y&#32;&lt;&#32;best_y.value&#32;<emphasis role="keywordflow">or</emphasis>&#32;mined&#32;&gt;&#32;best_mined.value:
<anchor xml:id="_gtoc12_8py_source_1l00254"/>00254 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;dt&#32;=&#32;max(1E-9,&#32;dtime(t0))&#32;<emphasis role="comment">#&#32;avoid&#32;division&#32;by&#32;0&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00255"/>00255 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;am&#32;=&#32;<emphasis role="stringliteral">&quot;,&quot;</emphasis>.join(f<emphasis role="stringliteral">&apos;{int(m)}&apos;</emphasis>&#32;<emphasis role="keywordflow">for</emphasis>&#32;m&#32;<emphasis role="keywordflow">in</emphasis>&#32;all_mass)
<anchor xml:id="_gtoc12_8py_source_1l00256"/>00256 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;print(f<emphasis role="stringliteral">&apos;t&#32;=&#32;{dt}&#32;ev&#32;=&#32;{evals.value}&#32;ev/s&#32;=&#32;{evals.value/dt:.3f}&#32;y&#32;=&#32;{y:.3f}&#32;mined&#32;=&#32;{mined:.2f}&#32;dm&#32;=&#32;{am}&#32;a&#32;=&#32;{len(asteroids)}&#32;{list(sequence)}&apos;</emphasis>)
<anchor xml:id="_gtoc12_8py_source_1l00257"/>00257 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;y&#32;&lt;&#32;best_y.value:
<anchor xml:id="_gtoc12_8py_source_1l00258"/>00258 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;best_y.value&#32;=&#32;y
<anchor xml:id="_gtoc12_8py_source_1l00259"/>00259 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;mined&#32;&gt;&#32;best_mined.value:
<anchor xml:id="_gtoc12_8py_source_1l00260"/>00260 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;best_mined.value&#32;=&#32;mined
<anchor xml:id="_gtoc12_8py_source_1l00261"/>00261 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;y
<anchor xml:id="_gtoc12_8py_source_1l00262"/>00262 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
<anchor xml:id="_gtoc12_8py_source_1l00263"/>00263 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">except</emphasis>&#32;Exception&#32;<emphasis role="keyword">as</emphasis>&#32;ex:
<anchor xml:id="_gtoc12_8py_source_1l00264"/>00264 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;100000&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
<anchor xml:id="_gtoc12_8py_source_1l00265"/>00265 &#32;&#32;&#32;&#32;
<anchor xml:id="_gtoc12_8py_source_1l00266"/>00266 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;seq&#32;<emphasis role="keywordflow">is</emphasis>&#32;<emphasis role="keywordtype">None</emphasis>:&#32;<emphasis role="comment">#&#32;optimize&#32;using&#32;parallel&#32;BiteOpt</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00267"/>00267 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;retry.minimize_plot(<emphasis role="stringliteral">&quot;minimize_plot&quot;</emphasis>,&#32;<link linkend="_classfcmaes_1_1optimizer_1_1_bite__cpp">Bite_cpp</link>(max_evals,&#32;M=6),&#32;fit,&#32;bounds,&#32;num_retries=num_restarts,&#32;workers=workers,&#32;
<anchor xml:id="_gtoc12_8py_source_1l00268"/>00268 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="comment">#retry.minimize_plot(&quot;minimize_plot&quot;,&#32;Crfmnes_cpp(2*max_evals,&#32;popsize=dim),&#32;fit,&#32;bounds,&#32;num_retries=num_restarts,&#32;workers=workers,&#32;</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00269"/>00269 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;statistic_num=5000)&#32;
<anchor xml:id="_gtoc12_8py_source_1l00270"/>00270 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">else</emphasis>:&#32;<emphasis role="comment">#&#32;if&#32;seq&#32;is&#32;defined&#32;we&#32;just&#32;evaluate&#32;it</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00271"/>00271 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;eval_sequence(seq)
<anchor xml:id="_gtoc12_8py_source_1l00272"/>00272 
<anchor xml:id="_gtoc12_8py_source_1l00273"/><link linkend="_namespacegtoc12_1a91594165754dfc90464518c70cf65911">00273</link> <emphasis role="keyword">def&#32;</emphasis><link linkend="_namespacegtoc12_1a91594165754dfc90464518c70cf65911">check_solutions</link>():
<anchor xml:id="_gtoc12_8py_source_1l00274"/>00274 &#32;&#32;&#32;&#32;seqs&#32;=&#32;[&#32;<emphasis role="comment">#&#32;good&#32;sample&#32;solutions&#32;computed&#32;using&#32;optimize(&quot;tmap_jpl1&quot;,&#32;max_evals=2000000,&#32;num_restarts=640)</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00275"/>00275 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;[11,&#32;20,&#32;29,&#32;31,&#32;21,&#32;33,&#32;1,&#32;2,&#32;15,&#32;41,&#32;38,&#32;43,&#32;18,&#32;34,&#32;32,&#32;8,&#32;4,&#32;43,&#32;18,&#32;41,&#32;13,&#32;15,&#32;30,&#32;26,&#32;39,&#32;1,&#32;20,&#32;29,&#32;31,&#32;33,&#32;19,&#32;0,&#32;39,&#32;10,&#32;3,&#32;7,&#32;40,&#32;25,&#32;37,&#32;19,&#32;0,&#32;23,&#32;5,&#32;30,&#32;5,&#32;37,&#32;11,&#32;21,&#32;34,&#32;32,&#32;28,&#32;42,&#32;26,&#32;17,&#32;38,&#32;13,&#32;8,&#32;4,&#32;7,&#32;3,&#32;17,&#32;42,&#32;25,&#32;40,&#32;10,&#32;28,&#32;2,&#32;23],
<anchor xml:id="_gtoc12_8py_source_1l00276"/>00276 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;[19,&#32;0,&#32;8,&#32;4,&#32;18,&#32;41,&#32;10,&#32;40,&#32;25,&#32;3,&#32;26,&#32;19,&#32;43,&#32;23,&#32;15,&#32;17,&#32;20,&#32;29,&#32;6,&#32;20,&#32;29,&#32;31,&#32;21,&#32;11,&#32;36,&#32;1,&#32;24,&#32;39,&#32;30,&#32;0,&#32;8,&#32;10,&#32;25,&#32;40,&#32;42,&#32;35,&#32;6,&#32;12,&#32;37,&#32;23,&#32;13,&#32;43,&#32;31,&#32;12,&#32;41,&#32;4,&#32;13,&#32;7,&#32;22,&#32;18,&#32;42,&#32;7,&#32;17,&#32;28,&#32;15,&#32;22,&#32;28,&#32;26,&#32;1,&#32;35,&#32;11,&#32;21,&#32;36,&#32;39,&#32;3,&#32;37,&#32;24,&#32;30],
<anchor xml:id="_gtoc12_8py_source_1l00277"/>00277 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;[22,&#32;30,&#32;13,&#32;0,&#32;19,&#32;38,&#32;20,&#32;42,&#32;11,&#32;31,&#32;29,&#32;36,&#32;2,&#32;40,&#32;17,&#32;32,&#32;16,&#32;2,&#32;27,&#32;35,&#32;37,&#32;41,&#32;18,&#32;17,&#32;32,&#32;37,&#32;13,&#32;8,&#32;41,&#32;10,&#32;28,&#32;16,&#32;11,&#32;20,&#32;29,&#32;31,&#32;36,&#32;39,&#32;14,&#32;4,&#32;8,&#32;6,&#32;35,&#32;27,&#32;39,&#32;24,&#32;18,&#32;14,&#32;42,&#32;7,&#32;5,&#32;28,&#32;10,&#32;40,&#32;25,&#32;24,&#32;38,&#32;43,&#32;0,&#32;19,&#32;5,&#32;25,&#32;7,&#32;30,&#32;22,&#32;43,&#32;4,&#32;6],
<anchor xml:id="_gtoc12_8py_source_1l00278"/>00278 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;[9,&#32;28,&#32;10,&#32;7,&#32;40,&#32;17,&#32;3,&#32;15,&#32;38,&#32;36,&#32;24,&#32;43,&#32;7,&#32;34,&#32;23,&#32;8,&#32;4,&#32;43,&#32;18,&#32;41,&#32;14,&#32;37,&#32;35,&#32;26,&#32;16,&#32;2,&#32;3,&#32;39,&#32;33,&#32;9,&#32;42,&#32;11,&#32;20,&#32;29,&#32;31,&#32;39,&#32;24,&#32;25,&#32;2,&#32;15,&#32;8,&#32;4,&#32;23,&#32;17,&#32;31,&#32;20,&#32;29,&#32;11,&#32;36,&#32;27,&#32;33,&#32;34,&#32;42,&#32;26,&#32;35,&#32;27,&#32;12,&#32;37,&#32;14,&#32;41,&#32;18,&#32;10,&#32;28,&#32;25,&#32;40,&#32;12,&#32;38,&#32;16],
<anchor xml:id="_gtoc12_8py_source_1l00279"/>00279 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;[11,&#32;31,&#32;20,&#32;2,&#32;9,&#32;17,&#32;24,&#32;21,&#32;10,&#32;28,&#32;13,&#32;42,&#32;32,&#32;34,&#32;34,&#32;32,&#32;5,&#32;40,&#32;25,&#32;42,&#32;8,&#32;39,&#32;29,&#32;23,&#32;38,&#32;43,&#32;41,&#32;4,&#32;14,&#32;9,&#32;2,&#32;38,&#32;0,&#32;4,&#32;43,&#32;18,&#32;41,&#32;13,&#32;31,&#32;0,&#32;37,&#32;19,&#32;18,&#32;8,&#32;3,&#32;24,&#32;25,&#32;17,&#32;23,&#32;15,&#32;37,&#32;14,&#32;3,&#32;28,&#32;10,&#32;19,&#32;39,&#32;40,&#32;5,&#32;15,&#32;21,&#32;20,&#32;29,&#32;11,&#32;35,&#32;6,&#32;35,&#32;6],
<anchor xml:id="_gtoc12_8py_source_1l00280"/>00280 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;]
<anchor xml:id="_gtoc12_8py_source_1l00281"/>00281 &#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;i,&#32;seq&#32;<emphasis role="keywordflow">in</emphasis>&#32;enumerate(seqs):&#32;
<anchor xml:id="_gtoc12_8py_source_1l00282"/>00282 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;print(<emphasis role="stringliteral">&quot;solution&#32;&quot;</emphasis>,&#32;i+1,&#32;<link linkend="_namespacegtoc12_1ae69e77fa378b33f00726f3d6f69299bd">optimize</link>(<emphasis role="stringliteral">&quot;tmap_jpl1&quot;</emphasis>,&#32;seq=seq))
<anchor xml:id="_gtoc12_8py_source_1l00283"/>00283 &#32;&#32;&#32;&#32;&#32;&#32;&#32;
<anchor xml:id="_gtoc12_8py_source_1l00284"/>00284 <emphasis role="keywordflow">if</emphasis>&#32;__name__&#32;==&#32;<emphasis role="stringliteral">&apos;__main__&apos;</emphasis>:
<anchor xml:id="_gtoc12_8py_source_1l00285"/>00285 &#32;&#32;&#32;&#32;
<anchor xml:id="_gtoc12_8py_source_1l00286"/>00286 &#32;&#32;&#32;&#32;<link linkend="_namespacegtoc12_1a91594165754dfc90464518c70cf65911">check_solutions</link>()
<anchor xml:id="_gtoc12_8py_source_1l00287"/><link linkend="_namespacegtoc12_1af47b9c9db23b8a487ec3407a8bbc1651">00287</link> &#32;&#32;&#32;&#32;<link linkend="_namespacegtoc12_1ae69e77fa378b33f00726f3d6f69299bd">optimize</link>(<emphasis role="stringliteral">&quot;tmap_jpl1&quot;</emphasis>,&#32;max_evals=200000,&#32;num_restarts=64)
<anchor xml:id="_gtoc12_8py_source_1l00288"/>00288 &#32;&#32;&#32;&#32;<emphasis role="comment">#&#32;use&#32;this&#32;if&#32;you&#32;have&#32;a&#32;fast&#32;many&#32;core&#32;processor:</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00289"/>00289 &#32;&#32;&#32;&#32;<emphasis role="comment">#&#32;optimize(&quot;tmap_jpl1&quot;,&#32;max_evals=2000000,&#32;num_restarts=6400)</emphasis>
<anchor xml:id="_gtoc12_8py_source_1l00290"/>00290 
</programlisting></section>
