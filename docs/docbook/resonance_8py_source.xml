<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_resonance_8py_source" xml:lang="en-US">
<title>resonance.py</title>
<indexterm><primary>examples/kepler/resonance.py</primary></indexterm>
Go to the documentation of this file.<programlisting linenumbering="unnumbered"><anchor xml:id="_resonance_8py_source_1l00001"/><link linkend="_namespaceexamples_1_1kepler_1_1resonance">00001</link> <emphasis role="keyword">import</emphasis>&#32;math
<anchor xml:id="_resonance_8py_source_1l00002"/>00002 
<anchor xml:id="_resonance_8py_source_1l00003"/>00003 <emphasis role="keyword">from</emphasis>&#32;pykep.core&#32;<emphasis role="keyword">import</emphasis>&#32;epoch,&#32;fb_prop,&#32;SEC2DAY
<anchor xml:id="_resonance_8py_source_1l00004"/>00004 <emphasis role="keyword">from</emphasis>&#32;kepler.rvt&#32;<emphasis role="keyword">import</emphasis>&#32;rvt
<anchor xml:id="_resonance_8py_source_1l00005"/>00005 &#32;&#32;&#32;&#32;&#32;&#32;
<anchor xml:id="_resonance_8py_source_1l00006"/>00006 <emphasis role="keyword">class&#32;</emphasis><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance">resonance</link>:&#32;&#32;&#32;&#32;
<anchor xml:id="_resonance_8py_source_1l00007"/>00007 &#32;&#32;&#32;&#32;<emphasis role="stringliteral">&quot;&quot;&quot;</emphasis>
<anchor xml:id="_resonance_8py_source_1l00008"/>00008 <emphasis role="stringliteral">&#32;&#32;&#32;&#32;Determines&#32;the&#32;best&#32;&quot;fitting&quot;&#32;resonance&#32;orbit.</emphasis>
<anchor xml:id="_resonance_8py_source_1l00009"/><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance">00009</link> <emphasis role="stringliteral">&#32;&#32;&#32;&#32;&quot;&quot;&quot;</emphasis>
<anchor xml:id="_resonance_8py_source_1l00010"/>00010 
<anchor xml:id="_resonance_8py_source_1l00011"/>00011 &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1aaf455ef7c3cc45eedbc1f00874b43fd9">__init__</link>(self,&#32;planet,&#32;rvt_in,&#32;rvt_pl,
<anchor xml:id="_resonance_8py_source_1l00012"/>00012 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;resonances=&#32;[[1,&#32;1],&#32;[5,&#32;4],&#32;[4,&#32;3],&#32;[3,&#32;2],&#32;[5,&#32;3]]
<anchor xml:id="_resonance_8py_source_1l00013"/>00013 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;):
<anchor xml:id="_resonance_8py_source_1l00014"/>00014 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="stringliteral">&quot;&quot;&quot;</emphasis>
<anchor xml:id="_resonance_8py_source_1l00015"/>00015 <emphasis role="stringliteral">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;Args:</emphasis>
<anchor xml:id="_resonance_8py_source_1l00016"/>00016 <emphasis role="stringliteral">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;-&#32;planet&#32;(``planet``):&#32;resonance&#32;planet.&#32;</emphasis>
<anchor xml:id="_resonance_8py_source_1l00017"/>00017 <emphasis role="stringliteral">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;-&#32;rvt_in:&#32;(``rvt``):&#32;incoming&#32;orbit.</emphasis>
<anchor xml:id="_resonance_8py_source_1l00018"/><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1aaf455ef7c3cc45eedbc1f00874b43fd9">00018</link> <emphasis role="stringliteral">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;-&#32;rvt_pl:&#32;(``rvt``):&#32;planet&#32;orbit.</emphasis>
<anchor xml:id="_resonance_8py_source_1l00019"/>00019 <emphasis role="stringliteral">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;-&#32;resonances&#32;(``list``&#32;of&#32;``int``):&#32;resonance&#32;options.&#32;</emphasis>
<anchor xml:id="_resonance_8py_source_1l00020"/>00020 <emphasis role="stringliteral">&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&quot;&quot;&quot;</emphasis>
<anchor xml:id="_resonance_8py_source_1l00021"/>00021 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keyword">assert</emphasis>&#32;rvt_in.t&#32;==&#32;rvt_pl.t&#32;<emphasis role="comment">#&#32;timing&#32;must&#32;be&#32;consistent</emphasis>
<anchor xml:id="_resonance_8py_source_1l00022"/>00022 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;
<anchor xml:id="_resonance_8py_source_1l00023"/><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1af764cdec0f045b6a16b8766daed16532">00023</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1af764cdec0f045b6a16b8766daed16532">planet</link>&#32;=&#32;planet
<anchor xml:id="_resonance_8py_source_1l00024"/><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a52f3caebdaf5fa114ea184050fc0342a">00024</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a52f3caebdaf5fa114ea184050fc0342a">rvt_in</link>&#32;=&#32;rvt_in
<anchor xml:id="_resonance_8py_source_1l00025"/><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a93c6d2e9ae1deb0dfc250badd5272821">00025</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a93c6d2e9ae1deb0dfc250badd5272821">rvt_pl</link>&#32;=&#32;rvt_pl&#32;&#32;&#32;&#32;&#32;&#32;&#32;
<anchor xml:id="_resonance_8py_source_1l00026"/><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1af3cc8853ce8fbd89bfb0a67e4d13bb3f">00026</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1af3cc8853ce8fbd89bfb0a67e4d13bb3f">time</link>&#32;=&#32;rvt_in.t
<anchor xml:id="_resonance_8py_source_1l00027"/><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1ad0cf0c0e2fecd37ac67eb0ab374d8b59">00027</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1ad0cf0c0e2fecd37ac67eb0ab374d8b59">resonances</link>&#32;=&#32;resonances
<anchor xml:id="_resonance_8py_source_1l00028"/><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a0bcc7ba0c3eec6250c58ec197b597791">00028</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a0bcc7ba0c3eec6250c58ec197b597791">period</link>&#32;=&#32;planet.compute_period(epoch(self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1af3cc8853ce8fbd89bfb0a67e4d13bb3f">time</link>&#32;*&#32;SEC2DAY))
<anchor xml:id="_resonance_8py_source_1l00029"/><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1af1af3f64a7b293c45da950514ae50adb">00029</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1af1af3f64a7b293c45da950514ae50adb">mu</link>&#32;=&#32;planet.mu_self
<anchor xml:id="_resonance_8py_source_1l00030"/><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1af2faa0d84b1f4f18cffe76f0b620ef3c">00030</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1af2faa0d84b1f4f18cffe76f0b620ef3c">timing_error</link>&#32;=&#32;-1
<anchor xml:id="_resonance_8py_source_1l00031"/><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a7b296e6ea3c6edd8875189c349ffe21e">00031</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a7b296e6ea3c6edd8875189c349ffe21e">rvt_out</link>&#32;=&#32;<emphasis role="keywordtype">None</emphasis>
<anchor xml:id="_resonance_8py_source_1l00032"/><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a8c7f3802bca3a7f66cac2786a3de62b1">00032</link> &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a8c7f3802bca3a7f66cac2786a3de62b1">resonance</link>&#32;=&#32;<emphasis role="keywordtype">None</emphasis>
<anchor xml:id="_resonance_8py_source_1l00033"/>00033 &#32;
<anchor xml:id="_resonance_8py_source_1l00034"/>00034 &#32;&#32;&#32;&#32;<emphasis role="comment">#&#32;useful&#32;for&#32;debugging</emphasis>
<anchor xml:id="_resonance_8py_source_1l00035"/><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a9bc2dcda2ecc4f6a933f0648535c2597">00035</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a9bc2dcda2ecc4f6a933f0648535c2597">__str__</link>(self):
<anchor xml:id="_resonance_8py_source_1l00036"/>00036 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;str(_resonance)&#32;+&#32;<emphasis role="stringliteral">&quot;&#32;&quot;</emphasis>&#32;+&#32;str(self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1af2faa0d84b1f4f18cffe76f0b620ef3c">timing_error</link>&#32;*&#32;SEC2DAY)&#32;+&#32;<emphasis role="stringliteral">&quot;&#32;&quot;</emphasis>&#32;+&#32;str(self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a7b296e6ea3c6edd8875189c349ffe21e">rvt_out</link>)
<anchor xml:id="_resonance_8py_source_1l00037"/>00037 &#32;&#32;&#32;&#32;
<anchor xml:id="_resonance_8py_source_1l00038"/>00038 &#32;&#32;&#32;&#32;<emphasis role="comment">#&#32;select&#32;a&#32;resonance&#32;option&#32;minimizing&#32;the&#32;timing&#32;error&#32;&#32;</emphasis>
<anchor xml:id="_resonance_8py_source_1l00039"/><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a6b7565150846c8f66997053d6a5fb009">00039</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a6b7565150846c8f66997053d6a5fb009">select_resonance</link>(self,&#32;beta,&#32;safe_distance):
<anchor xml:id="_resonance_8py_source_1l00040"/>00040 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;v_out&#32;=&#32;fb_prop(self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a52f3caebdaf5fa114ea184050fc0342a">rvt_in</link>.v,&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a93c6d2e9ae1deb0dfc250badd5272821">rvt_pl</link>.v,&#32;
<anchor xml:id="_resonance_8py_source_1l00041"/>00041 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1af764cdec0f045b6a16b8766daed16532">planet</link>.radius&#32;+&#32;safe_distance,&#32;beta,&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1af1af3f64a7b293c45da950514ae50adb">mu</link>)
<anchor xml:id="_resonance_8py_source_1l00042"/>00042 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a7b296e6ea3c6edd8875189c349ffe21e">rvt_out</link>&#32;=&#32;<link linkend="_classexamples_1_1kepler_1_1rvt_1_1rvt">rvt</link>(self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a52f3caebdaf5fa114ea184050fc0342a">rvt_in</link>.r,&#32;v_out,&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1af3cc8853ce8fbd89bfb0a67e4d13bb3f">time</link>,&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a52f3caebdaf5fa114ea184050fc0342a">rvt_in</link>.mu)
<anchor xml:id="_resonance_8py_source_1l00043"/>00043 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;period&#32;=&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a7b296e6ea3c6edd8875189c349ffe21e">rvt_out</link>.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a0bcc7ba0c3eec6250c58ec197b597791">period</link>()
<anchor xml:id="_resonance_8py_source_1l00044"/>00044 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1af2faa0d84b1f4f18cffe76f0b620ef3c">timing_error</link>&#32;=&#32;math.inf
<anchor xml:id="_resonance_8py_source_1l00045"/>00045 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">for</emphasis>&#32;resonance&#32;<emphasis role="keywordflow">in</emphasis>&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1ad0cf0c0e2fecd37ac67eb0ab374d8b59">resonances</link>:
<anchor xml:id="_resonance_8py_source_1l00046"/>00046 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;target&#32;=&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a0bcc7ba0c3eec6250c58ec197b597791">period</link>&#32;*&#32;resonance[1]&#32;/&#32;resonance[0];
<anchor xml:id="_resonance_8py_source_1l00047"/>00047 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;dt&#32;=&#32;abs(period&#32;-&#32;target)
<anchor xml:id="_resonance_8py_source_1l00048"/>00048 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;dt&#32;&lt;&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1af2faa0d84b1f4f18cffe76f0b620ef3c">timing_error</link>:
<anchor xml:id="_resonance_8py_source_1l00049"/>00049 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a8c7f3802bca3a7f66cac2786a3de62b1">resonance</link>&#32;=&#32;resonance
<anchor xml:id="_resonance_8py_source_1l00050"/>00050 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1af2faa0d84b1f4f18cffe76f0b620ef3c">timing_error</link>&#32;=&#32;dt
<anchor xml:id="_resonance_8py_source_1l00051"/>00051 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1af2faa0d84b1f4f18cffe76f0b620ef3c">timing_error</link>,&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a8c7f3802bca3a7f66cac2786a3de62b1">resonance</link>
<anchor xml:id="_resonance_8py_source_1l00052"/>00052 &#32;&#32;&#32;&#32;
<anchor xml:id="_resonance_8py_source_1l00053"/>00053 &#32;&#32;&#32;&#32;<emphasis role="comment">#&#32;time&#32;of&#32;flight&#32;of&#32;the&#32;resonance&#32;transfer</emphasis>
<anchor xml:id="_resonance_8py_source_1l00054"/><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1addda085424819e7bf8749c6bdf598245">00054</link> &#32;&#32;&#32;&#32;<emphasis role="keyword">def&#32;</emphasis><link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1addda085424819e7bf8749c6bdf598245">tof</link>(self):
<anchor xml:id="_resonance_8py_source_1l00055"/>00055 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">if</emphasis>&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a8c7f3802bca3a7f66cac2786a3de62b1">resonance</link>&#32;<emphasis role="keywordflow">is</emphasis>&#32;<emphasis role="keywordtype">None</emphasis>:
<anchor xml:id="_resonance_8py_source_1l00056"/>00056 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">raise</emphasis>&#32;Exception(<emphasis role="stringliteral">&apos;_resonance&#32;is&#32;None&apos;</emphasis>)
<anchor xml:id="_resonance_8py_source_1l00057"/>00057 &#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;<emphasis role="keywordflow">return</emphasis>&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a8c7f3802bca3a7f66cac2786a3de62b1">resonance</link>[1]&#32;*&#32;self.<link linkend="_classexamples_1_1kepler_1_1resonance_1_1resonance_1a0bcc7ba0c3eec6250c58ec197b597791">period</link>
</programlisting></section>
