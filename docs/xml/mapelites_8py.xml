<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.13.2" xml:lang="en-US">
  <compounddef id="mapelites_8py" kind="file" language="Python">
    <compoundname>mapelites.py</compoundname>
    <innerclass refid="classfcmaes_1_1mapelites_1_1_archive" prot="public">fcmaes::mapelites::Archive</innerclass>
    <innerclass refid="classfcmaes_1_1mapelites_1_1wrapper" prot="public">fcmaes::mapelites::wrapper</innerclass>
    <innerclass refid="classfcmaes_1_1mapelites_1_1in__niche__filter" prot="public">fcmaes::mapelites::in_niche_filter</innerclass>
    <innernamespace refid="namespacefcmaes">fcmaes</innernamespace>
    <innernamespace refid="namespacefcmaes_1_1mapelites">fcmaes::mapelites</innernamespace>
    <sectiondef kind="var">
      <memberdef kind="variable" id="namespacefcmaes_1_1mapelites_1ae3ff11934566d45300958dca5961a6ca" prot="public" static="no" mutable="no">
        <type></type>
        <definition>fcmaes::mapelites.rng</definition>
        <argsstring></argsstring>
        <name>rng</name>
        <qualifiedname>fcmaes.mapelites.rng</qualifiedname>
        <initializer>=  default_rng()</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="fcmaes/mapelites.py" line="103" column="1" bodyfile="fcmaes/mapelites.py" bodystart="103" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="func">
      <memberdef kind="function" id="namespacefcmaes_1_1mapelites_1a028f687a02a53b2626abc9f046a77aa2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>Archive</type>
        <definition> Archive fcmaes.mapelites.optimize_map_elites</definition>
        <argsstring>(Callable[[ArrayLike], Tuple[float, np.ndarray]] qd_fitness, Bounds bounds, Bounds qd_bounds, Optional[int] niche_num=4000, Optional[int] samples_per_niche=20, Optional[int] workers=mp.cpu_count(), Optional[int] iterations=100, Optional[Archive] archive=None, Optional[Dict] me_params={}, Optional[Dict] cma_params={}, Optional[bool] use_stats=False)</argsstring>
        <name>optimize_map_elites</name>
        <qualifiedname>fcmaes.mapelites.optimize_map_elites</qualifiedname>
        <param>
          <type>Callable</type>
          <defname>qd_fitness</defname>
          <array>[[ArrayLike]</array>
        </param>
        <param>
          <type>Tuple]</type>
          <declname>qd_fitness</declname>
          <defname>bounds</defname>
          <array>[float, np.ndarray]</array>
        </param>
        <param>
          <type>Bounds</type>
          <declname>bounds</declname>
          <defname>qd_bounds</defname>
        </param>
        <param>
          <type>Bounds</type>
          <declname>qd_bounds</declname>
          <defname>niche_num</defname>
        </param>
        <param>
          <type>Optional</type>
          <declname>niche_num</declname>
          <defname>samples_per_niche</defname>
          <array>[int]</array>
          <defval>4000</defval>
        </param>
        <param>
          <type>Optional</type>
          <declname>samples_per_niche</declname>
          <defname>workers</defname>
          <array>[int]</array>
          <defval>20</defval>
        </param>
        <param>
          <type>Optional</type>
          <declname>workers</declname>
          <defname>iterations</defname>
          <array>[int]</array>
          <defval>mp.cpu_count()</defval>
        </param>
        <param>
          <type>Optional</type>
          <declname>iterations</declname>
          <defname>archive</defname>
          <array>[int]</array>
          <defval>100</defval>
        </param>
        <param>
          <type>Optional</type>
          <declname>archive</declname>
          <defname>me_params</defname>
          <array>[Archive]</array>
          <defval>None</defval>
        </param>
        <param>
          <type>Optional</type>
          <declname>me_params</declname>
          <defname>cma_params</defname>
          <array>[Dict]</array>
          <defval>{}</defval>
        </param>
        <param>
          <type>Optional</type>
          <declname>cma_params</declname>
          <defname>use_stats</defname>
          <array>[Dict]</array>
          <defval>{}</defval>
        </param>
        <param>
          <type>Optional</type>
          <declname>use_stats</declname>
          <array>[bool]</array>
          <defval>False</defval>
        </param>
        <briefdescription>
<para>Optimizes a map-elites evolutionary algorithm to find diverse and high-performing solutions by distributing samples into niches, iteratively evolving them, and maintaining an archive to store the found solutions. </para>
        </briefdescription>
        <detaileddescription>
<para>This function leverages a map-elites approach to optimize solutions across a given feature space or behavioral space defined by the <computeroutput>qd_bounds</computeroutput> parameter. The objective of the optimization is to populate an archive with solutions that exhibit high fitness while ensuring diversity in behavior across the space. The archive is continuously updated and sorted during the iterations to reflect the best solutions in each niche. The performance is monitored throughout the optimization process.</para>
<para><verbatim>   qd_fitness (Callable[[ArrayLike], Tuple[float, np.ndarray]]): The quantitative fitness
       function used to evaluate the solutions. It must return a tuple containing the fitness
       score and the corresponding feature descriptor/behavior representation.
</verbatim> <parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>bounds</parametername>
</parameternamelist>
<parameterdescription>
<para>Represents the variable bounds for the optimization space. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>qd_bounds</parametername>
</parameternamelist>
<parameterdescription>
<para>Defines the range of the quality-diversity feature/behavioral space. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>niche_num</parametername>
</parameternamelist>
<parameterdescription>
<para>The total number of niches in the archive. Determines how the solutions will be distributed across the feature space. Defaults to 4000. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>samples_per_niche</parametername>
</parameternamelist>
<parameterdescription>
<para>The number of samples generated per niche during initialization. Defaults to 20. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>workers</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of CPU workers/threads to parallelize the process. Defaults to the number of CPUs available. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>iterations</parametername>
</parameternamelist>
<parameterdescription>
<para>The total number of iterations to evolve the archive. Defaults to 100. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>archive</parametername>
</parameternamelist>
<parameterdescription>
<para>Pre-existing archive object for storing solutions. If <computeroutput>None</computeroutput>, a new archive is initialized. Defaults to None. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>me_params</parametername>
</parameternamelist>
<parameterdescription>
<para>Additional hyperparameters specific to the map-elites algorithm. Defaults to an empty dictionary. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>cma_params</parametername>
</parameternamelist>
<parameterdescription>
<para>Hyperparameters specific to the CMA-ES algorithm used for evolutionary strategies. Defaults to an empty dictionary. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>use_stats</parametername>
</parameternamelist>
<parameterdescription>
<para>Flag to determine whether statistical data should be collected and maintained in the archive. Defaults to False.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para></para>
</simplesect>
<simplesect kind="return"><para><ref refid="classfcmaes_1_1mapelites_1_1_archive" kindref="compound">Archive</ref> The final archive containing diverse high-performing solutions distributed across the quality-diversity space. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="fcmaes/mapelites.py" line="144" column="1" bodyfile="fcmaes/mapelites.py" bodystart="155" bodyend="175"/>
        <references refid="namespacefcmaes_1_1mapelites_1ad2ec9edcc53986935aa2f2e1127d458d" compoundref="mapelites_8py" startline="295" endline="303">fcmaes.mapelites.optimize_map_elites_</references>
      </memberdef>
      <memberdef kind="function" id="namespacefcmaes_1_1mapelites_1a49c2831aa0bf9634663977bbd6321afc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>Archive</type>
        <definition> Archive fcmaes.mapelites.empty_archive</definition>
        <argsstring>(int dim, Bounds qd_bounds, int niche_num, int samples_per_niche, Optional[bool] use_stats=False)</argsstring>
        <name>empty_archive</name>
        <qualifiedname>fcmaes.mapelites.empty_archive</qualifiedname>
        <param>
          <type>int</type>
          <declname>dim</declname>
        </param>
        <param>
          <type>Bounds</type>
          <declname>qd_bounds</declname>
        </param>
        <param>
          <type>int</type>
          <declname>niche_num</declname>
        </param>
        <param>
          <type>int</type>
          <declname>samples_per_niche</declname>
        </param>
        <param>
          <type>Optional</type>
          <declname>use_stats</declname>
          <array>[bool]</array>
          <defval>False</defval>
        </param>
        <briefdescription>
<para>Creates and initializes an archive for quality diversity (QD) experiments. </para>
        </briefdescription>
        <detaileddescription>
<para>This function creates an <ref refid="classfcmaes_1_1mapelites_1_1_archive" kindref="compound">Archive</ref> object with the specified dimensions, bounding box, number of niches, and optionally enables statistics collection. It also initializes the niches in the archive with a specified number of samples per niche.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>dim</parametername>
</parameternamelist>
<parameterdescription>
<para>Dimensionality of the search/grid space for the archive. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>qd_bounds</parametername>
</parameternamelist>
<parameterdescription>
<para>Bounds specifying the range for niche space coordinates. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>niche_num</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of niches to be created in the archive. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>samples_per_niche</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of samples to initialize in each niche. use_stats (Optional[bool], optional): If True, statistics collection will be enabled in the archive. Defaults to False.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para></para>
</simplesect>
<simplesect kind="return"><para><ref refid="classfcmaes_1_1mapelites_1_1_archive" kindref="compound">Archive</ref> The initialized archive object for QD experiments. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="fcmaes/mapelites.py" line="196" column="1" bodyfile="fcmaes/mapelites.py" bodystart="200" bodyend="206"/>
      </memberdef>
      <memberdef kind="function" id="namespacefcmaes_1_1mapelites_1ace0194d76906adbf0c0dd3db084f177c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>fcmaes.mapelites.set_KDTree</definition>
        <argsstring>(Archive archive, Optional[np.ndarray] centers=None, Optional[int] niche_num=None, Optional[Bounds] qd_bounds=None, Optional[int] samples_per_niche=100)</argsstring>
        <name>set_KDTree</name>
        <qualifiedname>fcmaes.mapelites.set_KDTree</qualifiedname>
        <param>
          <type>Archive</type>
          <declname>archive</declname>
        </param>
        <param>
          <type>Optional</type>
          <declname>centers</declname>
          <array>[np.ndarray]</array>
          <defval>None</defval>
        </param>
        <param>
          <type>Optional</type>
          <declname>niche_num</declname>
          <array>[int]</array>
          <defval>None</defval>
        </param>
        <param>
          <type>Optional</type>
          <declname>qd_bounds</declname>
          <array>[Bounds]</array>
          <defval>None</defval>
        </param>
        <param>
          <type>Optional</type>
          <declname>samples_per_niche</declname>
          <array>[int]</array>
          <defval>100</defval>
        </param>
        <briefdescription>
<para>Sets up a KDTree for the given archive using specified or default parameters. </para>
        </briefdescription>
        <detaileddescription>
<para>This function initializes a KDTree structure with the given or generated centers, enabling efficient spatial searches within the archive. If the centers are not provided, they will be generated using the <computeroutput>get_centers_</computeroutput> function based on the number of niches, dimensionality of the bounds, and the number of samples per niche. This KDTree is essential for spatial partitioning and querying in the archive.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>archive</parametername>
</parameternamelist>
<parameterdescription>
<para>The archive object for which the KDTree will be set up. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>centers</parametername>
</parameternamelist>
<parameterdescription>
<para>Coordinates of the centers to construct the KDTree. If <computeroutput>None</computeroutput>, they will be generated automatically. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>niche_num</parametername>
</parameternamelist>
<parameterdescription>
<para>The number of niches used to determine the grid of centers if <computeroutput>centers</computeroutput> is not provided. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>qd_bounds</parametername>
</parameternamelist>
<parameterdescription>
<para>The bounds within which the niches lie. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>samples_per_niche</parametername>
</parameternamelist>
<parameterdescription>
<para>The number of sample centers per niche to generate when <computeroutput>centers</computeroutput> is not provided. Defaults to 100. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="fcmaes/mapelites.py" line="227" column="1" bodyfile="fcmaes/mapelites.py" bodystart="231" bodyend="238"/>
        <references refid="namespacefcmaes_1_1mapelites_1a1cd72ab87d7aa999a255ad854895d3aa" compoundref="mapelites_8py" startline="1535" endline="1551">fcmaes.mapelites.get_centers_</references>
        <referencedby refid="classfcmaes_1_1mapelites_1_1_archive_1a62da9c6f511c298d1ef06d6af7600196" compoundref="mapelites_8py" startline="707" endline="728">fcmaes.mapelites.Archive.load</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespacefcmaes_1_1mapelites_1a9430b58efcd2bccef1537defe6b7e8db" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>Archive</type>
        <definition> Archive fcmaes.mapelites.load_archive</definition>
        <argsstring>(str name, Bounds bounds, Bounds qd_bounds, Optional[int] niche_num=10000, Optional[bool] use_stats=False)</argsstring>
        <name>load_archive</name>
        <qualifiedname>fcmaes.mapelites.load_archive</qualifiedname>
        <param>
          <type>str</type>
          <declname>name</declname>
        </param>
        <param>
          <type>Bounds</type>
          <declname>bounds</declname>
        </param>
        <param>
          <type>Bounds</type>
          <declname>qd_bounds</declname>
        </param>
        <param>
          <type>Optional</type>
          <declname>niche_num</declname>
          <array>[int]</array>
          <defval>10000</defval>
        </param>
        <param>
          <type>Optional</type>
          <declname>use_stats</declname>
          <array>[bool]</array>
          <defval>False</defval>
        </param>
        <briefdescription>
<para>Loads an archive based on the provided parameters. </para>
        </briefdescription>
        <detaileddescription>
<para>This function creates and configures an <ref refid="classfcmaes_1_1mapelites_1_1_archive" kindref="compound">Archive</ref> instance using the specified parameters. It initializes the <ref refid="classfcmaes_1_1mapelites_1_1_archive" kindref="compound">Archive</ref> with bounds, QD bounds, niche number, and optional usage of statistics. After initialization, it loads the archive data from the provided file name.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>name</parametername>
</parameternamelist>
<parameterdescription>
<para>The file name from which to load the archive. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>bounds</parametername>
</parameternamelist>
<parameterdescription>
<para>The lower and upper bounds for the archive&apos;s dimensionality. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>qd_bounds</parametername>
</parameternamelist>
<parameterdescription>
<para>The bounds specific to the QD optimization process. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>niche_num</parametername>
</parameternamelist>
<parameterdescription>
<para>The number of niches in the archive. Defaults to 10000. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>use_stats</parametername>
</parameternamelist>
<parameterdescription>
<para>Flag to indicate whether statistics should be used. Defaults to False.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para></para>
</simplesect>
<simplesect kind="return"><para><ref refid="classfcmaes_1_1mapelites_1_1_archive" kindref="compound">Archive</ref> An <ref refid="classfcmaes_1_1mapelites_1_1_archive" kindref="compound">Archive</ref> instance loaded with the specified configurations and data. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="fcmaes/mapelites.py" line="258" column="1" bodyfile="fcmaes/mapelites.py" bodystart="263" bodyend="270"/>
      </memberdef>
      <memberdef kind="function" id="namespacefcmaes_1_1mapelites_1ad2ec9edcc53986935aa2f2e1127d458d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>fcmaes.mapelites.optimize_map_elites_</definition>
        <argsstring>(archive, fitness, bounds, workers, me_params, cma_params)</argsstring>
        <name>optimize_map_elites_</name>
        <qualifiedname>fcmaes.mapelites.optimize_map_elites_</qualifiedname>
        <param>
          <type>archive</type>
          <defname>archive</defname>
        </param>
        <param>
          <type>fitness</type>
          <defname>fitness</defname>
        </param>
        <param>
          <type>bounds</type>
          <defname>bounds</defname>
        </param>
        <param>
          <type>workers</type>
          <defname>workers</defname>
        </param>
        <param>
          <type>me_params</type>
          <defname>me_params</defname>
        </param>
        <param>
          <type>cma_params</type>
          <defname>cma_params</defname>
        </param>
        <briefdescription>
<para>Optimize a solution using Map-Elites algorithm via multi-processing. </para>
        </briefdescription>
        <detaileddescription>
<para>This function orchestrates the execution of the Map-Elites optimization algorithm over multiple processes. Each process operates independently with its own random generator to explore the solution space. It uses CMA-ES to update solutions iteratively. The provided parameters configure the optimization behavior, such as the solution archive, fitness evaluation function, search bounds, and process settings specific to Map-Elites and CMA-ES.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>archive</parametername>
</parameternamelist>
<parameterdescription>
<para>A data structure to store the solutions found during the optimization process and their corresponding evaluation. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>fitness</parametername>
</parameternamelist>
<parameterdescription>
<para>A callable function that evaluates the quality of a solution. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>bounds</parametername>
</parameternamelist>
<parameterdescription>
<para>A sequence of tuples defining the lower and upper bounds for each decision variable. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>workers</parametername>
</parameternamelist>
<parameterdescription>
<para>An integer specifying the number of parallel processes to run during optimization. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>me_params</parametername>
</parameternamelist>
<parameterdescription>
<para>A dictionary or configuration object with parameters for the Map-Elites algorithm. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>cma_params</parametername>
</parameternamelist>
<parameterdescription>
<para>A dictionary or configuration object with parameters for the Covariance Matrix Adaptation Evolution Strategy (CMA-ES). </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="fcmaes/mapelites.py" line="294" column="1" bodyfile="fcmaes/mapelites.py" bodystart="295" bodyend="303"/>
        <referencedby refid="namespacefcmaes_1_1mapelites_1a028f687a02a53b2626abc9f046a77aa2" compoundref="mapelites_8py" startline="155" endline="175">fcmaes.mapelites.optimize_map_elites</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespacefcmaes_1_1mapelites_1a04bcf57530df0bef091b00ceb8e9d44a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>fcmaes.mapelites.run_map_elites_</definition>
        <argsstring>(archive, fitness, bounds, rg, me_params, cma_params)</argsstring>
        <name>run_map_elites_</name>
        <qualifiedname>fcmaes.mapelites.run_map_elites_</qualifiedname>
        <param>
          <type>archive</type>
          <defname>archive</defname>
        </param>
        <param>
          <type>fitness</type>
          <defname>fitness</defname>
        </param>
        <param>
          <type>bounds</type>
          <defname>bounds</defname>
        </param>
        <param>
          <type>rg</type>
          <defname>rg</defname>
        </param>
        <param>
          <type>me_params</type>
          <defname>me_params</defname>
        </param>
        <param>
          <type>cma_params</type>
          <defname>cma_params</defname>
        </param>
        <briefdescription>
<para>Runs the MAP-Elites algorithm with optional SBX (Simulated Binary Crossover) or iso+line variation, followed by CMA-ES optimization. </para>
        </briefdescription>
        <detaileddescription>
<para>The algorithm iteratively updates the archive with new solutions, balancing exploration and exploitation over the specified number of generations.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>archive</parametername>
</parameternamelist>
<parameterdescription>
<para>An archive object for storing solutions, descriptors, and their fitness values, supporting niche identification and updating mechanisms. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>fitness</parametername>
</parameternamelist>
<parameterdescription>
<para>Callable that computes the fitness and descriptor of a given solution. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>bounds</parametername>
</parameternamelist>
<parameterdescription>
<para>Bounds object holding the lower and upper bounds for the solutions during variation and optimization. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>rg</parametername>
</parameternamelist>
<parameterdescription>
<para>A random generator instance used for stochastic operations within the </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>algorithm.</parametername>
</parameternamelist>
<parameterdescription>
<para></para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>me_params</parametername>
</parameternamelist>
<parameterdescription>
<para>Dictionary containing tunable MAP-Elites parameters with keys such as &apos;generations&apos;, &apos;chunk_size&apos;, &apos;use_sbx&apos;, &apos;dis_c&apos;, &apos;dis_m&apos;, &apos;iso_sigma&apos;, and &apos;line_sigma&apos;. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>cma_params</parametername>
</parameternamelist>
<parameterdescription>
<para>Dictionary containing CMA-ES-specific parameters such as &apos;cma_generations&apos;. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="fcmaes/mapelites.py" line="325" column="1" bodyfile="fcmaes/mapelites.py" bodystart="326" bodyend="355"/>
        <references refid="namespacefcmaes_1_1mapelites_1aa557fd895bcaf40f495273ef16953c11" compoundref="mapelites_8py" startline="1515" endline="1520">fcmaes.mapelites.iso_dd_</references>
        <references refid="namespacefcmaes_1_1mapelites_1addca945e57b8fc097ca552903b98187f" compoundref="mapelites_8py" startline="374" endline="398">fcmaes.mapelites.optimize_cma_</references>
        <references refid="namespacefcmaes_1_1mapelites_1a5f70b23800f6a77b08d918f5aa0f9b3d" compoundref="mapelites_8py" startline="1459" endline="1490">fcmaes.mapelites.variation_</references>
      </memberdef>
      <memberdef kind="function" id="namespacefcmaes_1_1mapelites_1addca945e57b8fc097ca552903b98187f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>fcmaes.mapelites.optimize_cma_</definition>
        <argsstring>(archive, fitness, bounds, rg, cma_params)</argsstring>
        <name>optimize_cma_</name>
        <qualifiedname>fcmaes.mapelites.optimize_cma_</qualifiedname>
        <param>
          <type>archive</type>
          <defname>archive</defname>
        </param>
        <param>
          <type>fitness</type>
          <defname>fitness</defname>
        </param>
        <param>
          <type>bounds</type>
          <defname>bounds</defname>
        </param>
        <param>
          <type>rg</type>
          <defname>rg</defname>
        </param>
        <param>
          <type>cma_params</type>
          <defname>cma_params</defname>
        </param>
        <briefdescription>
<para>Optimizes a solution using the Covariance Matrix Adaptation Evolution Strategy (CMA-ES). </para>
        </briefdescription>
        <detaileddescription>
<para>The function utilizes the process of evolutionary optimization based on objective fitness, adaptive step size, and population-based approach. It leverages a provided archive to introduce variations in the space of potential solutions.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>archive</parametername>
</parameternamelist>
<parameterdescription>
<para>An instance of a solution archive storing previously evaluated solutions and assisting in generating new candidate solutions. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>fitness</parametername>
</parameternamelist>
<parameterdescription>
<para>A callable fitness function to evaluate the quality of solutions. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>bounds</parametername>
</parameternamelist>
<parameterdescription>
<para>The bounds or constraints of the solution space to limit candidate solutions. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>rg</parametername>
</parameternamelist>
<parameterdescription>
<para>A random generator instance used to introduce stochasticity in optimization steps. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>cma_params</parametername>
</parameternamelist>
<parameterdescription>
<para>A dictionary containing configuration parameters for the CMA-ES optimizer, such as population size, sigma (step size), maximum iterations, and other hyperparameters.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<parameterlist kind="exception"><parameteritem>
<parameternamelist>
<parametername>ValueError</parametername>
</parameternamelist>
<parameterdescription>
<para>If parameters in cma_params are invalid (e.g., negative population size). </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="fcmaes/mapelites.py" line="374" column="1" bodyfile="fcmaes/mapelites.py" bodystart="374" bodyend="398"/>
        <references refid="namespacefcmaes_1_1mapelites_1a86f7f0503dc82b70b87a882b49a95f23" compoundref="mapelites_8py" startline="425" endline="451">fcmaes.mapelites.update_archive</references>
        <referencedby refid="namespacefcmaes_1_1mapelites_1a04bcf57530df0bef091b00ceb8e9d44a" compoundref="mapelites_8py" startline="326" endline="355">fcmaes.mapelites.run_map_elites_</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespacefcmaes_1_1mapelites_1a86f7f0503dc82b70b87a882b49a95f23" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>fcmaes.mapelites.update_archive</definition>
        <argsstring>(Archive archive, np.ndarray xs, Optional[Callable[[ArrayLike], Tuple[float, np.ndarray]]] fitness=None, Optional[ArrayLike] yds=None)</argsstring>
        <name>update_archive</name>
        <qualifiedname>fcmaes.mapelites.update_archive</qualifiedname>
        <param>
          <type>Archive</type>
          <declname>archive</declname>
        </param>
        <param>
          <type>np.ndarray</type>
          <declname>xs</declname>
        </param>
        <param>
          <type>Optional</type>
          <defname>fitness</defname>
          <array>[Callable[[ArrayLike]</array>
        </param>
        <param>
          <type>Tuple]]</type>
          <declname>fitness</declname>
          <defname>yds</defname>
          <array>[float, np.ndarray]</array>
          <defval>None</defval>
        </param>
        <param>
          <type>Optional</type>
          <declname>yds</declname>
          <array>[ArrayLike]</array>
          <defval>None</defval>
        </param>
        <briefdescription>
<para>Evaluates a population, updates the archive with new solutions, and determines rankings. </para>
        </briefdescription>
        <detaileddescription>
<para>This function processes a set of solutions and their associated descriptions or fitness evaluations. The solutions are compared against an archive to determine and store better solutions. It prioritizes updates to empty niches in the archive and normalizes improvements for comparisons. The function finally returns the improvement values and the real fitness values for the solutions.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>archive</parametername>
</parameternamelist>
<parameterdescription>
<para>The archive object where solutions and corresponding fitness data are stored. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>xs</parametername>
</parameternamelist>
<parameterdescription>
<para>A set of solutions to be evaluated and compared against the archive. fitness (Optional[Callable[[ArrayLike], Tuple[float, np.ndarray]]]): A callable function that evaluates a solution and returns its fitness value and description. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>yds</parametername>
</parameternamelist>
<parameterdescription>
<para>Precomputed fitness values and descriptions, if available.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para>Tuple[np.ndarray, np.ndarray]: A tuple containing:<itemizedlist>
<listitem><para>Improvement values compared to archive elite solutions.</para>
</listitem><listitem><para>The real fitness values evaluated for the given solutions.</para>
</listitem></itemizedlist>
</para>
</simplesect>
<parameterlist kind="exception"><parameteritem>
<parameternamelist>
<parametername>ValueError</parametername>
</parameternamelist>
<parameterdescription>
<para>If `ys` or `yds` contain invalid or mismatched content. </para>
</parameterdescription>
</parameteritem>
</parameterlist>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="fcmaes/mapelites.py" line="423" column="1" bodyfile="fcmaes/mapelites.py" bodystart="425" bodyend="451"/>
        <referencedby refid="namespacefcmaes_1_1mapelites_1addca945e57b8fc097ca552903b98187f" compoundref="mapelites_8py" startline="374" endline="398">fcmaes.mapelites.optimize_cma_</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespacefcmaes_1_1mapelites_1a5c3c74816cffd5997c0f9e897205abc8" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>fcmaes.mapelites.get_grid_indices</definition>
        <argsstring>(ds, capacity, lb, ub)</argsstring>
        <name>get_grid_indices</name>
        <qualifiedname>fcmaes.mapelites.get_grid_indices</qualifiedname>
        <param>
          <type>ds</type>
          <defname>ds</defname>
        </param>
        <param>
          <type>capacity</type>
          <defname>capacity</defname>
        </param>
        <param>
          <type>lb</type>
          <defname>lb</defname>
        </param>
        <param>
          <type>ub</type>
          <defname>ub</defname>
        </param>
        <briefdescription>
<para>Computes and returns grid indices for a dataset based on the provided grid capacity, lower, and upper bounds. </para>
        </briefdescription>
        <detaileddescription>
<para>Each point in the dataset is normalized and then converted into a grid index using the specified parameters.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>ds</parametername>
</parameternamelist>
<parameterdescription>
<para>Input dataset (2D numpy array) where each row is a point in a multi-dimensional space. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>capacity</parametername>
</parameternamelist>
<parameterdescription>
<para>Total number of grid cells (capacity of the grid). </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>lb</parametername>
</parameternamelist>
<parameterdescription>
<para>Lower bounds of the dataset in each dimension. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>ub</parametername>
</parameternamelist>
<parameterdescription>
<para>Upper bounds of the dataset in each dimension.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para></para>
</simplesect>
<simplesect kind="return"><para>np An array of grid indices, where each index corresponds to a point in the input dataset. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="fcmaes/mapelites.py" line="469" column="1" bodyfile="fcmaes/mapelites.py" bodystart="469" bodyend="481"/>
        <referencedby refid="classfcmaes_1_1mapelites_1_1_archive_1ab4f4023cb427da5cbedcf919c4641bfa" compoundref="mapelites_8py" startline="739" endline="744">fcmaes.mapelites.Archive.index_of_niches</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespacefcmaes_1_1mapelites_1a5f70b23800f6a77b08d918f5aa0f9b3d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>fcmaes.mapelites.variation_</definition>
        <argsstring>(pop, lower, upper, rg, dis_c=20, dis_m=20)</argsstring>
        <name>variation_</name>
        <qualifiedname>fcmaes.mapelites.variation_</qualifiedname>
        <param>
          <type>pop</type>
          <defname>pop</defname>
        </param>
        <param>
          <type>lower</type>
          <defname>lower</defname>
        </param>
        <param>
          <type>upper</type>
          <defname>upper</defname>
        </param>
        <param>
          <type>rg</type>
          <defname>rg</defname>
        </param>
        <param>
          <type>dis_c</type>
          <defname>dis_c</defname>
          <defval>20</defval>
        </param>
        <param>
          <type>dis_m</type>
          <defname>dis_m</defname>
          <defval>20</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="fcmaes/mapelites.py" line="1459" column="1" bodyfile="fcmaes/mapelites.py" bodystart="1459" bodyend="1490"/>
        <referencedby refid="namespacefcmaes_1_1mapelites_1a04bcf57530df0bef091b00ceb8e9d44a" compoundref="mapelites_8py" startline="326" endline="355">fcmaes.mapelites.run_map_elites_</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespacefcmaes_1_1mapelites_1aa557fd895bcaf40f495273ef16953c11" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>fcmaes.mapelites.iso_dd_</definition>
        <argsstring>(x1, x2, lower, upper, rg, iso_sigma=0.01, line_sigma=0.2)</argsstring>
        <name>iso_dd_</name>
        <qualifiedname>fcmaes.mapelites.iso_dd_</qualifiedname>
        <param>
          <type>x1</type>
          <defname>x1</defname>
        </param>
        <param>
          <type>x2</type>
          <defname>x2</defname>
        </param>
        <param>
          <type>lower</type>
          <defname>lower</defname>
        </param>
        <param>
          <type>upper</type>
          <defname>upper</defname>
        </param>
        <param>
          <type>rg</type>
          <defname>rg</defname>
        </param>
        <param>
          <type>iso_sigma</type>
          <defname>iso_sigma</defname>
          <defval>0.01</defval>
        </param>
        <param>
          <type>line_sigma</type>
          <defname>line_sigma</defname>
          <defval>0.2</defval>
        </param>
        <briefdescription>
<para>Generates isotropic deviation data within specified bounds. </para>
        </briefdescription>
        <detaileddescription>
<para>This function creates a variation of the input data <computeroutput>x1</computeroutput> influenced by Gaussian noise parameters for isotropic and line deviations. The result is clipped to remain within the range defined by the <computeroutput>lower</computeroutput> and <computeroutput>upper</computeroutput> bounds.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>x1</parametername>
</parameternamelist>
<parameterdescription>
<para>The primary input array for generating isotropic deviation data. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>x2</parametername>
</parameternamelist>
<parameterdescription>
<para>The secondary input array influencing line deviation calculation. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>lower</parametername>
</parameternamelist>
<parameterdescription>
<para>The lower bound for clipping the resulting data. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>upper</parametername>
</parameternamelist>
<parameterdescription>
<para>The upper bound for clipping the resulting data. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>rg</parametername>
</parameternamelist>
<parameterdescription>
<para>Random generator object used for generating Gaussian noise. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>iso_sigma</parametername>
</parameternamelist>
<parameterdescription>
<para>Standard deviation of the isotropic Gaussian noise. Defaults to 0.01. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>line_sigma</parametername>
</parameternamelist>
<parameterdescription>
<para>Standard deviation of the line Gaussian noise. Defaults to </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>0.2.</parametername>
</parameternamelist>
<parameterdescription>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para></para>
</simplesect>
<simplesect kind="return"><para>ndarray The processed array with isotropic and line deviations applied and bounded by the given limits. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="fcmaes/mapelites.py" line="1515" column="1" bodyfile="fcmaes/mapelites.py" bodystart="1515" bodyend="1520"/>
        <referencedby refid="namespacefcmaes_1_1mapelites_1a04bcf57530df0bef091b00ceb8e9d44a" compoundref="mapelites_8py" startline="326" endline="355">fcmaes.mapelites.run_map_elites_</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespacefcmaes_1_1mapelites_1a1cd72ab87d7aa999a255ad854895d3aa" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type></type>
        <definition>fcmaes.mapelites.get_centers_</definition>
        <argsstring>(niche_num, dim, samples_per_niche)</argsstring>
        <name>get_centers_</name>
        <qualifiedname>fcmaes.mapelites.get_centers_</qualifiedname>
        <param>
          <type>niche_num</type>
          <defname>niche_num</defname>
        </param>
        <param>
          <type>dim</type>
          <defname>dim</defname>
        </param>
        <param>
          <type>samples_per_niche</type>
          <defname>samples_per_niche</defname>
        </param>
        <briefdescription>
<para>Determines and returns the centers of niches in a defined space using k-means clustering. </para>
        </briefdescription>
        <detaileddescription>
<para>If the data is cached, it loads the cached centers for faster access. Otherwise, it computes the centers by applying k-means clustering on randomly generated samples and caches the result for future use.</para>
<para><parameterlist kind="param"><parameteritem>
<parameternamelist>
<parametername>niche_num</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of niches or clusters to determine centers for. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>dim</parametername>
</parameternamelist>
<parameterdescription>
<para>Dimensionality of the space where the niches are located. </para>
</parameterdescription>
</parameteritem>
<parameteritem>
<parameternamelist>
<parametername>samples_per_niche</parametername>
</parameternamelist>
<parameterdescription>
<para>Number of samples used per niche to compute the centers.</para>
</parameterdescription>
</parameteritem>
</parameterlist>
<simplesect kind="return"><para></para>
</simplesect>
<simplesect kind="return"><para>numpy An array representing the determined centers of the niches. </para>
</simplesect>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="fcmaes/mapelites.py" line="1535" column="1" bodyfile="fcmaes/mapelites.py" bodystart="1535" bodyend="1551"/>
        <referencedby refid="namespacefcmaes_1_1mapelites_1ace0194d76906adbf0c0dd3db084f177c" compoundref="mapelites_8py" startline="231" endline="238">fcmaes.mapelites.set_KDTree</referencedby>
      </memberdef>
    </sectiondef>
    <briefdescription>
<para>============================================================================= </para>
    </briefdescription>
    <detaileddescription>
<para>Fast version 1.6.11</para>
<para>(c) 2025 – Dietmar Wolz (c) 2025 – Latitude</para>
<para>License MIT</para>
<para><itemizedlist>
<listitem><para><ref refid="mapelites_8py" kindref="compound">mapelites.py</ref></para>
</listitem></itemizedlist>
</para>
<para><simplesect kind="par"><title>Description</title><para><itemizedlist>
<listitem><para>Numpy based implementation of CVT MAP-Elites including CMA-ES emitter and CMA-ES drilldown. </para>
</listitem></itemizedlist>
</para>
</simplesect>
<simplesect kind="par"><title></title><para><programlisting><codeline><highlight class="normal"><sp/><sp/><sp/>See<sp/>[2]<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>[3]</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="preprocessor">@par</highlight></codeline>
</programlisting> MAP-Elites implementations differ in the following details: </para>
</simplesect>
<simplesect kind="par"><title></title><para>1) Initialisation of the behavior space: </para>
</simplesect>
<simplesect kind="par"><title></title><para>a) Generated from some solution distribution by applying the fitness function to determine their behavior. b) Generated from uniform samples of the behavior space. </para>
</simplesect>
<simplesect kind="par"><title></title><para>We use b) because random solutions may cover only parts of the behavior space. Some parts may only be reachable by optimization. Another reason: <ref refid="class_fitness" kindref="compound">Fitness</ref> computations may be expensive. Therefore we don&apos;t compute fitness values for the initial solution population. </para>
</simplesect>
<simplesect kind="par"><title></title><para>2) Initialization of the niches: </para>
</simplesect>
<simplesect kind="par"><title></title><para>a) Generated from some solution distribution. b) Generated from uniform samples of the solution space. These solutions are never evaluated but serve as initial population for SBX or Iso+LineDD. Their associated fitness value is set to math.inf (infinity). </para>
</simplesect>
<simplesect kind="par"><title></title><para>We use b) because this way we:<itemizedlist>
<listitem><para>Avoid computing fitness values for the initial population.</para>
</listitem><listitem><para>Enhance the diversity of initial solutions emitted by SBX or Iso+LineDD. </para>
</listitem></itemizedlist>
</para>
</simplesect>
<simplesect kind="par"><title></title><para>3) Iso+LineDD [4] is implemented but doesn&apos;t work well with extremely ragged solution landscapes. Therefore SBX+mutation is the default setting. </para>
</simplesect>
<simplesect kind="par"><title></title><para>4) SBX (Simulated binary crossover) is taken from <ref refid="mode_8py" kindref="compound">mode.py</ref> and simplified. It is combined with mutation. Both spread factors - for crossover and mutation - are randomized for each application. </para>
</simplesect>
<simplesect kind="par"><title></title><para>5) Candidates for CMA-ES are sampled with a bias to better niches. As for SBX only a subset of the archive is used, the worst niches are ignored. </para>
</simplesect>
<simplesect kind="par"><title></title><para>6) There is a CMA-ES drill down for specific niches - in this mode all solutions outside the niche are rejected. Restricted solution box bounds are used derived from statistics maintained by the archive during the addition of new solution candidates. </para>
</simplesect>
<simplesect kind="par"><title></title><para>7) The QD-archive uses shared memory to reduce inter-process communication overhead.</para>
</simplesect>
<simplesect kind="author"><para>:<itemizedlist>
<listitem><para>Dietmar Wolz <programlisting><codeline><highlight class="normal">-<sp/>romain.despoullains</highlight><highlight class="preprocessor">@latitude.eu</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal">-<sp/>corentin.generet</highlight><highlight class="preprocessor">@latitude.eu</highlight></codeline>
</programlisting></para>
</listitem></itemizedlist>
</para>
</simplesect>
<simplesect kind="par"><title>References</title><para><itemizedlist>
<listitem><para>[1] <ulink url="https://github.com/dietmarwo/fast-cma-es">https://github.com/dietmarwo/fast-cma-es</ulink></para>
</listitem><listitem><para>[2] <ulink url="https://arxiv.org/abs/1610.05729">https://arxiv.org/abs/1610.05729</ulink></para>
</listitem><listitem><para>[3] <ulink url="https://arxiv.org/pdf/1912.02400.pdf">https://arxiv.org/pdf/1912.02400.pdf</ulink></para>
</listitem><listitem><para>[4] <ulink url="https://arxiv.org/pdf/1804.03906">https://arxiv.org/pdf/1804.03906</ulink></para>
</listitem></itemizedlist>
</para>
</simplesect>
<simplesect kind="par"><title>Documentation</title><para><itemizedlist>
<listitem></listitem></itemizedlist>
</para>
</simplesect>
<hruler/>
 </para>
    </detaileddescription>
    <programlisting>
<codeline lineno="1" refid="namespacefcmaes_1_1mapelites" refkind="compound"><highlight class="comment">#<sp/>-*-<sp/>coding:<sp/>utf-8<sp/>-*-</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="3"><highlight class="stringliteral">=============================================================================</highlight></codeline>
<codeline lineno="4"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="5"><highlight class="stringliteral"><sp/>Fast<sp/>CMA-ES<sp/>-<sp/>version<sp/>1.6.11</highlight></codeline>
<codeline lineno="6"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="7"><highlight class="stringliteral"><sp/>(c)<sp/>2025<sp/>–<sp/>Dietmar<sp/>Wolz</highlight></codeline>
<codeline lineno="8"><highlight class="stringliteral"><sp/>(c)<sp/>2025<sp/>–<sp/>Latitude</highlight></codeline>
<codeline lineno="9"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="10"><highlight class="stringliteral"><sp/>License:<sp/>MIT</highlight></codeline>
<codeline lineno="11"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="12"><highlight class="stringliteral"><sp/>File:</highlight></codeline>
<codeline lineno="13"><highlight class="stringliteral"><sp/><sp/>-<sp/>mapelites.py</highlight></codeline>
<codeline lineno="14"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="15"><highlight class="stringliteral"><sp/>Description:</highlight></codeline>
<codeline lineno="16"><highlight class="stringliteral"><sp/><sp/>-<sp/>Numpy<sp/>based<sp/>implementation<sp/>of<sp/>CVT<sp/>MAP-Elites<sp/>including<sp/>CMA-ES<sp/>emitter<sp/>and<sp/>CMA-ES<sp/>drilldown.<sp/></highlight></codeline>
<codeline lineno="17"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="18"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>See<sp/>[2]<sp/>and<sp/>[3]</highlight></codeline>
<codeline lineno="19"><highlight class="stringliteral"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="20"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>MAP-Elites<sp/>implementations<sp/>differ<sp/>in<sp/>the<sp/>following<sp/>details:</highlight></codeline>
<codeline lineno="21"><highlight class="stringliteral"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="22"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>1)<sp/>Initialisation<sp/>of<sp/>the<sp/>behavior<sp/>space:</highlight></codeline>
<codeline lineno="23"><highlight class="stringliteral"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="24"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>a)<sp/>Generated<sp/>from<sp/>some<sp/>solution<sp/>distribution<sp/>by<sp/>applying<sp/>the<sp/>fitness<sp/>function<sp/>to<sp/>determine<sp/>their<sp/>behavior.</highlight></codeline>
<codeline lineno="25"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>b)<sp/>Generated<sp/>from<sp/>uniform<sp/>samples<sp/>of<sp/>the<sp/>behavior<sp/>space.<sp/></highlight></codeline>
<codeline lineno="26"><highlight class="stringliteral"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="27"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>We<sp/>use<sp/>b)<sp/>because<sp/>random<sp/>solutions<sp/>may<sp/>cover<sp/>only<sp/>parts<sp/>of<sp/>the<sp/>behavior<sp/>space.<sp/>Some<sp/>parts<sp/>may<sp/>only<sp/>be<sp/>reachable<sp/></highlight></codeline>
<codeline lineno="28"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>by<sp/>optimization.<sp/>Another<sp/>reason:<sp/>Fitness<sp/>computations<sp/>may<sp/>be<sp/>expensive.<sp/>Therefore<sp/>we<sp/>don&apos;t<sp/>compute<sp/>fitness</highlight></codeline>
<codeline lineno="29"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>values<sp/>for<sp/>the<sp/>initial<sp/>solution<sp/>population.<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="30"><highlight class="stringliteral"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="31"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>2)<sp/>Initialization<sp/>of<sp/>the<sp/>niches:<sp/></highlight></codeline>
<codeline lineno="32"><highlight class="stringliteral"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="33"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>a)<sp/>Generated<sp/>from<sp/>some<sp/>solution<sp/>distribution.</highlight></codeline>
<codeline lineno="34"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>b)<sp/>Generated<sp/>from<sp/>uniform<sp/>samples<sp/>of<sp/>the<sp/>solution<sp/>space.<sp/>These<sp/>solutions<sp/>are<sp/>never<sp/>evaluated<sp/>but<sp/>serve<sp/>as</highlight></codeline>
<codeline lineno="35"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>initial<sp/>population<sp/>for<sp/>SBX<sp/>or<sp/>Iso+LineDD.<sp/>Their<sp/>associated<sp/>fitness<sp/>value<sp/>is<sp/>set<sp/>to<sp/>math.inf<sp/>(infinity).</highlight></codeline>
<codeline lineno="36"><highlight class="stringliteral"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="37"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>We<sp/>use<sp/>b)<sp/>because<sp/>this<sp/>way<sp/>we:<sp/></highlight></codeline>
<codeline lineno="38"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>-<sp/>Avoid<sp/>computing<sp/>fitness<sp/>values<sp/>for<sp/>the<sp/>initial<sp/>population.</highlight></codeline>
<codeline lineno="39"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>-<sp/>Enhance<sp/>the<sp/>diversity<sp/>of<sp/>initial<sp/>solutions<sp/>emitted<sp/>by<sp/>SBX<sp/>or<sp/>Iso+LineDD.</highlight></codeline>
<codeline lineno="40"><highlight class="stringliteral"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="41"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>3)<sp/>Iso+LineDD<sp/>[4]<sp/>is<sp/>implemented<sp/>but<sp/>doesn&apos;t<sp/>work<sp/>well<sp/>with<sp/>extremely<sp/>ragged<sp/>solution</highlight></codeline>
<codeline lineno="42"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>landscapes.<sp/>Therefore<sp/>SBX+mutation<sp/>is<sp/>the<sp/>default<sp/>setting.</highlight></codeline>
<codeline lineno="43"><highlight class="stringliteral"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="44"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>4)<sp/>SBX<sp/>(Simulated<sp/>binary<sp/>crossover)<sp/>is<sp/>taken<sp/>from<sp/>mode.py<sp/>and<sp/>simplified.<sp/>It<sp/>is<sp/>combined<sp/>with<sp/>mutation.</highlight></codeline>
<codeline lineno="45"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Both<sp/>spread<sp/>factors<sp/>-<sp/>for<sp/>crossover<sp/>and<sp/>mutation<sp/>-<sp/>are<sp/>randomized<sp/>for<sp/>each<sp/>application.<sp/></highlight></codeline>
<codeline lineno="46"><highlight class="stringliteral"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="47"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>5)<sp/>Candidates<sp/>for<sp/>CMA-ES<sp/>are<sp/>sampled<sp/>with<sp/>a<sp/>bias<sp/>to<sp/>better<sp/>niches.<sp/>As<sp/>for<sp/>SBX<sp/>only<sp/>a<sp/>subset<sp/>of<sp/>the<sp/>archive<sp/>is</highlight></codeline>
<codeline lineno="48"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>used,<sp/>the<sp/>worst<sp/>niches<sp/>are<sp/>ignored.<sp/></highlight></codeline>
<codeline lineno="49"><highlight class="stringliteral"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="50"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>6)<sp/>There<sp/>is<sp/>a<sp/>CMA-ES<sp/>drill<sp/>down<sp/>for<sp/>specific<sp/>niches<sp/>-<sp/>in<sp/>this<sp/>mode<sp/>all<sp/>solutions<sp/>outside<sp/>the<sp/>niche</highlight></codeline>
<codeline lineno="51"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>are<sp/>rejected.<sp/>Restricted<sp/>solution<sp/>box<sp/>bounds<sp/>are<sp/>used<sp/>derived<sp/>from<sp/>statistics<sp/>maintained<sp/>by<sp/>the<sp/>archive</highlight></codeline>
<codeline lineno="52"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>during<sp/>the<sp/>addition<sp/>of<sp/>new<sp/>solution<sp/>candidates.<sp/></highlight></codeline>
<codeline lineno="53"><highlight class="stringliteral"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="54"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>7)<sp/>The<sp/>QD-archive<sp/>uses<sp/>shared<sp/>memory<sp/>to<sp/>reduce<sp/>inter-process<sp/>communication<sp/>overhead.</highlight></codeline>
<codeline lineno="55"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="56"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="57"><highlight class="stringliteral"><sp/>Authors:</highlight></codeline>
<codeline lineno="58"><highlight class="stringliteral"><sp/><sp/>-<sp/>Dietmar<sp/>Wolz</highlight></codeline>
<codeline lineno="59"><highlight class="stringliteral"><sp/><sp/>-<sp/>romain.despoullains@latitude.eu</highlight></codeline>
<codeline lineno="60"><highlight class="stringliteral"><sp/><sp/>-<sp/>corentin.generet@latitude.eu</highlight></codeline>
<codeline lineno="61"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="62"><highlight class="stringliteral"><sp/>References:</highlight></codeline>
<codeline lineno="63"><highlight class="stringliteral"><sp/><sp/>-<sp/>[1]<sp/>https://github.com/dietmarwo/fast-cma-es</highlight></codeline>
<codeline lineno="64"><highlight class="stringliteral"><sp/><sp/>-<sp/>[2]<sp/>https://arxiv.org/abs/1610.05729</highlight></codeline>
<codeline lineno="65"><highlight class="stringliteral"><sp/><sp/>-<sp/>[3]<sp/>https://arxiv.org/pdf/1912.02400.pdf</highlight></codeline>
<codeline lineno="66"><highlight class="stringliteral"><sp/><sp/>-<sp/>[4]<sp/>https://arxiv.org/pdf/1804.03906</highlight></codeline>
<codeline lineno="67"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="68"><highlight class="stringliteral"><sp/>Documentation:</highlight></codeline>
<codeline lineno="69"><highlight class="stringliteral"><sp/><sp/>-</highlight></codeline>
<codeline lineno="70"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="71"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="72"><highlight class="stringliteral">=============================================================================</highlight></codeline>
<codeline lineno="73"><highlight class="stringliteral">&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>__future__<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>annotations</highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>numpy<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>np</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>numpy.random<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Generator,<sp/>PCG64DXSM,<sp/>SeedSequence</highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>multiprocessing<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Process</highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>multiprocessing<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>mp</highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>sklearn.neighbors<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>KDTree</highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>sklearn.cluster<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>KMeans</highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>scipy.optimize<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Bounds</highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>pathlib<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Path</highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacefcmaes_1_1retry" kindref="compound">fcmaes.retry</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Shared2d</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacefcmaes_1_1optimizer" kindref="compound">fcmaes.optimizer</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>dtime</highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>fcmaes<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>cmaescpp</highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>numpy.random<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>default_rng</highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>ctypes<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>ct</highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>time<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>perf_counter</highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>threadpoolctl</highlight></codeline>
<codeline lineno="92"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>numba<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>njit</highlight></codeline>
<codeline lineno="93"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/><ref refid="namespacefcmaes_1_1evaluator" kindref="compound">fcmaes.evaluator</ref><sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>is_debug_active</highlight></codeline>
<codeline lineno="94"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>loguru<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>logger</highlight></codeline>
<codeline lineno="95"><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>typing<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>Optional,<sp/>Callable,<sp/>Tuple,<sp/>Dict</highlight></codeline>
<codeline lineno="97"><highlight class="normal"></highlight><highlight class="keyword">from</highlight><highlight class="normal"><sp/>numpy.typing<sp/></highlight><highlight class="keyword">import</highlight><highlight class="normal"><sp/>ArrayLike</highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal">rng<sp/>=<sp/>default_rng()</highlight></codeline>
<codeline lineno="100"><highlight class="normal"></highlight></codeline>
<codeline lineno="101"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacefcmaes_1_1mapelites_1a028f687a02a53b2626abc9f046a77aa2" kindref="member">optimize_map_elites</ref>(qd_fitness:<sp/>Callable[[ArrayLike],<sp/>Tuple[float,<sp/>np.ndarray]],<sp/></highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bounds:<sp/>Bounds,<sp/></highlight></codeline>
<codeline lineno="103" refid="namespacefcmaes_1_1mapelites_1ae3ff11934566d45300958dca5961a6ca" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qd_bounds:<sp/>Bounds,<sp/></highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>niche_num:<sp/>Optional[int]<sp/>=<sp/>4000,<sp/></highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>samples_per_niche:<sp/>Optional[int]<sp/>=<sp/>20,<sp/></highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>workers:<sp/>Optional[int]<sp/>=<sp/>mp.cpu_count(),<sp/></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iterations:<sp/>Optional[int]<sp/>=<sp/>100,<sp/></highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>archive:<sp/>Optional[Archive]<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>me_params:<sp/>Optional[Dict]<sp/>=<sp/>{},<sp/></highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cma_params:<sp/>Optional[Dict]<sp/>=<sp/>{},<sp/></highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>use_stats:<sp/>Optional[bool]<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>Archive:</highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="115"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Optimizes<sp/>a<sp/>map-elites<sp/>evolutionary<sp/>algorithm<sp/>to<sp/>find<sp/>diverse<sp/>and<sp/>high-performing<sp/>solutions<sp/></highlight></codeline>
<codeline lineno="116"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>by<sp/>distributing<sp/>samples<sp/>into<sp/>niches,<sp/>iteratively<sp/>evolving<sp/>them,<sp/>and<sp/>maintaining<sp/>an<sp/>archive<sp/></highlight></codeline>
<codeline lineno="117"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>to<sp/>store<sp/>the<sp/>found<sp/>solutions.</highlight></codeline>
<codeline lineno="118"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="119"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>function<sp/>leverages<sp/>a<sp/>map-elites<sp/>approach<sp/>to<sp/>optimize<sp/>solutions<sp/>across<sp/>a<sp/>given<sp/>feature<sp/></highlight></codeline>
<codeline lineno="120"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>space<sp/>or<sp/>behavioral<sp/>space<sp/>defined<sp/>by<sp/>the<sp/>`qd_bounds`<sp/>parameter.<sp/>The<sp/>objective<sp/>of<sp/>the<sp/>optimization<sp/></highlight></codeline>
<codeline lineno="121"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>is<sp/>to<sp/>populate<sp/>an<sp/>archive<sp/>with<sp/>solutions<sp/>that<sp/>exhibit<sp/>high<sp/>fitness<sp/>while<sp/>ensuring<sp/>diversity<sp/></highlight></codeline>
<codeline lineno="122"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>in<sp/>behavior<sp/>across<sp/>the<sp/>space.<sp/>The<sp/>archive<sp/>is<sp/>continuously<sp/>updated<sp/>and<sp/>sorted<sp/>during<sp/>the<sp/>iterations<sp/></highlight></codeline>
<codeline lineno="123"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>to<sp/>reflect<sp/>the<sp/>best<sp/>solutions<sp/>in<sp/>each<sp/>niche.<sp/>The<sp/>performance<sp/>is<sp/>monitored<sp/>throughout<sp/>the<sp/></highlight></codeline>
<codeline lineno="124"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>optimization<sp/>process.</highlight></codeline>
<codeline lineno="125"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="126"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="127"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qd_fitness<sp/>(Callable[[ArrayLike],<sp/>Tuple[float,<sp/>np.ndarray]]):<sp/>The<sp/>quantitative<sp/>fitness<sp/></highlight></codeline>
<codeline lineno="128"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>function<sp/>used<sp/>to<sp/>evaluate<sp/>the<sp/>solutions.<sp/>It<sp/>must<sp/>return<sp/>a<sp/>tuple<sp/>containing<sp/>the<sp/>fitness<sp/></highlight></codeline>
<codeline lineno="129"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>score<sp/>and<sp/>the<sp/>corresponding<sp/>feature<sp/>descriptor/behavior<sp/>representation.</highlight></codeline>
<codeline lineno="130"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bounds<sp/>(Bounds):<sp/>Represents<sp/>the<sp/>variable<sp/>bounds<sp/>for<sp/>the<sp/>optimization<sp/>space.</highlight></codeline>
<codeline lineno="131"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qd_bounds<sp/>(Bounds):<sp/>Defines<sp/>the<sp/>range<sp/>of<sp/>the<sp/>quality-diversity<sp/>feature/behavioral<sp/>space.</highlight></codeline>
<codeline lineno="132"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>niche_num<sp/>(Optional[int]):<sp/>The<sp/>total<sp/>number<sp/>of<sp/>niches<sp/>in<sp/>the<sp/>archive.<sp/>Determines<sp/>how<sp/></highlight></codeline>
<codeline lineno="133"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>solutions<sp/>will<sp/>be<sp/>distributed<sp/>across<sp/>the<sp/>feature<sp/>space.<sp/>Defaults<sp/>to<sp/>4000.</highlight></codeline>
<codeline lineno="134"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>samples_per_niche<sp/>(Optional[int]):<sp/>The<sp/>number<sp/>of<sp/>samples<sp/>generated<sp/>per<sp/>niche<sp/>during<sp/></highlight></codeline>
<codeline lineno="135"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>initialization.<sp/>Defaults<sp/>to<sp/>20.</highlight></codeline>
<codeline lineno="136"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>workers<sp/>(Optional[int]):<sp/>Number<sp/>of<sp/>CPU<sp/>workers/threads<sp/>to<sp/>parallelize<sp/>the<sp/>process.<sp/></highlight></codeline>
<codeline lineno="137"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Defaults<sp/>to<sp/>the<sp/>number<sp/>of<sp/>CPUs<sp/>available.</highlight></codeline>
<codeline lineno="138"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iterations<sp/>(Optional[int]):<sp/>The<sp/>total<sp/>number<sp/>of<sp/>iterations<sp/>to<sp/>evolve<sp/>the<sp/>archive.<sp/></highlight></codeline>
<codeline lineno="139"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Defaults<sp/>to<sp/>100.</highlight></codeline>
<codeline lineno="140"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>archive<sp/>(Optional[Archive]):<sp/>Pre-existing<sp/>archive<sp/>object<sp/>for<sp/>storing<sp/>solutions.<sp/>If<sp/>`None`,<sp/></highlight></codeline>
<codeline lineno="141"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a<sp/>new<sp/>archive<sp/>is<sp/>initialized.<sp/>Defaults<sp/>to<sp/>None.</highlight></codeline>
<codeline lineno="142"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>me_params<sp/>(Optional[Dict]):<sp/>Additional<sp/>hyperparameters<sp/>specific<sp/>to<sp/>the<sp/>map-elites<sp/>algorithm.<sp/></highlight></codeline>
<codeline lineno="143"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Defaults<sp/>to<sp/>an<sp/>empty<sp/>dictionary.</highlight></codeline>
<codeline lineno="144" refid="namespacefcmaes_1_1mapelites_1a028f687a02a53b2626abc9f046a77aa2" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cma_params<sp/>(Optional[Dict]):<sp/>Hyperparameters<sp/>specific<sp/>to<sp/>the<sp/>CMA-ES<sp/>algorithm<sp/>used<sp/></highlight></codeline>
<codeline lineno="145"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>evolutionary<sp/>strategies.<sp/>Defaults<sp/>to<sp/>an<sp/>empty<sp/>dictionary.</highlight></codeline>
<codeline lineno="146"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>use_stats<sp/>(Optional[bool]):<sp/>Flag<sp/>to<sp/>determine<sp/>whether<sp/>statistical<sp/>data<sp/>should<sp/>be<sp/></highlight></codeline>
<codeline lineno="147"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>collected<sp/>and<sp/>maintained<sp/>in<sp/>the<sp/>archive.<sp/>Defaults<sp/>to<sp/>False.</highlight></codeline>
<codeline lineno="148"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="149"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="150"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Archive:<sp/>The<sp/>final<sp/>archive<sp/>containing<sp/>diverse<sp/>high-performing<sp/>solutions<sp/>distributed<sp/></highlight></codeline>
<codeline lineno="151"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>across<sp/>the<sp/>quality-diversity<sp/>space.</highlight></codeline>
<codeline lineno="152"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/>dim<sp/>=<sp/>len(bounds.lb)<sp/></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>archive<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:<sp/></highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>archive<sp/>=<sp/><ref refid="classfcmaes_1_1mapelites_1_1_archive" kindref="compound">Archive</ref>(dim,<sp/>qd_bounds,<sp/>niche_num,<sp/>use_stats)</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>archive.init_niches(samples_per_niche)</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>initialize<sp/>archive<sp/>with<sp/>random<sp/>values</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.xs.view()[:]<sp/>=<sp/>rng.uniform(bounds.lb,<sp/>bounds.ub,<sp/>(niche_num,<sp/>dim))</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/>t0<sp/>=<sp/>perf_counter()<sp/></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/>qd_fitness.archive<sp/>=<sp/>archive<sp/></highlight><highlight class="comment">#<sp/>attach<sp/>archive<sp/>for<sp/>logging<sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>iter<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(iterations):</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>archive.argsort()<sp/></highlight><highlight class="comment">#<sp/>sort<sp/>archive<sp/>to<sp/>select<sp/>the<sp/>best_n</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacefcmaes_1_1mapelites_1ad2ec9edcc53986935aa2f2e1127d458d" kindref="member">optimize_map_elites_</ref>(archive,<sp/>qd_fitness,<sp/>bounds,<sp/>workers,</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>me_params,<sp/>cma_params)</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>is_debug_active():</highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ys<sp/>=<sp/>np.sort(archive.get_ys())[:100]<sp/></highlight><highlight class="comment">#<sp/>best<sp/>100<sp/>fitness<sp/>values</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logger.debug(f</highlight><highlight class="stringliteral">&apos;best<sp/>100<sp/>iter<sp/>{iter}<sp/>best<sp/>{min(ys):.3f}<sp/>worst<sp/>{max(ys):.3f}<sp/>&apos;</highlight><highlight class="normal"><sp/>+<sp/></highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f</highlight><highlight class="stringliteral">&apos;mean<sp/>{np.mean(ys):.3f}<sp/>stdev<sp/>{np.std(ys):.3f}<sp/>time<sp/>{dtime(t0)}<sp/>s&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>archive</highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacefcmaes_1_1mapelites_1a49c2831aa0bf9634663977bbd6321afc" kindref="member">empty_archive</ref>(dim:<sp/>int,<sp/></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qd_bounds:<sp/>Bounds,<sp/></highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>niche_num:<sp/>int,<sp/></highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>samples_per_niche:<sp/>int,<sp/></highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>use_stats:<sp/>Optional[bool]<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">)<sp/>-&gt;<sp/>Archive:</highlight></codeline>
<codeline lineno="177"><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="179"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Creates<sp/>and<sp/>initializes<sp/>an<sp/>archive<sp/>for<sp/>quality<sp/>diversity<sp/>(QD)<sp/>experiments.</highlight></codeline>
<codeline lineno="180"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="181"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>function<sp/>creates<sp/>an<sp/>Archive<sp/>object<sp/>with<sp/>the<sp/>specified<sp/>dimensions,</highlight></codeline>
<codeline lineno="182"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>bounding<sp/>box,<sp/>number<sp/>of<sp/>niches,<sp/>and<sp/>optionally<sp/>enables<sp/>statistics<sp/>collection.</highlight></codeline>
<codeline lineno="183"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>It<sp/>also<sp/>initializes<sp/>the<sp/>niches<sp/>in<sp/>the<sp/>archive<sp/>with<sp/>a<sp/>specified<sp/>number<sp/></highlight></codeline>
<codeline lineno="184"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>of<sp/>samples<sp/>per<sp/>niche.</highlight></codeline>
<codeline lineno="185"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="186"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="187"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dim<sp/>(int):<sp/>Dimensionality<sp/>of<sp/>the<sp/>search/grid<sp/>space<sp/>for<sp/>the<sp/>archive.</highlight></codeline>
<codeline lineno="188"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qd_bounds<sp/>(Bounds):<sp/>Bounds<sp/>specifying<sp/>the<sp/>range<sp/>for<sp/>niche<sp/>space<sp/>coordinates.</highlight></codeline>
<codeline lineno="189"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>niche_num<sp/>(int):<sp/>Number<sp/>of<sp/>niches<sp/>to<sp/>be<sp/>created<sp/>in<sp/>the<sp/>archive.</highlight></codeline>
<codeline lineno="190"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>samples_per_niche<sp/>(int):<sp/>Number<sp/>of<sp/>samples<sp/>to<sp/>initialize<sp/>in<sp/>each<sp/>niche.</highlight></codeline>
<codeline lineno="191"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>use_stats<sp/>(Optional[bool],<sp/>optional):<sp/>If<sp/>True,<sp/>statistics<sp/>collection<sp/>will<sp/>be</highlight></codeline>
<codeline lineno="192"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>enabled<sp/>in<sp/>the<sp/>archive.<sp/>Defaults<sp/>to<sp/>False.</highlight></codeline>
<codeline lineno="193"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="194"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="195"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Archive:<sp/>The<sp/>initialized<sp/>archive<sp/>object<sp/>for<sp/>QD<sp/>experiments.</highlight></codeline>
<codeline lineno="196" refid="namespacefcmaes_1_1mapelites_1a49c2831aa0bf9634663977bbd6321afc" refkind="member"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="197"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"></highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/>archive<sp/>=<sp/><ref refid="classfcmaes_1_1mapelites_1_1_archive" kindref="compound">Archive</ref>(dim,<sp/>qd_bounds,<sp/>niche_num,<sp/>use_stats)</highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/>archive.init_niches(samples_per_niche)</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>archive</highlight></codeline>
<codeline lineno="202"><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacefcmaes_1_1mapelites_1ace0194d76906adbf0c0dd3db084f177c" kindref="member">set_KDTree</ref>(archive:<sp/>Archive,</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>centers:Optional[np.ndarray]<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>niche_num:<sp/>Optional[int]<sp/><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qd_bounds:<sp/>Optional[Bounds]<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>samples_per_niche:<sp/>Optional[int]<sp/>=<sp/>100):</highlight></codeline>
<codeline lineno="208"><highlight class="normal"></highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="210"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Sets<sp/>up<sp/>a<sp/>KDTree<sp/>for<sp/>the<sp/>given<sp/>archive<sp/>using<sp/>specified<sp/>or<sp/>default<sp/>parameters.</highlight></codeline>
<codeline lineno="211"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="212"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>function<sp/>initializes<sp/>a<sp/>KDTree<sp/>structure<sp/>with<sp/>the<sp/>given<sp/>or<sp/>generated<sp/></highlight></codeline>
<codeline lineno="213"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>centers,<sp/>enabling<sp/>efficient<sp/>spatial<sp/>searches<sp/>within<sp/>the<sp/>archive.<sp/>If<sp/>the<sp/>centers<sp/></highlight></codeline>
<codeline lineno="214"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>are<sp/>not<sp/>provided,<sp/>they<sp/>will<sp/>be<sp/>generated<sp/>using<sp/>the<sp/>`get_centers_`<sp/>function<sp/></highlight></codeline>
<codeline lineno="215"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>based<sp/>on<sp/>the<sp/>number<sp/>of<sp/>niches,<sp/>dimensionality<sp/>of<sp/>the<sp/>bounds,<sp/>and<sp/>the<sp/>number<sp/></highlight></codeline>
<codeline lineno="216"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>of<sp/>samples<sp/>per<sp/>niche.<sp/>This<sp/>KDTree<sp/>is<sp/>essential<sp/>for<sp/>spatial<sp/>partitioning<sp/></highlight></codeline>
<codeline lineno="217"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>and<sp/>querying<sp/>in<sp/>the<sp/>archive.</highlight></codeline>
<codeline lineno="218"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="219"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="220"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>archive<sp/>(Archive):<sp/>The<sp/>archive<sp/>object<sp/>for<sp/>which<sp/>the<sp/>KDTree<sp/>will<sp/>be<sp/>set<sp/>up.</highlight></codeline>
<codeline lineno="221"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>centers<sp/>(Optional[np.ndarray]):<sp/>Coordinates<sp/>of<sp/>the<sp/>centers<sp/>to<sp/>construct<sp/></highlight></codeline>
<codeline lineno="222"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>KDTree.<sp/>If<sp/>`None`,<sp/>they<sp/>will<sp/>be<sp/>generated<sp/>automatically.</highlight></codeline>
<codeline lineno="223"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>niche_num<sp/>(Optional[int]):<sp/>The<sp/>number<sp/>of<sp/>niches<sp/>used<sp/>to<sp/>determine<sp/>the<sp/></highlight></codeline>
<codeline lineno="224"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>grid<sp/>of<sp/>centers<sp/>if<sp/>`centers`<sp/>is<sp/>not<sp/>provided.</highlight></codeline>
<codeline lineno="225"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qd_bounds<sp/>(Optional[Bounds]):<sp/>The<sp/>bounds<sp/>within<sp/>which<sp/>the<sp/>niches<sp/>lie.</highlight></codeline>
<codeline lineno="226"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>samples_per_niche<sp/>(Optional[int]):<sp/>The<sp/>number<sp/>of<sp/>sample<sp/>centers<sp/>per<sp/>niche<sp/></highlight></codeline>
<codeline lineno="227" refid="namespacefcmaes_1_1mapelites_1ace0194d76906adbf0c0dd3db084f177c" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>generate<sp/>when<sp/>`centers`<sp/>is<sp/>not<sp/>provided.<sp/>Defaults<sp/>to<sp/>100.</highlight></codeline>
<codeline lineno="228"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>centers<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:<sp/></highlight><highlight class="comment">#<sp/>cache<sp/>centers<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>centers<sp/>=<sp/><ref refid="namespacefcmaes_1_1mapelites_1a1cd72ab87d7aa999a255ad854895d3aa" kindref="member">get_centers_</ref>(niche_num,<sp/>len(qd_bounds.lb),<sp/>samples_per_niche)</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/>archive.kdt<sp/>=<sp/>KDTree(centers,<sp/>leaf_size=30,<sp/>metric=</highlight><highlight class="stringliteral">&apos;euclidean&apos;</highlight><highlight class="normal">)<sp/><sp/></highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/>archive.centers<sp/>=<sp/>centers<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="234"><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacefcmaes_1_1mapelites_1a9430b58efcd2bccef1537defe6b7e8db" kindref="member">load_archive</ref>(name:<sp/>str,<sp/></highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bounds:<sp/>Bounds,<sp/></highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qd_bounds:<sp/>Bounds,<sp/></highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>niche_num:<sp/>Optional[int]<sp/>=<sp/>10000,</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>use_stats:<sp/>Optional[bool]<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/>-&gt;<sp/>Archive:</highlight></codeline>
<codeline lineno="241"><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="243"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Loads<sp/>an<sp/>archive<sp/>based<sp/>on<sp/>the<sp/>provided<sp/>parameters.</highlight></codeline>
<codeline lineno="244"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="245"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>function<sp/>creates<sp/>and<sp/>configures<sp/>an<sp/>Archive<sp/>instance<sp/>using<sp/>the<sp/>specified</highlight></codeline>
<codeline lineno="246"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>parameters.<sp/>It<sp/>initializes<sp/>the<sp/>Archive<sp/>with<sp/>bounds,<sp/>QD<sp/>bounds,<sp/>niche<sp/>number,</highlight></codeline>
<codeline lineno="247"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>and<sp/>optional<sp/>usage<sp/>of<sp/>statistics.<sp/>After<sp/>initialization,<sp/>it<sp/>loads<sp/>the<sp/>archive</highlight></codeline>
<codeline lineno="248"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>data<sp/>from<sp/>the<sp/>provided<sp/>file<sp/>name.</highlight></codeline>
<codeline lineno="249"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="250"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="251"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>(str):<sp/>The<sp/>file<sp/>name<sp/>from<sp/>which<sp/>to<sp/>load<sp/>the<sp/>archive.</highlight></codeline>
<codeline lineno="252"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bounds<sp/>(Bounds):<sp/>The<sp/>lower<sp/>and<sp/>upper<sp/>bounds<sp/>for<sp/>the<sp/>archive&apos;s<sp/>dimensionality.</highlight></codeline>
<codeline lineno="253"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qd_bounds<sp/>(Bounds):<sp/>The<sp/>bounds<sp/>specific<sp/>to<sp/>the<sp/>QD<sp/>optimization<sp/>process.</highlight></codeline>
<codeline lineno="254"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>niche_num<sp/>(Optional[int]):<sp/>The<sp/>number<sp/>of<sp/>niches<sp/>in<sp/>the<sp/>archive.<sp/>Defaults<sp/>to<sp/>10000.</highlight></codeline>
<codeline lineno="255"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>use_stats<sp/>(Optional[bool]):<sp/>Flag<sp/>to<sp/>indicate<sp/>whether<sp/>statistics<sp/>should<sp/>be<sp/>used.</highlight></codeline>
<codeline lineno="256"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Defaults<sp/>to<sp/>False.</highlight></codeline>
<codeline lineno="257"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="258" refid="namespacefcmaes_1_1mapelites_1a9430b58efcd2bccef1537defe6b7e8db" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="259"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Archive:<sp/>An<sp/>Archive<sp/>instance<sp/>loaded<sp/>with<sp/>the<sp/>specified<sp/>configurations<sp/>and<sp/>data.</highlight></codeline>
<codeline lineno="260"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/>dim<sp/>=<sp/>len(bounds.lb)</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/>archive<sp/>=<sp/><ref refid="classfcmaes_1_1mapelites_1_1_archive" kindref="compound">Archive</ref>(dim,<sp/>qd_bounds,<sp/>niche_num,<sp/>name,<sp/>use_stats)</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/>archive.load(name)</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>archive</highlight></codeline>
<codeline lineno="266"><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacefcmaes_1_1mapelites_1ad2ec9edcc53986935aa2f2e1127d458d" kindref="member">optimize_map_elites_</ref>(archive,<sp/>fitness,<sp/>bounds,<sp/>workers,</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>me_params,<sp/>cma_params):</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="270"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Optimize<sp/>a<sp/>solution<sp/>using<sp/>Map-Elites<sp/>algorithm<sp/>via<sp/>multi-processing.</highlight></codeline>
<codeline lineno="271"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="272"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>function<sp/>orchestrates<sp/>the<sp/>execution<sp/>of<sp/>the<sp/>Map-Elites<sp/>optimization</highlight></codeline>
<codeline lineno="273"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>algorithm<sp/>over<sp/>multiple<sp/>processes.<sp/>Each<sp/>process<sp/>operates<sp/>independently<sp/>with<sp/>its</highlight></codeline>
<codeline lineno="274"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>own<sp/>random<sp/>generator<sp/>to<sp/>explore<sp/>the<sp/>solution<sp/>space.<sp/>It<sp/>uses<sp/>CMA-ES<sp/>to<sp/>update</highlight></codeline>
<codeline lineno="275"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>solutions<sp/>iteratively.<sp/>The<sp/>provided<sp/>parameters<sp/>configure<sp/>the<sp/>optimization</highlight></codeline>
<codeline lineno="276"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>behavior,<sp/>such<sp/>as<sp/>the<sp/>solution<sp/>archive,<sp/>fitness<sp/>evaluation<sp/>function,<sp/>search</highlight></codeline>
<codeline lineno="277"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>bounds,<sp/>and<sp/>process<sp/>settings<sp/>specific<sp/>to<sp/>Map-Elites<sp/>and<sp/>CMA-ES.</highlight></codeline>
<codeline lineno="278"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="279"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="280"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>archive:<sp/>A<sp/>data<sp/>structure<sp/>to<sp/>store<sp/>the<sp/>solutions<sp/>found<sp/>during<sp/>the<sp/></highlight></codeline>
<codeline lineno="281"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>optimization<sp/>process<sp/>and<sp/>their<sp/>corresponding<sp/>evaluation.<sp/></highlight></codeline>
<codeline lineno="282"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fitness:<sp/>A<sp/>callable<sp/>function<sp/>that<sp/>evaluates<sp/>the<sp/>quality<sp/>of<sp/>a<sp/>solution.<sp/></highlight></codeline>
<codeline lineno="283"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bounds:<sp/>A<sp/>sequence<sp/>of<sp/>tuples<sp/>defining<sp/>the<sp/>lower<sp/>and<sp/>upper<sp/>bounds<sp/>for</highlight></codeline>
<codeline lineno="284"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>each<sp/>decision<sp/>variable.</highlight></codeline>
<codeline lineno="285"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>workers:<sp/>An<sp/>integer<sp/>specifying<sp/>the<sp/>number<sp/>of<sp/>parallel<sp/>processes</highlight></codeline>
<codeline lineno="286"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>run<sp/>during<sp/>optimization.</highlight></codeline>
<codeline lineno="287"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>me_params:<sp/>A<sp/>dictionary<sp/>or<sp/>configuration<sp/>object<sp/>with<sp/>parameters</highlight></codeline>
<codeline lineno="288"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>the<sp/>Map-Elites<sp/>algorithm.</highlight></codeline>
<codeline lineno="289"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cma_params:<sp/>A<sp/>dictionary<sp/>or<sp/>configuration<sp/>object<sp/>with<sp/>parameters</highlight></codeline>
<codeline lineno="290"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>the<sp/>Covariance<sp/>Matrix<sp/>Adaptation<sp/>Evolution<sp/>Strategy<sp/>(CMA-ES).</highlight></codeline>
<codeline lineno="291"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/>sg<sp/>=<sp/>SeedSequence()</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/>rgs<sp/>=<sp/>[Generator(PCG64DXSM(s))<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>s<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>sg.spawn(workers)]</highlight></codeline>
<codeline lineno="294" refid="namespacefcmaes_1_1mapelites_1ad2ec9edcc53986935aa2f2e1127d458d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>proc=[Process(target=run_map_elites_,</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>args=(archive,<sp/>fitness,<sp/>bounds,<sp/>rgs[p],</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>me_params,<sp/>cma_params))<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>p<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(workers)]</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/>[p.start()<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>p<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>proc]</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/>[p.join()<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>p<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>proc]</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="300"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacefcmaes_1_1mapelites_1a04bcf57530df0bef091b00ceb8e9d44a" kindref="member">run_map_elites_</ref>(archive,<sp/>fitness,<sp/>bounds,<sp/>rg,<sp/></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>me_params,<sp/>cma_params):</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="303"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Runs<sp/>the<sp/>MAP-Elites<sp/>algorithm<sp/>with<sp/>optional<sp/>SBX<sp/>(Simulated<sp/>Binary<sp/>Crossover)<sp/>or<sp/></highlight></codeline>
<codeline lineno="304"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>iso+line<sp/>variation,<sp/>followed<sp/>by<sp/>CMA-ES<sp/>optimization.<sp/>The<sp/>algorithm<sp/>iteratively<sp/></highlight></codeline>
<codeline lineno="305"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>updates<sp/>the<sp/>archive<sp/>with<sp/>new<sp/>solutions,<sp/>balancing<sp/>exploration<sp/>and<sp/>exploitation<sp/></highlight></codeline>
<codeline lineno="306"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>over<sp/>the<sp/>specified<sp/>number<sp/>of<sp/>generations.</highlight></codeline>
<codeline lineno="307"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="308"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="309"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>archive:<sp/>An<sp/>archive<sp/>object<sp/>for<sp/>storing<sp/>solutions,<sp/>descriptors,<sp/>and<sp/>their<sp/></highlight></codeline>
<codeline lineno="310"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fitness<sp/>values,<sp/>supporting<sp/>niche<sp/>identification<sp/>and<sp/>updating<sp/>mechanisms.</highlight></codeline>
<codeline lineno="311"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fitness:<sp/>Callable<sp/>that<sp/>computes<sp/>the<sp/>fitness<sp/>and<sp/>descriptor<sp/>of<sp/>a<sp/>given<sp/>solution.</highlight></codeline>
<codeline lineno="312"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bounds:<sp/>Bounds<sp/>object<sp/>holding<sp/>the<sp/>lower<sp/>and<sp/>upper<sp/>bounds<sp/>for<sp/>the<sp/>solutions<sp/></highlight></codeline>
<codeline lineno="313"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>during<sp/>variation<sp/>and<sp/>optimization.</highlight></codeline>
<codeline lineno="314"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rg:<sp/>A<sp/>random<sp/>generator<sp/>instance<sp/>used<sp/>for<sp/>stochastic<sp/>operations<sp/>within<sp/>the<sp/></highlight></codeline>
<codeline lineno="315"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>algorithm.</highlight></codeline>
<codeline lineno="316"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>me_params:<sp/>Dictionary<sp/>containing<sp/>tunable<sp/>MAP-Elites<sp/>parameters<sp/>with<sp/>keys<sp/></highlight></codeline>
<codeline lineno="317"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>such<sp/>as<sp/>&apos;generations&apos;,<sp/>&apos;chunk_size&apos;,<sp/>&apos;use_sbx&apos;,<sp/>&apos;dis_c&apos;,<sp/>&apos;dis_m&apos;,<sp/></highlight></codeline>
<codeline lineno="318"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;iso_sigma&apos;,<sp/>and<sp/>&apos;line_sigma&apos;.</highlight></codeline>
<codeline lineno="319"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cma_params:<sp/>Dictionary<sp/>containing<sp/>CMA-ES-specific<sp/>parameters<sp/>such<sp/>as<sp/></highlight></codeline>
<codeline lineno="320"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;cma_generations&apos;.</highlight></codeline>
<codeline lineno="321"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="322"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/>generations<sp/>=<sp/>me_params.get(</highlight><highlight class="stringliteral">&apos;generations&apos;</highlight><highlight class="normal">,<sp/>10)<sp/></highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/>chunk_size<sp/>=<sp/>me_params.get(</highlight><highlight class="stringliteral">&apos;chunk_size&apos;</highlight><highlight class="normal">,<sp/>20)<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="325" refid="namespacefcmaes_1_1mapelites_1a04bcf57530df0bef091b00ceb8e9d44a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>use_sbx<sp/>=<sp/>me_params.get(</highlight><highlight class="stringliteral">&apos;use_sbx&apos;</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal">)<sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/>dis_c<sp/>=<sp/>me_params.get(</highlight><highlight class="stringliteral">&apos;dis_c&apos;</highlight><highlight class="normal">,<sp/>20)<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/>dis_m<sp/>=<sp/>me_params.get(</highlight><highlight class="stringliteral">&apos;dis_m&apos;</highlight><highlight class="normal">,<sp/>20)<sp/><sp/></highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/>iso_sigma<sp/>=<sp/>me_params.get(</highlight><highlight class="stringliteral">&apos;iso_sigma&apos;</highlight><highlight class="normal">,<sp/>0.02)</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/>line_sigma<sp/>=<sp/>me_params.get(</highlight><highlight class="stringliteral">&apos;line_sigma&apos;</highlight><highlight class="normal">,<sp/>0.2)</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/>cma_generations<sp/>=<sp/>cma_params.get(</highlight><highlight class="stringliteral">&apos;cma_generations&apos;</highlight><highlight class="normal">,<sp/>20)</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/>select_n<sp/>=<sp/>archive.capacity</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">with</highlight><highlight class="normal"><sp/>threadpoolctl.threadpool_limits(limits=1,<sp/>user_api=</highlight><highlight class="stringliteral">&quot;blas&quot;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>_<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(generations):<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>use_sbx:</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pop<sp/>=<sp/>archive.random_xs(select_n,<sp/>chunk_size,<sp/>rg)</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xs<sp/>=<sp/><ref refid="namespacefcmaes_1_1mapelites_1a5f70b23800f6a77b08d918f5aa0f9b3d" kindref="member">variation_</ref>(pop,<sp/>bounds.lb,<sp/>bounds.ub,<sp/>rg,<sp/>dis_c,<sp/>dis_m)</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x1<sp/>=<sp/>archive.random_xs(select_n,<sp/>chunk_size,<sp/>rg)</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x2<sp/>=<sp/>archive.random_xs(select_n,<sp/>chunk_size,<sp/>rg)</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xs<sp/>=<sp/><ref refid="namespacefcmaes_1_1mapelites_1aa557fd895bcaf40f495273ef16953c11" kindref="member">iso_dd_</ref>(x1,<sp/>x2,<sp/>bounds.lb,<sp/>bounds.ub,<sp/>rg,<sp/>iso_sigma,<sp/>line_sigma)<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yds<sp/>=<sp/>[fitness(x)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>x<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>xs]</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>descs<sp/>=<sp/>np.array([yd[1]<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>yd<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>yds])</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>niches<sp/>=<sp/>archive.index_of_niches(descs)</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(len(yds)):</highlight></codeline>
<codeline lineno="345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>archive.set(niches[i],<sp/>yds[i],<sp/>xs[i])<sp/></highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>archive.argsort()<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>select_n<sp/>=<sp/>archive.get_occupied()<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>_<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(cma_generations):<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacefcmaes_1_1mapelites_1addca945e57b8fc097ca552903b98187f" kindref="member">optimize_cma_</ref>(archive,<sp/>fitness,<sp/>bounds,<sp/>rg,<sp/>cma_params)<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="351"><highlight class="normal"></highlight></codeline>
<codeline lineno="352"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacefcmaes_1_1mapelites_1addca945e57b8fc097ca552903b98187f" kindref="member">optimize_cma_</ref>(archive,<sp/>fitness,<sp/>bounds,<sp/>rg,<sp/>cma_params):</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="354"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Optimizes<sp/>a<sp/>solution<sp/>using<sp/>the<sp/>Covariance<sp/>Matrix<sp/>Adaptation<sp/>Evolution<sp/>Strategy<sp/>(CMA-ES).</highlight></codeline>
<codeline lineno="355"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>function<sp/>utilizes<sp/>the<sp/>process<sp/>of<sp/>evolutionary<sp/>optimization<sp/>based<sp/>on<sp/>objective<sp/>fitness,</highlight></codeline>
<codeline lineno="356"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>adaptive<sp/>step<sp/>size,<sp/>and<sp/>population-based<sp/>approach.<sp/>It<sp/>leverages<sp/>a<sp/>provided<sp/>archive<sp/>to<sp/></highlight></codeline>
<codeline lineno="357"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>introduce<sp/>variations<sp/>in<sp/>the<sp/>space<sp/>of<sp/>potential<sp/>solutions.</highlight></codeline>
<codeline lineno="358"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="359"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="360"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>archive:<sp/>An<sp/>instance<sp/>of<sp/>a<sp/>solution<sp/>archive<sp/>storing<sp/>previously<sp/>evaluated<sp/>solutions<sp/>and</highlight></codeline>
<codeline lineno="361"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assisting<sp/>in<sp/>generating<sp/>new<sp/>candidate<sp/>solutions.</highlight></codeline>
<codeline lineno="362"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fitness:<sp/>A<sp/>callable<sp/>fitness<sp/>function<sp/>to<sp/>evaluate<sp/>the<sp/>quality<sp/>of<sp/>solutions.</highlight></codeline>
<codeline lineno="363"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bounds:<sp/>The<sp/>bounds<sp/>or<sp/>constraints<sp/>of<sp/>the<sp/>solution<sp/>space<sp/>to<sp/>limit<sp/>candidate<sp/>solutions.</highlight></codeline>
<codeline lineno="364"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rg:<sp/>A<sp/>random<sp/>generator<sp/>instance<sp/>used<sp/>to<sp/>introduce<sp/>stochasticity<sp/>in<sp/>optimization<sp/>steps.</highlight></codeline>
<codeline lineno="365"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cma_params:<sp/>A<sp/>dictionary<sp/>containing<sp/>configuration<sp/>parameters<sp/>for<sp/>the<sp/>CMA-ES<sp/>optimizer,</highlight></codeline>
<codeline lineno="366"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>such<sp/>as<sp/>population<sp/>size,<sp/>sigma<sp/>(step<sp/>size),<sp/>maximum<sp/>iterations,<sp/>and<sp/>other<sp/>hyperparameters.</highlight></codeline>
<codeline lineno="367"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="368"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Raises:</highlight></codeline>
<codeline lineno="369"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ValueError:<sp/>If<sp/>parameters<sp/>in<sp/>cma_params<sp/>are<sp/>invalid<sp/>(e.g.,<sp/>negative<sp/>population<sp/>size).</highlight></codeline>
<codeline lineno="370"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/>select_n<sp/>=<sp/>cma_params.get(</highlight><highlight class="stringliteral">&apos;best_n&apos;</highlight><highlight class="normal">,<sp/>100)</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/>x0,<sp/>y,<sp/>iter<sp/>=<sp/>archive.random_xs_one(select_n,<sp/>rg)</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/>sigma<sp/>=<sp/>cma_params.get(</highlight><highlight class="stringliteral">&apos;sigma&apos;</highlight><highlight class="normal">,rg.uniform(0.03,<sp/>0.3)**2)</highlight></codeline>
<codeline lineno="374" refid="namespacefcmaes_1_1mapelites_1addca945e57b8fc097ca552903b98187f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>popsize<sp/>=<sp/>cma_params.get(</highlight><highlight class="stringliteral">&apos;popsize&apos;</highlight><highlight class="normal">,<sp/>31)<sp/></highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/>es<sp/>=<sp/><ref refid="classfcmaes_1_1cmaescpp_1_1_a_c_m_a___c" kindref="compound">cmaescpp.ACMA_C</ref>(archive.dim,<sp/>bounds,<sp/>x0<sp/>=<sp/>x0,<sp/><sp/></highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>popsize<sp/>=<sp/>popsize,<sp/>input_sigma<sp/>=<sp/>sigma,<sp/>rg<sp/>=<sp/>rg)</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/>maxiters<sp/>=<sp/>cma_params.get(</highlight><highlight class="stringliteral">&apos;maxiters&apos;</highlight><highlight class="normal">,<sp/>100)</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/>stall_criterion<sp/>=<sp/>cma_params.get(</highlight><highlight class="stringliteral">&apos;stall_criterion&apos;</highlight><highlight class="normal">,<sp/>5)</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/>old_ys<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/>last_improve<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>iter<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(maxiters):</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xs<sp/>=<sp/>es.ask()</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>improvement,<sp/>ys<sp/>=<sp/><ref refid="namespacefcmaes_1_1mapelites_1a86f7f0503dc82b70b87a882b49a95f23" kindref="member">update_archive</ref>(archive,<sp/>xs,<sp/>fitness)</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>iter<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(np.sort(ys)<sp/>&lt;<sp/>old_ys).any():</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>last_improve<sp/>=<sp/>iter<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>last_improve<sp/>+<sp/>stall_criterion<sp/>&lt;<sp/>iter:</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>no<sp/>improvement</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>es.tell(improvement)<sp/>!=<sp/>0:</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>old_ys<sp/>=<sp/>np.sort(ys)</highlight></codeline>
<codeline lineno="393"><highlight class="normal"></highlight></codeline>
<codeline lineno="394"><highlight class="normal"></highlight><highlight class="preprocessor">@np.errstate(invalid=&apos;ignore&apos;)</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="395"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacefcmaes_1_1mapelites_1a86f7f0503dc82b70b87a882b49a95f23" kindref="member">update_archive</ref>(archive:<sp/>Archive,<sp/>xs:<sp/>np.ndarray,<sp/></highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fitness:<sp/>Optional[Callable[[ArrayLike],<sp/>Tuple[float,<sp/>np.ndarray]]]<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yds:<sp/>Optional[ArrayLike]<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="399"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Evaluates<sp/>a<sp/>population,<sp/>updates<sp/>the<sp/>archive<sp/>with<sp/>new<sp/>solutions,<sp/>and<sp/>determines<sp/>rankings.</highlight></codeline>
<codeline lineno="400"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="401"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>function<sp/>processes<sp/>a<sp/>set<sp/>of<sp/>solutions<sp/>and<sp/>their<sp/>associated<sp/>descriptions<sp/>or<sp/>fitness</highlight></codeline>
<codeline lineno="402"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>evaluations.<sp/>The<sp/>solutions<sp/>are<sp/>compared<sp/>against<sp/>an<sp/>archive<sp/>to<sp/>determine<sp/>and<sp/>store<sp/>better</highlight></codeline>
<codeline lineno="403"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>solutions.<sp/>It<sp/>prioritizes<sp/>updates<sp/>to<sp/>empty<sp/>niches<sp/>in<sp/>the<sp/>archive<sp/>and<sp/>normalizes<sp/>improvements</highlight></codeline>
<codeline lineno="404"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>for<sp/>comparisons.<sp/>The<sp/>function<sp/>finally<sp/>returns<sp/>the<sp/>improvement<sp/>values<sp/>and<sp/>the<sp/>real<sp/>fitness</highlight></codeline>
<codeline lineno="405"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>values<sp/>for<sp/>the<sp/>solutions.</highlight></codeline>
<codeline lineno="406"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="407"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="408"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>archive<sp/>(Archive):<sp/>The<sp/>archive<sp/>object<sp/>where<sp/>solutions<sp/>and<sp/>corresponding<sp/>fitness<sp/>data<sp/>are<sp/>stored.</highlight></codeline>
<codeline lineno="409"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xs<sp/>(np.ndarray):<sp/>A<sp/>set<sp/>of<sp/>solutions<sp/>to<sp/>be<sp/>evaluated<sp/>and<sp/>compared<sp/>against<sp/>the<sp/>archive.</highlight></codeline>
<codeline lineno="410"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fitness<sp/>(Optional[Callable[[ArrayLike],<sp/>Tuple[float,<sp/>np.ndarray]]]):<sp/></highlight></codeline>
<codeline lineno="411"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>A<sp/>callable<sp/>function<sp/>that<sp/>evaluates<sp/>a<sp/>solution<sp/>and<sp/>returns<sp/>its<sp/>fitness<sp/>value<sp/>and<sp/>description.</highlight></codeline>
<codeline lineno="412"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yds<sp/>(Optional[ArrayLike]):<sp/>Precomputed<sp/>fitness<sp/>values<sp/>and<sp/>descriptions,<sp/>if<sp/>available.</highlight></codeline>
<codeline lineno="413"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="414"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="415"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Tuple[np.ndarray,<sp/>np.ndarray]:<sp/>A<sp/>tuple<sp/>containing:</highlight></codeline>
<codeline lineno="416"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Improvement<sp/>values<sp/>compared<sp/>to<sp/>archive<sp/>elite<sp/>solutions.</highlight></codeline>
<codeline lineno="417"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>The<sp/>real<sp/>fitness<sp/>values<sp/>evaluated<sp/>for<sp/>the<sp/>given<sp/>solutions.</highlight></codeline>
<codeline lineno="418"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="419"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Raises:</highlight></codeline>
<codeline lineno="420"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ValueError:<sp/>If<sp/>`ys`<sp/>or<sp/>`yds`<sp/>contain<sp/>invalid<sp/>or<sp/>mismatched<sp/>content.</highlight></codeline>
<codeline lineno="421"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>evaluate<sp/>population,<sp/>update<sp/>archive<sp/>and<sp/>determine<sp/>ranking</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="423" refid="namespacefcmaes_1_1mapelites_1a86f7f0503dc82b70b87a882b49a95f23" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>popsize<sp/>=<sp/>len(xs)</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>yds<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:<sp/></highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yds<sp/>=<sp/>[fitness(x)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>x<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>xs]</highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/>descs<sp/>=<sp/>np.array([yd[1]<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>yd<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>yds])</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/>niches<sp/>=<sp/>archive.index_of_niches(descs)</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>real<sp/>values</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/>ys<sp/>=<sp/>np.fromiter((yd[0]<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>yd<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>yds),<sp/>dtype=float)</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/>oldys<sp/>=<sp/>np.fromiter((archive.get_y(niches[i])<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(popsize)),<sp/>dtype=float)</highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/>improvement<sp/>=<sp/>ys<sp/>-<sp/>oldys</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/>neg<sp/>=<sp/>np.argwhere(improvement<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(neg)<sp/>&gt;<sp/>0:</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>neg<sp/>=<sp/>neg.reshape((len(neg)))</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>update<sp/>archive<sp/>for<sp/>all<sp/>real<sp/>improvements</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>neg:</highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>archive.set(niches[i],<sp/>yds[i],<sp/>xs[i])</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>prioritize<sp/>empty<sp/>niches</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>empty<sp/>=<sp/>(improvement<sp/>==<sp/>-np.inf)<sp/></highlight><highlight class="comment">#<sp/>these<sp/>need<sp/>to<sp/>be<sp/>sorted<sp/>according<sp/>to<sp/>fitness</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>occupied<sp/>=<sp/>np.logical_not(empty)</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_valid<sp/>=<sp/>np.amin(improvement[occupied])<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>sum(occupied)<sp/>&gt;<sp/>0<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>0</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>norm_ys<sp/>=<sp/>ys[empty]<sp/>-<sp/>np.amax(ys)<sp/>-<sp/>1E-9</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>improvement[empty]<sp/>=<sp/>min_valid<sp/>+<sp/>norm_ys</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>return<sp/>both<sp/>improvement<sp/>compared<sp/>to<sp/>archive<sp/>elites<sp/><sp/>and<sp/>real<sp/>fitness</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>improvement,<sp/>ys</highlight></codeline>
<codeline lineno="446"><highlight class="normal"></highlight></codeline>
<codeline lineno="447"><highlight class="normal"></highlight><highlight class="preprocessor">@njit()</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="448"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacefcmaes_1_1mapelites_1a5c3c74816cffd5997c0f9e897205abc8" kindref="member">get_grid_indices</ref>(ds,<sp/>capacity,<sp/>lb,<sp/>ub):</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="450"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Computes<sp/>and<sp/>returns<sp/>grid<sp/>indices<sp/>for<sp/>a<sp/>dataset<sp/>based<sp/>on<sp/>the<sp/>provided<sp/>grid</highlight></codeline>
<codeline lineno="451"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>capacity,<sp/>lower,<sp/>and<sp/>upper<sp/>bounds.<sp/>Each<sp/>point<sp/>in<sp/>the<sp/>dataset<sp/>is<sp/>normalized</highlight></codeline>
<codeline lineno="452"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>and<sp/>then<sp/>converted<sp/>into<sp/>a<sp/>grid<sp/>index<sp/>using<sp/>the<sp/>specified<sp/>parameters.</highlight></codeline>
<codeline lineno="453"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="454"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="455"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ds<sp/>(np.ndarray):<sp/>Input<sp/>dataset<sp/>(2D<sp/>numpy<sp/>array)<sp/>where<sp/>each<sp/>row<sp/>is<sp/>a<sp/>point</highlight></codeline>
<codeline lineno="456"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>in<sp/>a<sp/>multi-dimensional<sp/>space.</highlight></codeline>
<codeline lineno="457"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>capacity<sp/>(int):<sp/>Total<sp/>number<sp/>of<sp/>grid<sp/>cells<sp/>(capacity<sp/>of<sp/>the<sp/>grid).</highlight></codeline>
<codeline lineno="458"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lb<sp/>(np.ndarray):<sp/>Lower<sp/>bounds<sp/>of<sp/>the<sp/>dataset<sp/>in<sp/>each<sp/>dimension.</highlight></codeline>
<codeline lineno="459"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ub<sp/>(np.ndarray):<sp/>Upper<sp/>bounds<sp/>of<sp/>the<sp/>dataset<sp/>in<sp/>each<sp/>dimension.</highlight></codeline>
<codeline lineno="460"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="461"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="462"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.ndarray:<sp/>An<sp/>array<sp/>of<sp/>grid<sp/>indices,<sp/>where<sp/>each<sp/>index<sp/>corresponds<sp/>to<sp/>a</highlight></codeline>
<codeline lineno="463"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>point<sp/>in<sp/>the<sp/>input<sp/>dataset.</highlight></codeline>
<codeline lineno="464"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="465"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/>rdim<sp/>=<sp/>int(capacity<sp/>**<sp/>(1/ds.shape[1])<sp/>+<sp/>0.5)</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/>ds_norm<sp/>=<sp/>(ds<sp/>-<sp/>lb)<sp/>/<sp/>(ub<sp/>-<sp/>lb)</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/>indices<sp/>=<sp/>np.empty(len(ds),<sp/>dtype=np.int32)<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="469" refid="namespacefcmaes_1_1mapelites_1a5c3c74816cffd5997c0f9e897205abc8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i,<sp/>d<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>enumerate(ds_norm):</highlight></codeline>
<codeline lineno="470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>di<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>d:</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index<sp/>+=<sp/>f<sp/>*<sp/>int(rdim*di)</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>*=<sp/>rdim</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>indices[i]<sp/>=<sp/>max(0,<sp/>min(capacity-1,<sp/>int(index)))<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>indices</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="478"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive" kindref="compound">Archive</ref>(object):</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Handles<sp/>the<sp/>storage,<sp/>organization,<sp/>and<sp/>management<sp/>of<sp/>solutions<sp/>in<sp/>a<sp/></highlight></codeline>
<codeline lineno="480"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>multi-dimensional<sp/>archive<sp/>for<sp/>Quality-Diversity<sp/>optimization.</highlight></codeline>
<codeline lineno="481"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="482"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>The<sp/>Archive<sp/>class<sp/>allows<sp/>for<sp/>storing<sp/>solutions<sp/>with<sp/>associated<sp/>features<sp/></highlight></codeline>
<codeline lineno="483"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>and<sp/>fitness<sp/>values,<sp/>clustering<sp/>them<sp/>into<sp/>niches,<sp/>and<sp/>updating<sp/>the<sp/>archive<sp/></highlight></codeline>
<codeline lineno="484"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>based<sp/>on<sp/>improvements<sp/>to<sp/>the<sp/>corresponding<sp/>niches.<sp/>The<sp/>class<sp/>also<sp/></highlight></codeline>
<codeline lineno="485"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>provides<sp/>methods<sp/>to<sp/>retrieve<sp/>statistical<sp/>data<sp/>on<sp/>stored<sp/>solutions<sp/>as<sp/></highlight></codeline>
<codeline lineno="486"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>well<sp/>as<sp/>mechanisms<sp/>for<sp/>saving/loading<sp/>the<sp/>archive<sp/>state.</highlight></codeline>
<codeline lineno="487"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="488"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Attributes:</highlight></codeline>
<codeline lineno="489"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dim<sp/>(int):<sp/>Dimensionality<sp/>of<sp/>the<sp/>solution<sp/>vectors.</highlight></codeline>
<codeline lineno="490"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qd_dim<sp/>(int):<sp/>Dimensionality<sp/>of<sp/>the<sp/>quality-diversity<sp/>descriptors.</highlight></codeline>
<codeline lineno="491"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qd_bounds<sp/>(Bounds):<sp/>Bounds<sp/>for<sp/>the<sp/>quality-diversity<sp/>descriptors.</highlight></codeline>
<codeline lineno="492"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desc_lb<sp/>(ndarray):<sp/>Lower<sp/>bounds<sp/>for<sp/>the<sp/>descriptors.</highlight></codeline>
<codeline lineno="493"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>desc_scale<sp/>(ndarray):<sp/>Scale<sp/>of<sp/>the<sp/>descriptor<sp/>bounds,<sp/>calculated<sp/>as<sp/></highlight></codeline>
<codeline lineno="494" refid="classfcmaes_1_1mapelites_1_1_archive" refkind="compound"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>difference<sp/>between<sp/>upper<sp/>and<sp/>lower<sp/>bounds.</highlight></codeline>
<codeline lineno="495"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>capacity<sp/>(int):<sp/>Maximum<sp/>capacity<sp/>of<sp/>the<sp/>archive<sp/>in<sp/>terms<sp/>of<sp/>number<sp/></highlight></codeline>
<codeline lineno="496"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>of<sp/>solutions<sp/>that<sp/>can<sp/>be<sp/>stored.</highlight></codeline>
<codeline lineno="497"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>(Optional[str]):<sp/>Optional<sp/>name<sp/>for<sp/>the<sp/>archive.</highlight></codeline>
<codeline lineno="498"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>use_stats<sp/>(bool):<sp/>Flag<sp/>to<sp/>determine<sp/>if<sp/>solution<sp/>statistics<sp/>such<sp/>as<sp/></highlight></codeline>
<codeline lineno="499"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mean,<sp/>standard<sp/>deviation,<sp/>min,<sp/>max,<sp/>etc.,<sp/>should<sp/>be<sp/>collected.</highlight></codeline>
<codeline lineno="500"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1ae996ab317d60b697d3c339df9335a60f" kindref="member">__init__</ref>(self,<sp/></highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dim:<sp/>int,</highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qd_bounds:<sp/>Bounds,</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>capacity:<sp/>int,<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name:<sp/>Optional[str]<sp/>=<sp/></highlight><highlight class="stringliteral">&quot;&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>use_stats<sp/>=<sp/></highlight><highlight class="keyword">False</highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>):</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="510"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Initializes<sp/>an<sp/>instance<sp/>of<sp/>the<sp/>class<sp/>with<sp/>specified<sp/>parameters.</highlight></codeline>
<codeline lineno="511"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="512"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="513"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dim<sp/>(int):<sp/>Dimensionality<sp/>of<sp/>the<sp/>data<sp/>to<sp/>be<sp/>handled.</highlight></codeline>
<codeline lineno="514"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qd_bounds<sp/>(Bounds):<sp/>An<sp/>object<sp/>representing<sp/>the<sp/>lower<sp/>and<sp/>upper<sp/>bounds<sp/></highlight></codeline>
<codeline lineno="515"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>the<sp/>QD<sp/>space.</highlight></codeline>
<codeline lineno="516"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>capacity<sp/>(int):<sp/>Maximum<sp/>capacity<sp/>or<sp/>size<sp/>to<sp/>store<sp/>elements.</highlight></codeline>
<codeline lineno="517"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>(Optional[str]):<sp/>Optional<sp/>string<sp/>name<sp/>identifier<sp/>for<sp/>the<sp/>instance.<sp/></highlight></codeline>
<codeline lineno="518"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Defaults<sp/>to<sp/>an<sp/>empty<sp/>string.</highlight></codeline>
<codeline lineno="519"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>use_stats<sp/>(bool):<sp/>Indicates<sp/>whether<sp/>to<sp/>use<sp/>statistics<sp/>in<sp/>computations<sp/>or<sp/></highlight></codeline>
<codeline lineno="520"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>operations.<sp/>Defaults<sp/>to<sp/>False.</highlight></codeline>
<codeline lineno="521"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab255103df42bedc30ec7132cfc618122" kindref="member">dim</ref><sp/>=<sp/>dim</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a7321ff2715dbc2d3258e2e880d48ef43" kindref="member">qd_dim</ref><sp/>=<sp/>len(qd_bounds.lb)</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1aaf23b4a84332dd3988c05887f896bdb3" kindref="member">qd_bounds</ref><sp/>=<sp/>Bounds(np.array(qd_bounds.lb),<sp/>np.array(qd_bounds.ub))</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1acef7919c3b7f9798628857f25de27d3c" kindref="member">desc_lb</ref><sp/>=<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1aaf23b4a84332dd3988c05887f896bdb3" kindref="member">qd_bounds</ref>.lb</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ae3f63fce62db86da46ee146bf27293c3" kindref="member">desc_scale</ref><sp/>=<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1aaf23b4a84332dd3988c05887f896bdb3" kindref="member">qd_bounds</ref>.ub<sp/>-<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1aaf23b4a84332dd3988c05887f896bdb3" kindref="member">qd_bounds</ref>.lb</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a543edcd72de56099d1f83c9dcd79e082" kindref="member">capacity</ref><sp/>=<sp/>capacity</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a41d911980a52f7f5c409af9b3a258124" kindref="member">name</ref><sp/>=<sp/>name</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a2421ccea4dec3cbb9bef589d1a3209f9" kindref="member">cs</ref><sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1abbcf8dde9401f4b34d4669a064e12373" kindref="member">lock</ref><sp/>=<sp/>mp.Lock()</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a1d6bb3c3d671d59cd6c48cc30574652d" kindref="member">use_stats</ref><sp/>=<sp/>use_stats</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1adae25149d74e878d190a51a3075af9bc" kindref="member">reset</ref>()</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1adae25149d74e878d190a51a3075af9bc" kindref="member">reset</ref>(self):</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="536"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Resets<sp/>the<sp/>internal<sp/>state<sp/>of<sp/>the<sp/>object<sp/>to<sp/>its<sp/>initial<sp/>configuration<sp/>by<sp/>reinitializing<sp/>its<sp/>shared</highlight></codeline>
<codeline lineno="537" refid="classfcmaes_1_1mapelites_1_1_archive_1ae996ab317d60b697d3c339df9335a60f" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>data<sp/>structures<sp/>and<sp/>clearing<sp/>any<sp/>stored<sp/>values.<sp/>This<sp/>allows<sp/>the<sp/>object<sp/>to<sp/>reuse<sp/>storage<sp/>and<sp/></highlight></codeline>
<codeline lineno="538"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>resources<sp/>effectively.</highlight></codeline>
<codeline lineno="539"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="540"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Attributes:</highlight></codeline>
<codeline lineno="541"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xs<sp/>(Shared2d):<sp/>A<sp/>2D<sp/>shared<sp/>array<sp/>initialized<sp/>with<sp/>an<sp/>empty<sp/>array<sp/>of<sp/>shape<sp/>`(capacity,<sp/>dim)`</highlight></codeline>
<codeline lineno="542"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>and<sp/>data<sp/>type<sp/>`np.float64`.<sp/>Represents<sp/>the<sp/>primary<sp/>2D<sp/>data<sp/>storage.</highlight></codeline>
<codeline lineno="543"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ds<sp/>(Shared2d):<sp/>A<sp/>2D<sp/>shared<sp/>array<sp/>initialized<sp/>with<sp/>an<sp/>empty<sp/>array<sp/>of<sp/>shape<sp/>`(capacity,<sp/>qd_dim)`</highlight></codeline>
<codeline lineno="544" refid="classfcmaes_1_1mapelites_1_1_archive_1ab255103df42bedc30ec7132cfc618122" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>and<sp/>data<sp/>type<sp/>`np.float64`.<sp/>Represents<sp/>supplementary<sp/>2D<sp/>data<sp/>storage.</highlight></codeline>
<codeline lineno="545" refid="classfcmaes_1_1mapelites_1_1_archive_1a7321ff2715dbc2d3258e2e880d48ef43" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ys<sp/>(mp.RawArray):<sp/>A<sp/>1D<sp/>shared<sp/>array<sp/>initialized<sp/>to<sp/>hold<sp/>float<sp/>values,<sp/>representing<sp/></highlight></codeline>
<codeline lineno="546" refid="classfcmaes_1_1mapelites_1_1_archive_1aaf23b4a84332dd3988c05887f896bdb3" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>additional<sp/>numeric<sp/>data.</highlight></codeline>
<codeline lineno="547" refid="classfcmaes_1_1mapelites_1_1_archive_1acef7919c3b7f9798628857f25de27d3c" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>counts<sp/>(mp.RawArray):<sp/>A<sp/>1D<sp/>shared<sp/>array<sp/>initialized<sp/>to<sp/>hold<sp/>integer<sp/>long<sp/>values,<sp/>used<sp/></highlight></codeline>
<codeline lineno="548" refid="classfcmaes_1_1mapelites_1_1_archive_1ae3f63fce62db86da46ee146bf27293c3" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>maintain<sp/>counts<sp/>for<sp/>each<sp/>capacity<sp/>slot.</highlight></codeline>
<codeline lineno="549" refid="classfcmaes_1_1mapelites_1_1_archive_1a543edcd72de56099d1f83c9dcd79e082" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>occupied<sp/>(mp.RawValue):<sp/>A<sp/>shared<sp/>value<sp/>for<sp/>tracking<sp/>the<sp/>count<sp/>of<sp/>currently<sp/>occupied<sp/></highlight></codeline>
<codeline lineno="550" refid="classfcmaes_1_1mapelites_1_1_archive_1a41d911980a52f7f5c409af9b3a258124" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>slots<sp/>in<sp/>the<sp/>storage.</highlight></codeline>
<codeline lineno="551" refid="classfcmaes_1_1mapelites_1_1_archive_1a2421ccea4dec3cbb9bef589d1a3209f9" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stats<sp/>(mp.RawArray):<sp/>An<sp/>optional<sp/>shared<sp/>array<sp/>for<sp/>maintaining<sp/>statistical<sp/>records.<sp/></highlight></codeline>
<codeline lineno="552" refid="classfcmaes_1_1mapelites_1_1_archive_1abbcf8dde9401f4b34d4669a064e12373" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Its<sp/>size<sp/>depends<sp/>on<sp/>the<sp/>combination<sp/>of<sp/>`capacity`,<sp/>`dim`,<sp/>and<sp/>the<sp/>`use_stats`<sp/>flag.</highlight></codeline>
<codeline lineno="553" refid="classfcmaes_1_1mapelites_1_1_archive_1a1d6bb3c3d671d59cd6c48cc30574652d" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>When<sp/>`use_stats`<sp/>is<sp/>False,<sp/>it<sp/>is<sp/>initialized<sp/>with<sp/>size<sp/>`0`.</highlight></codeline>
<codeline lineno="554"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="555"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Raises:</highlight></codeline>
<codeline lineno="556"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ValueError:<sp/>Raised<sp/>if<sp/>any<sp/>invalid<sp/>or<sp/>unexpected<sp/>conditions<sp/>arise<sp/>during<sp/>the<sp/>reset<sp/>operation,</highlight></codeline>
<codeline lineno="557"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>such<sp/>as<sp/>capacity<sp/>mismatch,<sp/>invalid<sp/>dimensions,<sp/>or<sp/>unavailable<sp/>memory<sp/>for<sp/>shared<sp/>arrays.</highlight></codeline>
<codeline lineno="558"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a55043a25e987ca5ad6f1cfaf22c835a2" kindref="member">xs</ref><sp/>=<sp/><ref refid="classfcmaes_1_1retry_1_1_shared2d" kindref="compound">Shared2d</ref>(np.empty((self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a543edcd72de56099d1f83c9dcd79e082" kindref="member">capacity</ref>,<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab255103df42bedc30ec7132cfc618122" kindref="member">dim</ref>),<sp/>dtype<sp/>=<sp/>np.float64))</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a60f70e50d917a1db752b0a0124a8e756" kindref="member">ds</ref><sp/>=<sp/><ref refid="classfcmaes_1_1retry_1_1_shared2d" kindref="compound">Shared2d</ref>(np.empty((self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a543edcd72de56099d1f83c9dcd79e082" kindref="member">capacity</ref>,<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a7321ff2715dbc2d3258e2e880d48ef43" kindref="member">qd_dim</ref>),<sp/>dtype<sp/>=<sp/>np.float64))</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a3976d13396ea59523d79e16b7d96f448" kindref="member">create_views</ref>()</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1acb4c09718b6457bb5bfbb7f3773f7178" kindref="member">ys</ref><sp/>=<sp/>mp.RawArray(ct.c_double,<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a543edcd72de56099d1f83c9dcd79e082" kindref="member">capacity</ref>)</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a17848162fe39d036fbc93aa58cc77b50" kindref="member">counts</ref><sp/>=<sp/>mp.RawArray(ct.c_long,<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a543edcd72de56099d1f83c9dcd79e082" kindref="member">capacity</ref>)<sp/></highlight><highlight class="comment">#<sp/>count</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab1c9fa575d5a8225ba10e8a40fd0d59b" kindref="member">occupied</ref><sp/>=<sp/>mp.RawValue(ct.c_long,<sp/>0)</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ada2a26ca8d9683a969403f104a759c61" kindref="member">stats</ref><sp/>=<sp/>mp.RawArray(ct.c_double,<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a543edcd72de56099d1f83c9dcd79e082" kindref="member">capacity</ref><sp/>*<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab255103df42bedc30ec7132cfc618122" kindref="member">dim</ref><sp/>*<sp/>4<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a1d6bb3c3d671d59cd6c48cc30574652d" kindref="member">use_stats</ref><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>0)</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a543edcd72de56099d1f83c9dcd79e082" kindref="member">capacity</ref>):</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a17848162fe39d036fbc93aa58cc77b50" kindref="member">counts</ref>[i]<sp/>=<sp/>0</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1afc25798d5b07a1addd68fc50cec1f3e5" kindref="member">set_y</ref>(i,<sp/>np.inf)<sp/><sp/></highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1aba20d5a20cc178e6aa4f14538b54334f" kindref="member">ds_view</ref>[i]<sp/>=<sp/>np.full(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a7321ff2715dbc2d3258e2e880d48ef43" kindref="member">qd_dim</ref>,<sp/>np.inf)</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ada2a26ca8d9683a969403f104a759c61" kindref="member">stats</ref>:</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a574aed6e61fc20fb94b479cb8fd5fc55" kindref="member">set_stat</ref>(i,<sp/>0,<sp/>np.zeros(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab255103df42bedc30ec7132cfc618122" kindref="member">dim</ref>))<sp/></highlight><highlight class="comment">#<sp/>mean</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a574aed6e61fc20fb94b479cb8fd5fc55" kindref="member">set_stat</ref>(i,<sp/>1,<sp/>np.zeros(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab255103df42bedc30ec7132cfc618122" kindref="member">dim</ref>))<sp/></highlight><highlight class="comment">#<sp/>qmean</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a574aed6e61fc20fb94b479cb8fd5fc55" kindref="member">set_stat</ref>(i,<sp/>2,<sp/>np.full(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab255103df42bedc30ec7132cfc618122" kindref="member">dim</ref>,<sp/>np.inf))<sp/></highlight><highlight class="comment">#<sp/>min</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a574aed6e61fc20fb94b479cb8fd5fc55" kindref="member">set_stat</ref>(i,<sp/>3,<sp/>np.full(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab255103df42bedc30ec7132cfc618122" kindref="member">dim</ref>,<sp/>-np.inf))<sp/></highlight><highlight class="comment">#<sp/>max</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1ac93d7c0f2200637a996a7b2802ff2e4b" kindref="member">init_niches</ref>(self,<sp/>samples_per_niche:<sp/>int<sp/>=<sp/>10):</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="578"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Initializes<sp/>niches<sp/>for<sp/>clustering<sp/>based<sp/>on<sp/>the<sp/>specified<sp/>sampling<sp/>method<sp/>and<sp/>parameters.</highlight></codeline>
<codeline lineno="579"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="580"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>configures<sp/>the<sp/>clustering<sp/>mode<sp/>(CVT-clustering<sp/>or<sp/>grid-clustering)</highlight></codeline>
<codeline lineno="581"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>based<sp/>on<sp/>the<sp/>`samples_per_niche`<sp/>parameter.<sp/>It<sp/>also<sp/>sets<sp/>up<sp/>necessary<sp/>resources,</highlight></codeline>
<codeline lineno="582"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>such<sp/>as<sp/>a<sp/>KDTree<sp/>and<sp/>shared<sp/>memory<sp/>for<sp/>centroids,<sp/>when<sp/>CVT-clustering<sp/>is<sp/>selected.</highlight></codeline>
<codeline lineno="583"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="584"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="585"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>samples_per_niche<sp/>(int,<sp/>optional):<sp/>Defines<sp/>the<sp/>sampling<sp/>strategy<sp/>for<sp/>niches.</highlight></codeline>
<codeline lineno="586" refid="classfcmaes_1_1mapelites_1_1_archive_1adae25149d74e878d190a51a3075af9bc" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>If<sp/>greater<sp/>than<sp/>0,<sp/>CVT-clustering<sp/>is<sp/>used;<sp/>otherwise,<sp/>grid-clustering<sp/>is<sp/>used.</highlight></codeline>
<codeline lineno="587" refid="classfcmaes_1_1mapelites_1_1_archive_1a55043a25e987ca5ad6f1cfaf22c835a2" refkind="member"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="588" refid="classfcmaes_1_1mapelites_1_1_archive_1a60f70e50d917a1db752b0a0124a8e756" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>If<sp/>samples_per_niche<sp/>&gt;<sp/>0<sp/>cvt-clustering<sp/>is<sp/>used,<sp/>else<sp/>grid-clustering<sp/>is<sp/>used.<sp/><sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="590" refid="classfcmaes_1_1mapelites_1_1_archive_1acb4c09718b6457bb5bfbb7f3773f7178" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab750559fbd8fab712d01cf489c8d8cb9" kindref="member">cvt_clustering</ref><sp/>=<sp/>samples_per_niche<sp/>&gt;<sp/>0</highlight></codeline>
<codeline lineno="591" refid="classfcmaes_1_1mapelites_1_1_archive_1a17848162fe39d036fbc93aa58cc77b50" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab750559fbd8fab712d01cf489c8d8cb9" kindref="member">cvt_clustering</ref>:</highlight></codeline>
<codeline lineno="592" refid="classfcmaes_1_1mapelites_1_1_archive_1ab1c9fa575d5a8225ba10e8a40fd0d59b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacefcmaes_1_1mapelites_1ace0194d76906adbf0c0dd3db084f177c" kindref="member">set_KDTree</ref>(self,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a543edcd72de56099d1f83c9dcd79e082" kindref="member">capacity</ref>,<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1aaf23b4a84332dd3988c05887f896bdb3" kindref="member">qd_bounds</ref>,<sp/>samples_per_niche)</highlight></codeline>
<codeline lineno="593" refid="classfcmaes_1_1mapelites_1_1_archive_1ada2a26ca8d9683a969403f104a759c61" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a2421ccea4dec3cbb9bef589d1a3209f9" kindref="member">cs</ref><sp/>=<sp/>mp.RawArray(ct.c_double,<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a543edcd72de56099d1f83c9dcd79e082" kindref="member">capacity</ref><sp/>*<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a7321ff2715dbc2d3258e2e880d48ef43" kindref="member">qd_dim</ref>)</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a7b98c28bd774c39099d0e41b1c38459d" kindref="member">set_cs</ref>(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1aa7d0f9677d34b82ef42b01e551011a4a" kindref="member">centers</ref>)</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1ad4060a6948b61fe981b124afc8c12ba4" kindref="member">get_occupied_data</ref>(self):</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="598"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Retrieves<sp/>the<sp/>data<sp/>points<sp/>marked<sp/>as<sp/>&quot;occupied&quot;.</highlight></codeline>
<codeline lineno="599"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="600"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>processes<sp/>the<sp/>&apos;ys&apos;<sp/>array<sp/>(retrieved<sp/>by<sp/>the<sp/>`get_ys`<sp/>method)<sp/>to<sp/>identify</highlight></codeline>
<codeline lineno="601"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>elements<sp/>corresponding<sp/>to<sp/>occupied<sp/>data<sp/>points.<sp/>Occupied<sp/>data<sp/>points<sp/>are<sp/>determined</highlight></codeline>
<codeline lineno="602"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>by<sp/>checking<sp/>where<sp/>the<sp/>values<sp/>in<sp/>&apos;ys&apos;<sp/>are<sp/>less<sp/>than<sp/>positive<sp/>infinity.<sp/>Once<sp/>identified,</highlight></codeline>
<codeline lineno="603"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>it<sp/>returns<sp/>the<sp/>`ys`,<sp/>`ds_view`,<sp/>and<sp/>`xs_view`<sp/>data<sp/>points<sp/>corresponding<sp/>to<sp/>the</highlight></codeline>
<codeline lineno="604"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>occupied<sp/>entries.</highlight></codeline>
<codeline lineno="605"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="606"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="607"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tuple:<sp/>A<sp/>tuple<sp/>containing<sp/>three<sp/>arrays:</highlight></codeline>
<codeline lineno="608"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>The<sp/>&apos;ys&apos;<sp/>values<sp/>for<sp/>occupied<sp/>data<sp/>points.</highlight></codeline>
<codeline lineno="609"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>The<sp/>corresponding<sp/>&apos;ds_view&apos;<sp/>values<sp/>for<sp/>occupied<sp/>data<sp/>points.</highlight></codeline>
<codeline lineno="610"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>The<sp/>corresponding<sp/>&apos;xs_view&apos;<sp/>values<sp/>for<sp/>occupied<sp/>data<sp/>points.</highlight></codeline>
<codeline lineno="611"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ys<sp/>=<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a91c9f1ac5485896833fc7b9859b85af1" kindref="member">get_ys</ref>()</highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>occupied<sp/>=<sp/>(ys<sp/>&lt;<sp/>np.inf)</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ys[occupied],<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1aba20d5a20cc178e6aa4f14538b54334f" kindref="member">ds_view</ref>[occupied],<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a6cbf2375b7948682ad57e3ef3d2f1dcb" kindref="member">xs_view</ref>[occupied]<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="616" refid="classfcmaes_1_1mapelites_1_1_archive_1ac93d7c0f2200637a996a7b2802ff2e4b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a7374d1c9c1cc25dbe1e472f9a01360da" kindref="member">join</ref>(self,<sp/>archive:<sp/>Archive):</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="618" refid="classfcmaes_1_1mapelites_1_1_archive_1ab750559fbd8fab712d01cf489c8d8cb9" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Joins<sp/>data<sp/>from<sp/>the<sp/>given<sp/>archive<sp/>into<sp/>the<sp/>current<sp/>archive<sp/>by<sp/>retrieving<sp/>and<sp/>processing</highlight></codeline>
<codeline lineno="619"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>occupied<sp/>data,<sp/>assigning<sp/>it<sp/>to<sp/>corresponding<sp/>niches,<sp/>and<sp/>sorting<sp/>the<sp/>archive.</highlight></codeline>
<codeline lineno="620"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="621"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="622" refid="classfcmaes_1_1mapelites_1_1_archive_1aa7d0f9677d34b82ef42b01e551011a4a" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>archive<sp/>(Archive):<sp/>An<sp/>archive<sp/>containing<sp/>data<sp/>to<sp/>be<sp/>joined<sp/>with<sp/>the<sp/>current<sp/>archive.</highlight></codeline>
<codeline lineno="623"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ys,<sp/>ds,<sp/>xs<sp/>=<sp/>archive.get_occupied_data()</highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>niches<sp/>=<sp/>archive.index_of_niches(ds)</highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yds<sp/>=<sp/>np.array([(y,<sp/>d)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>y,<sp/>d<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>zip(ys,<sp/>ds)])<sp/></highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(len(ys)):</highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>archive.set(niches[i],<sp/>yds[i],<sp/>xs[i])<sp/></highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>archive.argsort()<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="630"><highlight class="normal"></highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a57b4373d065065bf5d4dbc7cc312c092" kindref="member">fname</ref>(self,<sp/>name):</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="633"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Generates<sp/>a<sp/>formatted<sp/>string<sp/>using<sp/>name,<sp/>capacity,<sp/>dimension,<sp/>and<sp/>quality-dimension</highlight></codeline>
<codeline lineno="634"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/>for<sp/>a<sp/>specific<sp/>architecture.</highlight></codeline>
<codeline lineno="635"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="636"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="637"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name:<sp/>The<sp/>name<sp/>string<sp/>that<sp/>will<sp/>be<sp/>included<sp/>in<sp/>the<sp/>formatted<sp/>output.</highlight></codeline>
<codeline lineno="638"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="639" refid="classfcmaes_1_1mapelites_1_1_archive_1ad4060a6948b61fe981b124afc8c12ba4" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="640"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>str:<sp/>A<sp/>formatted<sp/>string<sp/>in<sp/>the<sp/>format<sp/>&apos;arch.{name}.{self.capacity}.{self.dim}.</highlight></codeline>
<codeline lineno="641"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{self.qd_dim}&apos;.</highlight></codeline>
<codeline lineno="642"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f</highlight><highlight class="stringliteral">&apos;arch.{name}.{self.capacity}.{self.dim}.{self.qd_dim}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1aedbfd9567b2d8da13a94da232465aa42" kindref="member">save</ref>(self,<sp/>name:<sp/>str):</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="647"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Saves<sp/>the<sp/>processed<sp/>data<sp/>and<sp/>corresponding<sp/>metadata<sp/>in<sp/>a<sp/>compressed<sp/>NPZ<sp/>format.</highlight></codeline>
<codeline lineno="648"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="649"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>method<sp/>stores<sp/>the<sp/>data<sp/>views<sp/>such<sp/>as<sp/>xs<sp/>(features),<sp/>ds<sp/>(distances),<sp/>ys<sp/>(labels),<sp/></highlight></codeline>
<codeline lineno="650"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>and<sp/>other<sp/>optional<sp/>attributes<sp/>like<sp/>clustering<sp/>and<sp/>statistics<sp/>in<sp/>a<sp/>compressed<sp/>file.<sp/></highlight></codeline>
<codeline lineno="651" refid="classfcmaes_1_1mapelites_1_1_archive_1a7374d1c9c1cc25dbe1e472f9a01360da" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>filename<sp/>of<sp/>the<sp/>saved<sp/>file<sp/>is<sp/>dynamically<sp/>generated<sp/>based<sp/>on<sp/>the<sp/>provided<sp/>name.</highlight></codeline>
<codeline lineno="652"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="653"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="654"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name:<sp/>Name<sp/>used<sp/>to<sp/>generate<sp/>the<sp/>filename<sp/>for<sp/>the<sp/>saved<sp/>data.</highlight></codeline>
<codeline lineno="655"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.savez_compressed(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a57b4373d065065bf5d4dbc7cc312c092" kindref="member">fname</ref>(name),<sp/></highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xs=self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a6cbf2375b7948682ad57e3ef3d2f1dcb" kindref="member">xs_view</ref>,<sp/></highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ds=self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1aba20d5a20cc178e6aa4f14538b54334f" kindref="member">ds_view</ref>,<sp/></highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ys=self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a91c9f1ac5485896833fc7b9859b85af1" kindref="member">get_ys</ref>(),<sp/></highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cs=self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a9884e6696809729e69a167c91d245464" kindref="member">get_cs</ref>()<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab750559fbd8fab712d01cf489c8d8cb9" kindref="member">cvt_clustering</ref><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>np.empty(0),</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stats=self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a97f1345584f4d25bd8a24af6cb7d7e4c" kindref="member">get_stats</ref>(),</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>counts=self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1abfbc79753a308a9880da632d96b37d5c" kindref="member">get_counts</ref>()</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)</highlight></codeline>
<codeline lineno="664"><highlight class="normal"></highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a62da9c6f511c298d1ef06d6af7600196" kindref="member">load</ref>(self,<sp/>name:<sp/>str):</highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="667"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Loads<sp/>data<sp/>from<sp/>a<sp/>specified<sp/>file<sp/>into<sp/>the<sp/>current<sp/>object,<sp/>initializing<sp/>or<sp/></highlight></codeline>
<codeline lineno="668"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>updating<sp/>its<sp/>properties<sp/>and<sp/>attributes.<sp/>This<sp/>method<sp/>reads<sp/>numpy<sp/>data<sp/>files<sp/></highlight></codeline>
<codeline lineno="669"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>and<sp/>adjusts<sp/>internal<sp/>structures,<sp/>such<sp/>as<sp/>clustering<sp/>state,<sp/>dimensions,<sp/>capacity,<sp/></highlight></codeline>
<codeline lineno="670" refid="classfcmaes_1_1mapelites_1_1_archive_1a57b4373d065065bf5d4dbc7cc312c092" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>and<sp/>associated<sp/>statistics<sp/>based<sp/>on<sp/>the<sp/>data<sp/>provided.</highlight></codeline>
<codeline lineno="671"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="672"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="673"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>name<sp/>(str):<sp/>The<sp/>base<sp/>name<sp/>of<sp/>the<sp/>file<sp/>from<sp/>which<sp/>to<sp/>load<sp/>data.</highlight></codeline>
<codeline lineno="674"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="675"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Raises:</highlight></codeline>
<codeline lineno="676"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FileNotFoundError:<sp/>If<sp/>the<sp/>file<sp/>specified<sp/>by<sp/>the<sp/>name<sp/>parameter<sp/>does<sp/>not<sp/>exist.</highlight></codeline>
<codeline lineno="677"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ValueError:<sp/>If<sp/>the<sp/>data<sp/>in<sp/>the<sp/>file<sp/>is<sp/>inconsistent<sp/>or<sp/>incompatible<sp/>with<sp/></highlight></codeline>
<codeline lineno="678"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>current<sp/>object&apos;s<sp/>structure.</highlight></codeline>
<codeline lineno="679"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a2421ccea4dec3cbb9bef589d1a3209f9" kindref="member">cs</ref><sp/>=<sp/>mp.RawArray(ct.c_double,<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a543edcd72de56099d1f83c9dcd79e082" kindref="member">capacity</ref><sp/>*<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a7321ff2715dbc2d3258e2e880d48ef43" kindref="member">qd_dim</ref>)</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">with</highlight><highlight class="normal"><sp/>np.load(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a57b4373d065065bf5d4dbc7cc312c092" kindref="member">fname</ref>(name)<sp/>+<sp/></highlight><highlight class="stringliteral">&apos;.npz&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>data:</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab750559fbd8fab712d01cf489c8d8cb9" kindref="member">cvt_clustering</ref><sp/>=<sp/>len(data[</highlight><highlight class="stringliteral">&apos;cs&apos;</highlight><highlight class="normal">])<sp/>&gt;<sp/>0</highlight></codeline>
<codeline lineno="683" refid="classfcmaes_1_1mapelites_1_1_archive_1aedbfd9567b2d8da13a94da232465aa42" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xs<sp/>=<sp/>data[</highlight><highlight class="stringliteral">&apos;xs&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ds<sp/>=<sp/>data[</highlight><highlight class="stringliteral">&apos;ds&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a55043a25e987ca5ad6f1cfaf22c835a2" kindref="member">xs</ref>.view()[:]<sp/>=<sp/>xs</highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a60f70e50d917a1db752b0a0124a8e756" kindref="member">ds</ref>.view()[:]<sp/>=<sp/>ds</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a06c36a088a4f1f50b63e7d0cdf1dcc40" kindref="member">set_ys</ref>(data[</highlight><highlight class="stringliteral">&apos;ys&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab750559fbd8fab712d01cf489c8d8cb9" kindref="member">cvt_clustering</ref>:</highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a7b98c28bd774c39099d0e41b1c38459d" kindref="member">set_cs</ref>(data[</highlight><highlight class="stringliteral">&apos;cs&apos;</highlight><highlight class="normal">])</highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a17848162fe39d036fbc93aa58cc77b50" kindref="member">counts</ref>[:]<sp/>=<sp/>data[</highlight><highlight class="stringliteral">&apos;counts&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stats<sp/>=<sp/>data[</highlight><highlight class="stringliteral">&apos;stats&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(stats)<sp/>==<sp/>len(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ada2a26ca8d9683a969403f104a759c61" kindref="member">stats</ref>):</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a0e469ed5be63b9dd87ea220095b620b8" kindref="member">set_stats</ref>(stats)</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab1c9fa575d5a8225ba10e8a40fd0d59b" kindref="member">occupied</ref>.value<sp/>=<sp/>np.count_nonzero(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a91c9f1ac5485896833fc7b9859b85af1" kindref="member">get_ys</ref>()<sp/>&lt;<sp/>np.inf)</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab255103df42bedc30ec7132cfc618122" kindref="member">dim</ref><sp/>=<sp/>xs.shape[1]</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a7321ff2715dbc2d3258e2e880d48ef43" kindref="member">qd_dim</ref><sp/>=<sp/>ds.shape[1]</highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a543edcd72de56099d1f83c9dcd79e082" kindref="member">capacity</ref><sp/>=<sp/>xs.shape[0]</highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab750559fbd8fab712d01cf489c8d8cb9" kindref="member">cvt_clustering</ref>:</highlight></codeline>
<codeline lineno="699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespacefcmaes_1_1mapelites_1ace0194d76906adbf0c0dd3db084f177c" kindref="member">set_KDTree</ref>(self,<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a9884e6696809729e69a167c91d245464" kindref="member">get_cs</ref>(),<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a6b4ef0e37ad2c67546dfbab83913c402" kindref="member">index_of_niches</ref>(self,<sp/>ds):</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="703"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Determines<sp/>the<sp/>indices<sp/>of<sp/>the<sp/>niches<sp/>for<sp/>the<sp/>given<sp/>data<sp/>samples<sp/>(ds)<sp/>based<sp/>on<sp/>the<sp/></highlight></codeline>
<codeline lineno="704"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>clustering<sp/>method<sp/>used<sp/>(either<sp/>k-means<sp/>clusters<sp/>or<sp/>grid-based<sp/>clustering).</highlight></codeline>
<codeline lineno="705"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="706"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="707" refid="classfcmaes_1_1mapelites_1_1_archive_1a62da9c6f511c298d1ef06d6af7600196" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ds:<sp/>Input<sp/>data<sp/>samples<sp/>for<sp/>which<sp/>the<sp/>niche<sp/>indices<sp/>are<sp/>to<sp/>be<sp/>determined.</highlight></codeline>
<codeline lineno="708"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="709"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="710"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ndarray:<sp/>Niche<sp/>indices<sp/>of<sp/>the<sp/>input<sp/>data<sp/>samples.</highlight></codeline>
<codeline lineno="711"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>hasattr(self,<sp/></highlight><highlight class="stringliteral">&quot;kdt&quot;</highlight><highlight class="normal">):<sp/></highlight><highlight class="comment">#<sp/>use<sp/>k-means<sp/>clusters</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.kdt.query(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a4c0b220309e8100c4a104b29b9ca4898" kindref="member">encode_d</ref>(ds),<sp/>k=1,<sp/>sort_results=</highlight><highlight class="keyword">False</highlight><highlight class="normal">)[1].T[0]<sp/></highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:<sp/></highlight><highlight class="comment">#<sp/>use<sp/>grid<sp/>based<sp/>clustering</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespacefcmaes_1_1mapelites_1a5c3c74816cffd5997c0f9e897205abc8" kindref="member">get_grid_indices</ref>(ds,<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a543edcd72de56099d1f83c9dcd79e082" kindref="member">capacity</ref>,<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1aaf23b4a84332dd3988c05887f896bdb3" kindref="member">qd_bounds</ref>.lb,<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1aaf23b4a84332dd3988c05887f896bdb3" kindref="member">qd_bounds</ref>.ub)</highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1ac73f5b05c273a6238d1da2d70603b2af" kindref="member">in_niche_filter</ref>(self,<sp/></highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fit:<sp/>Callable[[ArrayLike],<sp/>float],<sp/></highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index:<sp/>int):</highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="721"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Filters<sp/>an<sp/>element<sp/>based<sp/>on<sp/>its<sp/>fitness<sp/>and<sp/>niche<sp/>index.</highlight></codeline>
<codeline lineno="722"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="723"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>function<sp/>evaluates<sp/>whether<sp/>an<sp/>element,<sp/>represented<sp/>by<sp/>its<sp/>fitness<sp/>value<sp/>and<sp/>niche<sp/>index,<sp/>satisfies<sp/>the<sp/></highlight></codeline>
<codeline lineno="724"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>condition<sp/>required<sp/>for<sp/>inclusion<sp/>in<sp/>a<sp/>niche.<sp/>The<sp/>filtering<sp/>mechanism<sp/>is<sp/>defined<sp/>externally<sp/>and<sp/>passed<sp/>in<sp/></highlight></codeline>
<codeline lineno="725"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>as<sp/>a<sp/>callable.</highlight></codeline>
<codeline lineno="726"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="727"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="728"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fit<sp/>(Callable[[ArrayLike],<sp/>float]):<sp/>A<sp/>callable<sp/>function<sp/>that<sp/>takes<sp/>an<sp/>array-like<sp/>object<sp/>and<sp/>calculates<sp/></highlight></codeline>
<codeline lineno="729"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a<sp/>fitness<sp/>value<sp/>for<sp/>evaluation.</highlight></codeline>
<codeline lineno="730"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index<sp/>(int):<sp/>The<sp/>index<sp/>of<sp/>the<sp/>element<sp/>within<sp/>its<sp/>group<sp/>to<sp/>be<sp/>filtered.</highlight></codeline>
<codeline lineno="731"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="732"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="733"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bool:<sp/>True<sp/>if<sp/>the<sp/>element<sp/>satisfies<sp/>the<sp/>niche<sp/>filter<sp/>condition,<sp/>False<sp/>otherwise.</highlight></codeline>
<codeline lineno="734"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classfcmaes_1_1mapelites_1_1in__niche__filter" kindref="compound">in_niche_filter</ref>(fit,<sp/>index,<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a6b4ef0e37ad2c67546dfbab83913c402" kindref="member">index_of_niches</ref>)</highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a82cd0403d58fbb41ef29c2cfb6ac74f7" kindref="member">set</ref>(self,<sp/></highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i:<sp/>int,<sp/></highlight></codeline>
<codeline lineno="739" refid="classfcmaes_1_1mapelites_1_1_archive_1ab4f4023cb427da5cbedcf919c4641bfa" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yd:<sp/>np.ndarray,<sp/></highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x:<sp/>np.ndarray):</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="742"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Updates<sp/>statistical<sp/>data<sp/>and<sp/>modifies<sp/>the<sp/>internal<sp/>data<sp/>store<sp/>with<sp/>the<sp/>given<sp/></highlight></codeline>
<codeline lineno="743"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/>if<sp/>certain<sp/>conditions<sp/>are<sp/>met<sp/>(e.g.,<sp/>improvement<sp/>in<sp/>objective<sp/>value<sp/>`y`).</highlight></codeline>
<codeline lineno="744"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="745"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="746"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>(int):<sp/>The<sp/>index<sp/>representing<sp/>the<sp/>position<sp/>in<sp/>the<sp/>internal<sp/>data<sp/>storage<sp/></highlight></codeline>
<codeline lineno="747"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>update.</highlight></codeline>
<codeline lineno="748"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yd<sp/>(np.ndarray):<sp/>A<sp/>numpy<sp/>array<sp/>containing<sp/>the<sp/>objective<sp/>value<sp/>`y`<sp/>and<sp/></highlight></codeline>
<codeline lineno="749"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>additional<sp/>associated<sp/>data<sp/>`d`<sp/>as<sp/>elements.</highlight></codeline>
<codeline lineno="750"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>(np.ndarray):<sp/>A<sp/>numpy<sp/>array<sp/>representing<sp/>the<sp/>new<sp/>input<sp/>data<sp/>associated<sp/></highlight></codeline>
<codeline lineno="751"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>the<sp/>index<sp/>`i`.</highlight></codeline>
<codeline lineno="752"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="753"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a9aaaf43220a388cc81d0750b7849dbdc" kindref="member">update_stats</ref>(i,<sp/>x)</highlight></codeline>
<codeline lineno="755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y,<sp/>d<sp/>=<sp/>yd</highlight></codeline>
<codeline lineno="756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>register<sp/>improvement</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>yold<sp/>=<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ac9390a3bfd798bdb09d79476ed6c6584" kindref="member">get_y</ref>(i)</highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>y<sp/>&lt;<sp/>yold:</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>yold<sp/>==<sp/>np.inf:<sp/></highlight><highlight class="comment">#<sp/>not<sp/>yet<sp/>occupied</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="760" refid="classfcmaes_1_1mapelites_1_1_archive_1ac73f5b05c273a6238d1da2d70603b2af" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab1c9fa575d5a8225ba10e8a40fd0d59b" kindref="member">occupied</ref>.value<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1afc25798d5b07a1addd68fc50cec1f3e5" kindref="member">set_y</ref>(i,<sp/>y)</highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a6cbf2375b7948682ad57e3ef3d2f1dcb" kindref="member">xs_view</ref>[i]<sp/>=<sp/>x</highlight></codeline>
<codeline lineno="763" refid="classfcmaes_1_1mapelites_1_1_archive_1a6b4ef0e37ad2c67546dfbab83913c402" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1aba20d5a20cc178e6aa4f14538b54334f" kindref="member">ds_view</ref>[i]<sp/>=<sp/>d</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a9aaaf43220a388cc81d0750b7849dbdc" kindref="member">update_stats</ref>(self,<sp/></highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i:<sp/>int,<sp/></highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x:<sp/>np.ndarray):</highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="769"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Updates<sp/>the<sp/>statistical<sp/>information<sp/>for<sp/>the<sp/>given<sp/>index<sp/>and<sp/>array<sp/>input.<sp/>Tracks<sp/></highlight></codeline>
<codeline lineno="770"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>counts,<sp/>mean,<sp/>quadratic<sp/>mean<sp/>(qmean),<sp/>minimum,<sp/>and<sp/>maximum<sp/>values<sp/>for<sp/>the<sp/></highlight></codeline>
<codeline lineno="771"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>specified<sp/>index.</highlight></codeline>
<codeline lineno="772"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="773"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="774"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>(int):<sp/>Index<sp/>of<sp/>the<sp/>element<sp/>whose<sp/>statistics<sp/>need<sp/>to<sp/>be<sp/>updated.</highlight></codeline>
<codeline lineno="775"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>(numpy.ndarray):<sp/>Input<sp/>array<sp/>used<sp/>to<sp/>update<sp/>the<sp/>statistics.</highlight></codeline>
<codeline lineno="776"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">with</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1abbcf8dde9401f4b34d4669a064e12373" kindref="member">lock</ref>:</highlight></codeline>
<codeline lineno="778" refid="classfcmaes_1_1mapelites_1_1_archive_1a82cd0403d58fbb41ef29c2cfb6ac74f7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a17848162fe39d036fbc93aa58cc77b50" kindref="member">counts</ref>[i]<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>count<sp/>=<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a17848162fe39d036fbc93aa58cc77b50" kindref="member">counts</ref>[i]</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a1d6bb3c3d671d59cd6c48cc30574652d" kindref="member">use_stats</ref>:<sp/><sp/></highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>mean<sp/>=<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a240c31cf1f2a4a8f2fe6bef3ece80206" kindref="member">get_x_mean</ref>(i)</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>diff<sp/>=<sp/>x<sp/>-<sp/>mean<sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a574aed6e61fc20fb94b479cb8fd5fc55" kindref="member">set_stat</ref>(i,<sp/>0,<sp/>mean<sp/>+<sp/>diff<sp/>*<sp/>(1./count))<sp/></highlight><highlight class="comment">#<sp/>mean</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a574aed6e61fc20fb94b479cb8fd5fc55" kindref="member">set_stat</ref>(i,<sp/>1,<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a4a9c0d92560064a154b7bbcf1d537480" kindref="member">get_stat</ref>(i,<sp/>1)<sp/>+<sp/>np.multiply(diff,diff)<sp/>*<sp/>((count-1)/count))<sp/></highlight><highlight class="comment">#<sp/>qmean<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a574aed6e61fc20fb94b479cb8fd5fc55" kindref="member">set_stat</ref>(i,<sp/>2,<sp/>np.minimum(x,<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a4a9c0d92560064a154b7bbcf1d537480" kindref="member">get_stat</ref>(i,<sp/>2)))<sp/></highlight><highlight class="comment">#<sp/>min</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a574aed6e61fc20fb94b479cb8fd5fc55" kindref="member">set_stat</ref>(i,<sp/>3,<sp/>np.maximum(x,<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a4a9c0d92560064a154b7bbcf1d537480" kindref="member">get_stat</ref>(i,<sp/>3)))<sp/></highlight><highlight class="comment">#<sp/>max</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a7d6497547e738f46792eed929c0eb09c" kindref="member">get_occupied</ref>(self)<sp/>-&gt;<sp/>int:</highlight></codeline>
<codeline lineno="789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="790"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Retrieves<sp/>the<sp/>current<sp/>number<sp/>of<sp/>occupied<sp/>spaces<sp/>from<sp/>the<sp/>associated<sp/>value.</highlight></codeline>
<codeline lineno="791"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="792"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="793"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int:<sp/>The<sp/>number<sp/>of<sp/>occupied<sp/>spaces.</highlight></codeline>
<codeline lineno="794"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab1c9fa575d5a8225ba10e8a40fd0d59b" kindref="member">occupied</ref>.value</highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1af0512120043e652b080fc57f7f9bc34e" kindref="member">get_count</ref>(self,<sp/>i:<sp/>int)<sp/>-&gt;<sp/>int:</highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="799"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Get<sp/>the<sp/>count<sp/>for<sp/>a<sp/>specific<sp/>index.</highlight></codeline>
<codeline lineno="800"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="801"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>retrieves<sp/>the<sp/>count<sp/>value<sp/>from<sp/>the<sp/>`counts`<sp/>collection<sp/>based<sp/>on<sp/>the<sp/></highlight></codeline>
<codeline lineno="802" refid="classfcmaes_1_1mapelites_1_1_archive_1a9aaaf43220a388cc81d0750b7849dbdc" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>provided<sp/>index.</highlight></codeline>
<codeline lineno="803"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="804"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="805"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>(int):<sp/>The<sp/>index<sp/>of<sp/>the<sp/>element<sp/>whose<sp/>count<sp/>is<sp/>to<sp/>be<sp/>retrieved.</highlight></codeline>
<codeline lineno="806"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="807"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="808"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int:<sp/>The<sp/>count<sp/>corresponding<sp/>to<sp/>the<sp/>given<sp/>index.</highlight></codeline>
<codeline lineno="809"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a17848162fe39d036fbc93aa58cc77b50" kindref="member">counts</ref>[i]</highlight></codeline>
<codeline lineno="811"><highlight class="normal"></highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1abfbc79753a308a9880da632d96b37d5c" kindref="member">get_counts</ref>(self)<sp/>-&gt;<sp/>np.ndarray:</highlight></codeline>
<codeline lineno="813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="814"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Retrieves<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>`counts`<sp/>as<sp/>a<sp/>NumPy<sp/>array.</highlight></codeline>
<codeline lineno="815"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="816"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>returns<sp/>a<sp/>deep<sp/>copy<sp/>of<sp/>the<sp/>`counts`<sp/>list,<sp/>converted<sp/>to<sp/>a<sp/>NumPy</highlight></codeline>
<codeline lineno="817"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>array.<sp/>It<sp/>ensures<sp/>that<sp/>the<sp/>original<sp/>data<sp/>remains<sp/>unaltered<sp/>while<sp/>providing</highlight></codeline>
<codeline lineno="818"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a<sp/>convenient<sp/>format<sp/>for<sp/>numerical<sp/>operations.</highlight></codeline>
<codeline lineno="819"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="820"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="821"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.ndarray:<sp/>A<sp/>NumPy<sp/>array<sp/>containing<sp/>the<sp/>copied<sp/>elements<sp/>of<sp/>`counts`.</highlight></codeline>
<codeline lineno="822" refid="classfcmaes_1_1mapelites_1_1_archive_1a7d6497547e738f46792eed929c0eb09c" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>np.array(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a17848162fe39d036fbc93aa58cc77b50" kindref="member">counts</ref>[:])</highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a240c31cf1f2a4a8f2fe6bef3ece80206" kindref="member">get_x_mean</ref>(self,<sp/>i:<sp/>int)<sp/>-&gt;<sp/>np.ndarray:</highlight></codeline>
<codeline lineno="826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="827"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Calculates<sp/>and<sp/>retrieves<sp/>the<sp/>mean<sp/>value<sp/>for<sp/>a<sp/>specific<sp/>index<sp/>of<sp/>data.</highlight></codeline>
<codeline lineno="828"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="829"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>function<sp/>calls<sp/>another<sp/>internal<sp/>method<sp/>to<sp/>obtain<sp/>the<sp/>required<sp/>statistic</highlight></codeline>
<codeline lineno="830"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>associated<sp/>with<sp/>the<sp/>given<sp/>index<sp/>and<sp/>statistic<sp/>type<sp/>(mean<sp/>in<sp/>this<sp/>case).</highlight></codeline>
<codeline lineno="831"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="832"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="833"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>(int):<sp/>The<sp/>index<sp/>of<sp/>the<sp/>data<sp/>for<sp/>which<sp/>the<sp/>mean<sp/>value<sp/>will<sp/>be<sp/>computed.</highlight></codeline>
<codeline lineno="834"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="835"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="836"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.ndarray:<sp/>The<sp/>calculated<sp/>mean<sp/>value<sp/>for<sp/>the<sp/>specified<sp/>index.</highlight></codeline>
<codeline lineno="837" refid="classfcmaes_1_1mapelites_1_1_archive_1af0512120043e652b080fc57f7f9bc34e" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a4a9c0d92560064a154b7bbcf1d537480" kindref="member">get_stat</ref>(i,<sp/>0)</highlight></codeline>
<codeline lineno="839"><highlight class="normal"></highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a12befeeecf65003f61a073520070a4d7" kindref="member">get_x_stdev</ref>(self,<sp/>i:<sp/>int)<sp/>-&gt;<sp/>np.ndarray:</highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="842"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Calculates<sp/>the<sp/>standard<sp/>deviation<sp/>of<sp/>x<sp/>for<sp/>a<sp/>given<sp/>identifier.</highlight></codeline>
<codeline lineno="843"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="844"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>computes<sp/>the<sp/>standard<sp/>deviation<sp/>of<sp/>the<sp/>variable<sp/>&apos;x&apos;,<sp/>based<sp/>on<sp/>the</highlight></codeline>
<codeline lineno="845"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>statistics<sp/>collected<sp/>for<sp/>a<sp/>specific<sp/>identifier.<sp/>If<sp/>no<sp/>data<sp/>is<sp/>available<sp/>for</highlight></codeline>
<codeline lineno="846"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>identifier,<sp/>it<sp/>returns<sp/>a<sp/>zero<sp/>array<sp/>with<sp/>the<sp/>appropriate<sp/>dimension.</highlight></codeline>
<codeline lineno="847"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="848"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="849"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>(int):<sp/>Identifier<sp/>used<sp/>to<sp/>retrieve<sp/>the<sp/>specific<sp/>statistics.</highlight></codeline>
<codeline lineno="850" refid="classfcmaes_1_1mapelites_1_1_archive_1abfbc79753a308a9880da632d96b37d5c" refkind="member"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="851"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="852"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.ndarray:<sp/>A<sp/>numpy<sp/>array<sp/>representing<sp/>the<sp/>standard<sp/>deviation<sp/>of<sp/>x,<sp/>with</highlight></codeline>
<codeline lineno="853"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>same<sp/>dimension<sp/>as<sp/>the<sp/>data.</highlight></codeline>
<codeline lineno="854"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>count<sp/>=<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1af0512120043e652b080fc57f7f9bc34e" kindref="member">get_count</ref>(i)</highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>count<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>np.zeros(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab255103df42bedc30ec7132cfc618122" kindref="member">dim</ref>)</highlight></codeline>
<codeline lineno="858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qmean<sp/>=<sp/>np.array(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a4a9c0d92560064a154b7bbcf1d537480" kindref="member">get_stat</ref>(i,<sp/>1))</highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>np.sqrt(qmean<sp/>*<sp/>(1./count))</highlight></codeline>
<codeline lineno="861"><highlight class="normal"></highlight></codeline>
<codeline lineno="862"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a864352039c770d3095a4c68c67c07cc6" kindref="member">get_x_min</ref>(self,<sp/>i:<sp/>int)<sp/>-&gt;<sp/>np.ndarray:</highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="864"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gets<sp/>the<sp/>minimum<sp/>x-coordinate<sp/>value<sp/>from<sp/>a<sp/>statistical<sp/>data<sp/>set.</highlight></codeline>
<codeline lineno="865" refid="classfcmaes_1_1mapelites_1_1_archive_1a240c31cf1f2a4a8f2fe6bef3ece80206" refkind="member"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="866"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>function<sp/>retrieves<sp/>the<sp/>minimum<sp/>value<sp/>of<sp/>the<sp/>x-coordinate<sp/>from<sp/>the</highlight></codeline>
<codeline lineno="867"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dataset<sp/>for<sp/>a<sp/>specified<sp/>index<sp/>and<sp/>returns<sp/>it<sp/>as<sp/>a<sp/>NumPy<sp/>array.</highlight></codeline>
<codeline lineno="868"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="869"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="870"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>(int):<sp/>The<sp/>index<sp/>of<sp/>the<sp/>dataset<sp/>for<sp/>which<sp/>the<sp/>minimum<sp/>x-coordinate</highlight></codeline>
<codeline lineno="871"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>is<sp/>retrieved.</highlight></codeline>
<codeline lineno="872"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="873"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="874"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.ndarray:<sp/>The<sp/>minimum<sp/>x-coordinate<sp/>value<sp/>in<sp/>the<sp/>dataset<sp/>corresponding</highlight></codeline>
<codeline lineno="875"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>the<sp/>provided<sp/>index.</highlight></codeline>
<codeline lineno="876"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a4a9c0d92560064a154b7bbcf1d537480" kindref="member">get_stat</ref>(i,<sp/>2)</highlight></codeline>
<codeline lineno="878"><highlight class="normal"></highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1ae14fb3f28ebc29cc2356048a91d8e072" kindref="member">get_x_max</ref>(self,<sp/>i:<sp/>int)<sp/>-&gt;<sp/>np.ndarray:</highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="881"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns<sp/>the<sp/>maximum<sp/>value<sp/>of<sp/>the<sp/>&apos;x&apos;<sp/>statistic<sp/>for<sp/>the<sp/>specified<sp/>index.</highlight></codeline>
<codeline lineno="882" refid="classfcmaes_1_1mapelites_1_1_archive_1a12befeeecf65003f61a073520070a4d7" refkind="member"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="883"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>retrieves<sp/>the<sp/>maximum<sp/>value<sp/>of<sp/>the<sp/>&apos;x&apos;<sp/>statistic<sp/>by<sp/>utilizing</highlight></codeline>
<codeline lineno="884"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>`get_stat`<sp/>method<sp/>with<sp/>specific<sp/>parameters.</highlight></codeline>
<codeline lineno="885"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="886"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="887"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>(int):<sp/>The<sp/>index<sp/>for<sp/>which<sp/>the<sp/>&apos;x&apos;<sp/>statistic&apos;s<sp/>maximum<sp/>value<sp/>is<sp/>to</highlight></codeline>
<codeline lineno="888"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>be<sp/>retrieved.</highlight></codeline>
<codeline lineno="889"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="890"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="891"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.ndarray:<sp/>The<sp/>maximum<sp/>value<sp/>of<sp/>the<sp/>&apos;x&apos;<sp/>statistic<sp/>for<sp/>the<sp/>specified</highlight></codeline>
<codeline lineno="892"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index.</highlight></codeline>
<codeline lineno="893"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a4a9c0d92560064a154b7bbcf1d537480" kindref="member">get_stat</ref>(i,<sp/>3)</highlight></codeline>
<codeline lineno="895"><highlight class="normal"></highlight></codeline>
<codeline lineno="896"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a3976d13396ea59523d79e16b7d96f448" kindref="member">create_views</ref>(self):<sp/></highlight><highlight class="comment">#<sp/>needs<sp/>to<sp/>be<sp/>called<sp/>in<sp/>the<sp/>target<sp/>process</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="898"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Creates<sp/>views<sp/>for<sp/>the<sp/>attributes<sp/>within<sp/>the<sp/>target<sp/>process.</highlight></codeline>
<codeline lineno="899"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="900"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>initializes<sp/>views<sp/>for<sp/>specific<sp/>attributes<sp/>to<sp/>enhance</highlight></codeline>
<codeline lineno="901"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>performance<sp/>and<sp/>allow<sp/>efficient<sp/>data<sp/>manipulation<sp/>in<sp/>the<sp/>target</highlight></codeline>
<codeline lineno="902"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>process.<sp/>The<sp/>views<sp/>are<sp/>created<sp/>using<sp/>the<sp/>`view()`<sp/>method.</highlight></codeline>
<codeline lineno="903"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="904" refid="classfcmaes_1_1mapelites_1_1_archive_1a864352039c770d3095a4c68c67c07cc6" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Raises:</highlight></codeline>
<codeline lineno="905"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AttributeError:<sp/>If<sp/>either<sp/>`xs`<sp/>or<sp/>`ds`<sp/>is<sp/>not<sp/>properly<sp/>initialized</highlight></codeline>
<codeline lineno="906"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>or<sp/>does<sp/>not<sp/>support<sp/>the<sp/>`view()`<sp/>method.</highlight></codeline>
<codeline lineno="907"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a6cbf2375b7948682ad57e3ef3d2f1dcb" kindref="member">xs_view</ref><sp/>=<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a55043a25e987ca5ad6f1cfaf22c835a2" kindref="member">xs</ref>.view()</highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1aba20d5a20cc178e6aa4f14538b54334f" kindref="member">ds_view</ref><sp/>=<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a60f70e50d917a1db752b0a0124a8e756" kindref="member">ds</ref>.view()</highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a4c0b220309e8100c4a104b29b9ca4898" kindref="member">encode_d</ref>(self,<sp/>d):</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="913"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Encodes<sp/>the<sp/>given<sp/>value<sp/>using<sp/>the<sp/>specified<sp/>scale<sp/>and<sp/>lower<sp/>bound.</highlight></codeline>
<codeline lineno="914"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="915"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>calculates<sp/>a<sp/>normalized<sp/>value<sp/>by<sp/>subtracting<sp/>the<sp/>lower</highlight></codeline>
<codeline lineno="916"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bound<sp/>(self.desc_lb)<sp/>from<sp/>the<sp/>input<sp/>and<sp/>then<sp/>dividing<sp/>by<sp/>the<sp/>scale</highlight></codeline>
<codeline lineno="917"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>factor<sp/>(self.desc_scale).</highlight></codeline>
<codeline lineno="918"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="919"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="920"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d:<sp/>A<sp/>numerical<sp/>value<sp/>to<sp/>be<sp/>encoded.</highlight></codeline>
<codeline lineno="921" refid="classfcmaes_1_1mapelites_1_1_archive_1ae14fb3f28ebc29cc2356048a91d8e072" refkind="member"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="922"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="923"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>float:<sp/>The<sp/>encoded<sp/>value<sp/>after<sp/>applying<sp/>the<sp/>normalization<sp/>formula.</highlight></codeline>
<codeline lineno="924"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(d<sp/>-<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1acef7919c3b7f9798628857f25de27d3c" kindref="member">desc_lb</ref>)<sp/>/<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ae3f63fce62db86da46ee146bf27293c3" kindref="member">desc_scale</ref></highlight></codeline>
<codeline lineno="926"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1ae916520d6c7090a4aebb511b782f003c" kindref="member">decode_d</ref>(self,<sp/>d):</highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="929"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Decodes<sp/>a<sp/>given<sp/>value<sp/>`d`<sp/>using<sp/>the<sp/>object&apos;s<sp/>scaling<sp/>factor<sp/>and<sp/>lower<sp/>bound.</highlight></codeline>
<codeline lineno="930"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="931"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>applies<sp/>a<sp/>transformation<sp/>to<sp/>the<sp/>input<sp/>value<sp/>`d`<sp/>based<sp/>on<sp/>the</highlight></codeline>
<codeline lineno="932"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>attributes<sp/>`desc_scale`<sp/>and<sp/>`desc_lb`<sp/>of<sp/>the<sp/>object.<sp/>It<sp/>linearly<sp/>scales</highlight></codeline>
<codeline lineno="933"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>and<sp/>offsets<sp/>the<sp/>input<sp/>to<sp/>produce<sp/>the<sp/>decoded<sp/>value.</highlight></codeline>
<codeline lineno="934"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="935" refid="classfcmaes_1_1mapelites_1_1_archive_1a3976d13396ea59523d79e16b7d96f448" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="936" refid="classfcmaes_1_1mapelites_1_1_archive_1a6cbf2375b7948682ad57e3ef3d2f1dcb" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d:<sp/>Input<sp/>value<sp/>to<sp/>decode.</highlight></codeline>
<codeline lineno="937" refid="classfcmaes_1_1mapelites_1_1_archive_1aba20d5a20cc178e6aa4f14538b54334f" refkind="member"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="938"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="939"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>decoded<sp/>value<sp/>as<sp/>a<sp/>float.</highlight></codeline>
<codeline lineno="940"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(d<sp/>*<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ae3f63fce62db86da46ee146bf27293c3" kindref="member">desc_scale</ref>)<sp/>+<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1acef7919c3b7f9798628857f25de27d3c" kindref="member">desc_lb</ref></highlight></codeline>
<codeline lineno="942"><highlight class="normal"></highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a052f1f8d58ffc784ec8ee16aca535a14" kindref="member">get_xs</ref>(self)<sp/>-&gt;<sp/>np.ndarray:</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="945"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Gets<sp/>a<sp/>view<sp/>of<sp/>the<sp/>`xs`<sp/>attribute.</highlight></codeline>
<codeline lineno="946"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="947"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>returns<sp/>a<sp/>view<sp/>of<sp/>the<sp/>`xs`<sp/>attribute,<sp/>allowing<sp/>access<sp/>to</highlight></codeline>
<codeline lineno="948"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>data<sp/>without<sp/>copying<sp/>it.<sp/>The<sp/>returned<sp/>view<sp/>reflects<sp/>changes<sp/>made</highlight></codeline>
<codeline lineno="949"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>the<sp/>original<sp/>data.</highlight></codeline>
<codeline lineno="950"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="951"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="952" refid="classfcmaes_1_1mapelites_1_1_archive_1a4c0b220309e8100c4a104b29b9ca4898" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.ndarray:<sp/>A<sp/>view<sp/>of<sp/>the<sp/>`xs`<sp/>attribute.</highlight></codeline>
<codeline lineno="953"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a55043a25e987ca5ad6f1cfaf22c835a2" kindref="member">xs</ref>.view()</highlight></codeline>
<codeline lineno="955"><highlight class="normal"></highlight></codeline>
<codeline lineno="956"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1af91d2fd25aee22c7bcc46b2c5cad0092" kindref="member">get_ds</ref>(self)<sp/>-&gt;<sp/>np.ndarray:</highlight></codeline>
<codeline lineno="957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="958"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns<sp/>a<sp/>view<sp/>of<sp/>the<sp/>`ds`<sp/>attribute.</highlight></codeline>
<codeline lineno="959"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="960"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>provides<sp/>a<sp/>view<sp/>of<sp/>the<sp/>data<sp/>stored<sp/>in<sp/>the<sp/>`ds`<sp/>attribute.<sp/>It</highlight></codeline>
<codeline lineno="961"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>enables<sp/>access<sp/>to<sp/>the<sp/>data<sp/>without<sp/>modifying<sp/>the<sp/>original<sp/>structure.</highlight></codeline>
<codeline lineno="962"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="963"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="964"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.ndarray:<sp/>A<sp/>view<sp/>of<sp/>the<sp/>`ds`<sp/>attribute<sp/>as<sp/>a<sp/>NumPy<sp/>array.</highlight></codeline>
<codeline lineno="965"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a60f70e50d917a1db752b0a0124a8e756" kindref="member">ds</ref>.view()</highlight></codeline>
<codeline lineno="967"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="968" refid="classfcmaes_1_1mapelites_1_1_archive_1ae916520d6c7090a4aebb511b782f003c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1ac9390a3bfd798bdb09d79476ed6c6584" kindref="member">get_y</ref>(self,<sp/>i:<sp/>int)<sp/>-&gt;<sp/>float:</highlight></codeline>
<codeline lineno="969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="970"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Retrieves<sp/>the<sp/>y-coordinate<sp/>value<sp/>at<sp/>a<sp/>given<sp/>index<sp/>from<sp/>the<sp/>list<sp/>of<sp/>y-values.</highlight></codeline>
<codeline lineno="971"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="972"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="973"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>(int):<sp/>The<sp/>index<sp/>of<sp/>the<sp/>y-value<sp/>to<sp/>retrieve.</highlight></codeline>
<codeline lineno="974"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="975"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="976"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>float:<sp/>The<sp/>y-coordinate<sp/>value<sp/>at<sp/>the<sp/>specified<sp/>index.</highlight></codeline>
<codeline lineno="977"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1acb4c09718b6457bb5bfbb7f3773f7178" kindref="member">ys</ref>[i]</highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="980"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a91c9f1ac5485896833fc7b9859b85af1" kindref="member">get_ys</ref>(self)<sp/>-&gt;<sp/>np.ndarray:</highlight></codeline>
<codeline lineno="981" refid="classfcmaes_1_1mapelites_1_1_archive_1a052f1f8d58ffc784ec8ee16aca535a14" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="982"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>`ys`<sp/>array.</highlight></codeline>
<codeline lineno="983"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="984"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>provides<sp/>access<sp/>to<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>`ys`<sp/>attribute,<sp/>ensuring</highlight></codeline>
<codeline lineno="985"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>that<sp/>the<sp/>original<sp/>data<sp/>remains<sp/>unaltered.</highlight></codeline>
<codeline lineno="986"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="987"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="988"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.ndarray:<sp/>A<sp/>numpy<sp/>array<sp/>representing<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>`ys`<sp/>attribute.</highlight></codeline>
<codeline lineno="989"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>np.array(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1acb4c09718b6457bb5bfbb7f3773f7178" kindref="member">ys</ref>[:])</highlight></codeline>
<codeline lineno="991"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="992"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a50c9e9bac3b339e4158614dad396bb18" kindref="member">get_qd_score</ref>(self)<sp/>-&gt;<sp/>float:</highlight></codeline>
<codeline lineno="993" refid="classfcmaes_1_1mapelites_1_1_archive_1af91d2fd25aee22c7bcc46b2c5cad0092" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="994"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Calculates<sp/>the<sp/>QD<sp/>(Quality-Diversity)<sp/>score<sp/>based<sp/>on<sp/>the<sp/>provided<sp/>array<sp/>of<sp/>values.</highlight></codeline>
<codeline lineno="995"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="996"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>method<sp/>processes<sp/>an<sp/>array<sp/>of<sp/>values<sp/>(`ys`)<sp/>to<sp/>compute<sp/>a<sp/>QD<sp/>score<sp/>using<sp/>either<sp/>the<sp/>sum<sp/>of<sp/>reciprocal</highlight></codeline>
<codeline lineno="997"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>values<sp/>for<sp/>positive<sp/>values<sp/>or<sp/>the<sp/>sum<sp/>of<sp/>negated<sp/>negative<sp/>values.<sp/>The<sp/>computed<sp/>score<sp/>is<sp/>dependent<sp/>on</highlight></codeline>
<codeline lineno="998"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>whether<sp/>all<sp/>the<sp/>values<sp/>in<sp/>the<sp/>array<sp/>are<sp/>positive<sp/>or<sp/>some<sp/>are<sp/>negative.</highlight></codeline>
<codeline lineno="999"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1000"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="1001"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>float:<sp/>The<sp/>calculated<sp/>QD<sp/>score.</highlight></codeline>
<codeline lineno="1002"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ys<sp/>=<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a91c9f1ac5485896833fc7b9859b85af1" kindref="member">get_ys</ref>()</highlight></codeline>
<codeline lineno="1004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>occupied<sp/>=<sp/>(ys<sp/>!=<sp/>np.inf)</highlight></codeline>
<codeline lineno="1005" refid="classfcmaes_1_1mapelites_1_1_archive_1ac9390a3bfd798bdb09d79476ed6c6584" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ys<sp/>=<sp/>ys[occupied]</highlight></codeline>
<codeline lineno="1006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>len(ys)<sp/>==<sp/>0:</highlight></codeline>
<codeline lineno="1007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0</highlight></codeline>
<codeline lineno="1008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>min_y<sp/>=<sp/>np.amin(ys)</highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>min_y<sp/>&gt;<sp/>0:<sp/></highlight><highlight class="comment">#<sp/>if<sp/>all<sp/>y<sp/>&gt;<sp/>0<sp/>use<sp/>sum<sp/>of<sp/>reciprocal</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>np.sum(np.reciprocal(ys,<sp/>where<sp/>=<sp/>ys!=0))<sp/></highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:<sp/></highlight><highlight class="comment">#<sp/>else<sp/>use<sp/>only<sp/>the<sp/>negative<sp/>ones</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>neg<sp/>=<sp/>(ys<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ys<sp/>=<sp/>ys[neg]</highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>np.sum(-ys)<sp/></highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1afc25798d5b07a1addd68fc50cec1f3e5" kindref="member">set_y</ref>(self,<sp/>i:<sp/>int,<sp/>y:<sp/>float):</highlight></codeline>
<codeline lineno="1017" refid="classfcmaes_1_1mapelites_1_1_archive_1a91c9f1ac5485896833fc7b9859b85af1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1018"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Updates<sp/>the<sp/>`ys`<sp/>attribute<sp/>at<sp/>the<sp/>specified<sp/>index<sp/>with<sp/>a<sp/>new<sp/>value.</highlight></codeline>
<codeline lineno="1019"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1020"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="1021"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>(int):<sp/>The<sp/>index<sp/>to<sp/>update<sp/>in<sp/>the<sp/>`ys`<sp/>attribute.</highlight></codeline>
<codeline lineno="1022"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y<sp/>(float):<sp/>The<sp/>new<sp/>value<sp/>to<sp/>set<sp/>at<sp/>the<sp/>specified<sp/>index.</highlight></codeline>
<codeline lineno="1023"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1acb4c09718b6457bb5bfbb7f3773f7178" kindref="member">ys</ref>[i]<sp/>=<sp/>y</highlight></codeline>
<codeline lineno="1025"><highlight class="normal"></highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a06c36a088a4f1f50b63e7d0cdf1dcc40" kindref="member">set_ys</ref>(self,<sp/>ys:<sp/>ArrayLike):</highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1028"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Sets<sp/>multiple<sp/>y-values<sp/>for<sp/>the<sp/>object<sp/>by<sp/>iterating<sp/>over<sp/>the<sp/>provided<sp/>array-like<sp/>collection.</highlight></codeline>
<codeline lineno="1029"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1030" refid="classfcmaes_1_1mapelites_1_1_archive_1a50c9e9bac3b339e4158614dad396bb18" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="1031"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ys<sp/>(ArrayLike):<sp/>An<sp/>array-like<sp/>collection<sp/>of<sp/>y-values<sp/>to<sp/>be<sp/>set.</highlight></codeline>
<codeline lineno="1032"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1033"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(len(ys)):</highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1afc25798d5b07a1addd68fc50cec1f3e5" kindref="member">set_y</ref>(i,<sp/>ys[i])</highlight></codeline>
<codeline lineno="1036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1037"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1ad3c852a54d31d2126b5f233e7d2fd7bb" kindref="member">get_c</ref>(self,<sp/>i:<sp/>int)<sp/>-&gt;<sp/>float:</highlight></codeline>
<codeline lineno="1038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1039"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Retrieves<sp/>a<sp/>slice<sp/>of<sp/>the<sp/>`cs`<sp/>list<sp/>for<sp/>the<sp/>given<sp/>index.</highlight></codeline>
<codeline lineno="1040"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1041"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="1042"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>(int):<sp/>Index<sp/>to<sp/>slice<sp/>the<sp/>`cs`<sp/>list.</highlight></codeline>
<codeline lineno="1043"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1044"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="1045"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>float:<sp/>The<sp/>extracted<sp/>portion<sp/>of<sp/>the<sp/>`cs`<sp/>list<sp/>corresponding<sp/>to<sp/>the</highlight></codeline>
<codeline lineno="1046"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>specified<sp/>index,<sp/>scaled<sp/>by<sp/>`qd_dim`.</highlight></codeline>
<codeline lineno="1047"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a2421ccea4dec3cbb9bef589d1a3209f9" kindref="member">cs</ref>[i*self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a7321ff2715dbc2d3258e2e880d48ef43" kindref="member">qd_dim</ref>:(i+1)*self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a7321ff2715dbc2d3258e2e880d48ef43" kindref="member">qd_dim</ref>]</highlight></codeline>
<codeline lineno="1049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1050"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a9884e6696809729e69a167c91d245464" kindref="member">get_cs</ref>(self)<sp/>-&gt;<sp/>np.ndarray:</highlight></codeline>
<codeline lineno="1051" refid="classfcmaes_1_1mapelites_1_1_archive_1afc25798d5b07a1addd68fc50cec1f3e5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1052"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Generates<sp/>an<sp/>array<sp/>of<sp/>results<sp/>produced<sp/>by<sp/>the<sp/>`get_c`<sp/>method<sp/>for<sp/>a<sp/>range</highlight></codeline>
<codeline lineno="1053"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>of<sp/>indices.</highlight></codeline>
<codeline lineno="1054"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1055"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>The<sp/>`get_cs`<sp/>method<sp/>computes<sp/>an<sp/>array<sp/>containing<sp/>the<sp/>output<sp/>of<sp/>the<sp/>`get_c`</highlight></codeline>
<codeline lineno="1056"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>method<sp/>for<sp/>a<sp/>sequence<sp/>of<sp/>indices<sp/>up<sp/>to<sp/>a<sp/>specified<sp/>capacity.<sp/>Each<sp/>index<sp/>is</highlight></codeline>
<codeline lineno="1057"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>processed<sp/>individually<sp/>to<sp/>construct<sp/>the<sp/>final<sp/>array.</highlight></codeline>
<codeline lineno="1058"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1059"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="1060"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.ndarray:<sp/>A<sp/>NumPy<sp/>array<sp/>comprising<sp/>results<sp/>obtained<sp/>from<sp/>the<sp/>`get_c`</highlight></codeline>
<codeline lineno="1061" refid="classfcmaes_1_1mapelites_1_1_archive_1a06c36a088a4f1f50b63e7d0cdf1dcc40" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>method<sp/>called<sp/>for<sp/>indices<sp/>ranging<sp/>from<sp/>0<sp/>to<sp/>the<sp/>object&apos;s<sp/>capacity.</highlight></codeline>
<codeline lineno="1062"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>np.array([self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ad3c852a54d31d2126b5f233e7d2fd7bb" kindref="member">get_c</ref>(i)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a543edcd72de56099d1f83c9dcd79e082" kindref="member">capacity</ref>)])</highlight></codeline>
<codeline lineno="1064"><highlight class="normal"></highlight></codeline>
<codeline lineno="1065"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1abf4f2d32b118fa044a6eb99d9b508c1f" kindref="member">get_cs_decoded</ref>(self)<sp/>-&gt;<sp/>np.ndarray:</highlight></codeline>
<codeline lineno="1066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1067"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns<sp/>decoded<sp/>data<sp/>using<sp/>the<sp/>decode_d<sp/>method.</highlight></codeline>
<codeline lineno="1068"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1069"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>retrieves<sp/>data<sp/>by<sp/>iterating<sp/>over<sp/>a<sp/>range<sp/>equivalent<sp/>to<sp/>the</highlight></codeline>
<codeline lineno="1070"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>capacity<sp/>attribute,<sp/>applies<sp/>the<sp/>get_c<sp/>method<sp/>to<sp/>each<sp/>index,<sp/>and<sp/>returns</highlight></codeline>
<codeline lineno="1071"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>results<sp/>as<sp/>a<sp/>NumPy<sp/>array.<sp/>The<sp/>resulting<sp/>array<sp/>is<sp/>then<sp/>passed<sp/>to<sp/>the</highlight></codeline>
<codeline lineno="1072"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>decode_d<sp/>method<sp/>to<sp/>decode<sp/>and<sp/>return<sp/>the<sp/>final<sp/>data.</highlight></codeline>
<codeline lineno="1073"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1074"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="1075" refid="classfcmaes_1_1mapelites_1_1_archive_1ad3c852a54d31d2126b5f233e7d2fd7bb" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.ndarray:<sp/>Decoded<sp/>data<sp/>obtained<sp/>from<sp/>processing<sp/>the<sp/>capacity<sp/>range.</highlight></codeline>
<codeline lineno="1076"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ae916520d6c7090a4aebb511b782f003c" kindref="member">decode_d</ref>(np.array([self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ad3c852a54d31d2126b5f233e7d2fd7bb" kindref="member">get_c</ref>(i)<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a543edcd72de56099d1f83c9dcd79e082" kindref="member">capacity</ref>)]))</highlight></codeline>
<codeline lineno="1078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1079"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1acb89d9fdd7c875d487477a461c3585f7" kindref="member">set_c</ref>(self,<sp/>i:<sp/>int,<sp/>c:<sp/>float):</highlight></codeline>
<codeline lineno="1080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Sets<sp/>the<sp/>values<sp/>of<sp/>a<sp/>specific<sp/>segment<sp/>of<sp/>the<sp/>&apos;cs&apos;<sp/>attribute.</highlight></codeline>
<codeline lineno="1081"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1082"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>updates<sp/>a<sp/>specific<sp/>segment<sp/>of<sp/>the<sp/>&apos;cs&apos;<sp/>attribute<sp/>based<sp/>on<sp/>the</highlight></codeline>
<codeline lineno="1083"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>provided<sp/>index<sp/>and<sp/>float<sp/>values.<sp/>The<sp/>index<sp/>determines<sp/>the<sp/>segment<sp/>of</highlight></codeline>
<codeline lineno="1084"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&apos;cs&apos;<sp/>to<sp/>be<sp/>updated,<sp/>while<sp/>the<sp/>float<sp/>input<sp/>defines<sp/>the<sp/>new<sp/>values<sp/>to</highlight></codeline>
<codeline lineno="1085"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assign<sp/>to<sp/>the<sp/>segment.</highlight></codeline>
<codeline lineno="1086"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1087"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="1088"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>(int):<sp/>Index<sp/>to<sp/>determine<sp/>the<sp/>specific<sp/>segment<sp/>of<sp/>&apos;cs&apos;<sp/>to<sp/>update.</highlight></codeline>
<codeline lineno="1089"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>c<sp/>(float):<sp/>New<sp/>float<sp/>value<sp/>that<sp/>will<sp/>replace<sp/>the<sp/>content<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="1090" refid="classfcmaes_1_1mapelites_1_1_archive_1a9884e6696809729e69a167c91d245464" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>specified<sp/>segment<sp/>in<sp/>&apos;cs&apos;.</highlight></codeline>
<codeline lineno="1091"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1092"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a2421ccea4dec3cbb9bef589d1a3209f9" kindref="member">cs</ref>[i*self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a7321ff2715dbc2d3258e2e880d48ef43" kindref="member">qd_dim</ref>:(i+1)*self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a7321ff2715dbc2d3258e2e880d48ef43" kindref="member">qd_dim</ref>]<sp/>=<sp/>c[:]</highlight></codeline>
<codeline lineno="1094"><highlight class="normal"></highlight></codeline>
<codeline lineno="1095"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a7b98c28bd774c39099d0e41b1c38459d" kindref="member">set_cs</ref>(self,<sp/>cs:<sp/>ArrayLike):</highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1097"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Sets<sp/>the<sp/>values<sp/>from<sp/>the<sp/>provided<sp/>array-like<sp/>object<sp/>to<sp/>the<sp/>internal<sp/>structure<sp/>by<sp/>calling</highlight></codeline>
<codeline lineno="1098"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>`set_c`<sp/>method<sp/>for<sp/>each<sp/>element<sp/>of<sp/>the<sp/>array-like<sp/>object.</highlight></codeline>
<codeline lineno="1099"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1100"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="1101"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cs<sp/>(ArrayLike):<sp/>An<sp/>array-like<sp/>object<sp/>containing<sp/>elements<sp/>to<sp/>be<sp/>set<sp/>using<sp/>`set_c`<sp/>method.</highlight></codeline>
<codeline lineno="1102"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(len(cs)):</highlight></codeline>
<codeline lineno="1104" refid="classfcmaes_1_1mapelites_1_1_archive_1abf4f2d32b118fa044a6eb99d9b508c1f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1acb89d9fdd7c875d487477a461c3585f7" kindref="member">set_c</ref>(i,<sp/>cs[i])</highlight></codeline>
<codeline lineno="1105"><highlight class="normal"></highlight></codeline>
<codeline lineno="1106"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a4a9c0d92560064a154b7bbcf1d537480" kindref="member">get_stat</ref>(self,<sp/>i:<sp/>int,<sp/>j:<sp/>int)<sp/>-&gt;<sp/>float:</highlight></codeline>
<codeline lineno="1107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1108"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Retrieves<sp/>a<sp/>specific<sp/>statistical<sp/>value<sp/>for<sp/>given<sp/>indices<sp/>i<sp/>and<sp/>j.<sp/>The<sp/>method</highlight></codeline>
<codeline lineno="1109"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>calculates<sp/>an<sp/>index<sp/>based<sp/>on<sp/>the<sp/>input<sp/>values<sp/>and<sp/>extracts<sp/>the<sp/>corresponding</highlight></codeline>
<codeline lineno="1110"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dimension<sp/>slice<sp/>from<sp/>the<sp/>stats<sp/>attribute.</highlight></codeline>
<codeline lineno="1111"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1112"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="1113"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>(int):<sp/>Represents<sp/>the<sp/>first<sp/>index<sp/>to<sp/>calculate<sp/>the<sp/>position.</highlight></codeline>
<codeline lineno="1114"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>j<sp/>(int):<sp/>Represents<sp/>the<sp/>second<sp/>index<sp/>to<sp/>calculate<sp/>the<sp/>position.</highlight></codeline>
<codeline lineno="1115"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1116"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="1117"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>float:<sp/>A<sp/>specific<sp/>statistical<sp/>value<sp/>derived<sp/>from<sp/>the<sp/>stats<sp/>attribute.</highlight></codeline>
<codeline lineno="1118"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>4*i+j</highlight></codeline>
<codeline lineno="1120" refid="classfcmaes_1_1mapelites_1_1_archive_1acb89d9fdd7c875d487477a461c3585f7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ada2a26ca8d9683a969403f104a759c61" kindref="member">stats</ref>[p*self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab255103df42bedc30ec7132cfc618122" kindref="member">dim</ref>:(p+1)*self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab255103df42bedc30ec7132cfc618122" kindref="member">dim</ref>]</highlight></codeline>
<codeline lineno="1121"><highlight class="normal"></highlight></codeline>
<codeline lineno="1122"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a97f1345584f4d25bd8a24af6cb7d7e4c" kindref="member">get_stats</ref>(self)<sp/>-&gt;<sp/><sp/>np.ndarray:</highlight></codeline>
<codeline lineno="1123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1124"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>stats<sp/>data<sp/>as<sp/>a<sp/>NumPy<sp/>array.</highlight></codeline>
<codeline lineno="1125"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1126"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>provides<sp/>access<sp/>to<sp/>the<sp/>current<sp/>statistical<sp/>data<sp/>by<sp/>returning<sp/>a</highlight></codeline>
<codeline lineno="1127"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NumPy<sp/>array<sp/>that<sp/>contains<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>internal<sp/>stats<sp/>data.</highlight></codeline>
<codeline lineno="1128"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1129"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="1130" refid="classfcmaes_1_1mapelites_1_1_archive_1a7b98c28bd774c39099d0e41b1c38459d" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.ndarray:<sp/>A<sp/>NumPy<sp/>array<sp/>containing<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>stats<sp/>data.</highlight></codeline>
<codeline lineno="1131"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>np.array(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ada2a26ca8d9683a969403f104a759c61" kindref="member">stats</ref>[:])</highlight></codeline>
<codeline lineno="1133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1134"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a574aed6e61fc20fb94b479cb8fd5fc55" kindref="member">set_stat</ref>(self,<sp/>i:<sp/>int,<sp/>j:<sp/>int,<sp/>stat:<sp/>ArrayLike):</highlight></codeline>
<codeline lineno="1135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1136"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Sets<sp/>a<sp/>specific<sp/>portion<sp/>of<sp/>the<sp/>stats<sp/>array<sp/>based<sp/>on<sp/>the<sp/>given<sp/>indices<sp/>and<sp/>data.</highlight></codeline>
<codeline lineno="1137"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1138"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>function<sp/>updates<sp/>the<sp/>stats<sp/>array<sp/>by<sp/>calculating<sp/>an<sp/>index<sp/>position<sp/>derived<sp/>from</highlight></codeline>
<codeline lineno="1139"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>given<sp/>indices<sp/>`i`<sp/>and<sp/>`j`.<sp/>The<sp/>data<sp/>in<sp/>`stat`<sp/>is<sp/>then<sp/>inserted<sp/>into<sp/>the<sp/>stats<sp/>array</highlight></codeline>
<codeline lineno="1140"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>at<sp/>a<sp/>position<sp/>determined<sp/>by<sp/>the<sp/>indices<sp/>and<sp/>the<sp/>object&apos;s<sp/>dimension<sp/>property.</highlight></codeline>
<codeline lineno="1141"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1142"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="1143"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>(int):<sp/>Row<sp/>index<sp/>used<sp/>to<sp/>determine<sp/>the<sp/>position<sp/>in<sp/>the<sp/>stats<sp/>array.</highlight></codeline>
<codeline lineno="1144"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>j<sp/>(int):<sp/>Column<sp/>index<sp/>used<sp/>to<sp/>determine<sp/>the<sp/>position<sp/>in<sp/>the<sp/>stats<sp/>array.</highlight></codeline>
<codeline lineno="1145"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stat<sp/>(ArrayLike):<sp/>Array<sp/>of<sp/>statistical<sp/>data<sp/>to<sp/>update<sp/>the<sp/>stats<sp/>array.</highlight></codeline>
<codeline lineno="1146" refid="classfcmaes_1_1mapelites_1_1_archive_1a4a9c0d92560064a154b7bbcf1d537480" refkind="member"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1147"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>4*i+j</highlight></codeline>
<codeline lineno="1149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ada2a26ca8d9683a969403f104a759c61" kindref="member">stats</ref>[p*self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab255103df42bedc30ec7132cfc618122" kindref="member">dim</ref>:(p+1)*self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ab255103df42bedc30ec7132cfc618122" kindref="member">dim</ref>]<sp/>=<sp/>stat[:]</highlight></codeline>
<codeline lineno="1150"><highlight class="normal"></highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a0e469ed5be63b9dd87ea220095b620b8" kindref="member">set_stats</ref>(self,<sp/>stats:<sp/>ArrayLike):</highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1153"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Sets<sp/>the<sp/>statistics<sp/>for<sp/>the<sp/>object.</highlight></codeline>
<codeline lineno="1154"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1155"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>updates<sp/>the<sp/>internal<sp/>statistics<sp/>of<sp/>the<sp/>object<sp/>with<sp/>the<sp/>values</highlight></codeline>
<codeline lineno="1156"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>provided<sp/>in<sp/>the<sp/>input<sp/>array.<sp/>The<sp/>values<sp/>in<sp/>the<sp/>input<sp/>array<sp/>are<sp/>assigned</highlight></codeline>
<codeline lineno="1157"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>directly<sp/>to<sp/>the<sp/>object&apos;s<sp/>statistics.</highlight></codeline>
<codeline lineno="1158"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1159" refid="classfcmaes_1_1mapelites_1_1_archive_1a97f1345584f4d25bd8a24af6cb7d7e4c" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="1160"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>stats<sp/>(ArrayLike):<sp/>The<sp/>array-like<sp/>object<sp/>containing<sp/>the<sp/>new<sp/>statistics<sp/>to</highlight></codeline>
<codeline lineno="1161"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>be<sp/>set.<sp/>It<sp/>must<sp/>be<sp/>compatible<sp/>with<sp/>the<sp/>internal<sp/>statistics<sp/>structure</highlight></codeline>
<codeline lineno="1162"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>of<sp/>the<sp/>object.</highlight></codeline>
<codeline lineno="1163"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ada2a26ca8d9683a969403f104a759c61" kindref="member">stats</ref>[:]<sp/>=<sp/>stats[:]</highlight></codeline>
<codeline lineno="1165"><highlight class="normal"></highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a5721ccf23e8de4509bc3a9e996e1861a" kindref="member">random_xs</ref>(self,<sp/>best_n:<sp/>int,<sp/>chunk_size:<sp/>int,<sp/>rg:<sp/>Generator)<sp/>-&gt;<sp/>np.ndarray:</highlight></codeline>
<codeline lineno="1167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1168"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Generates<sp/>a<sp/>random<sp/>selection<sp/>of<sp/>indices<sp/>and<sp/>returns<sp/>corresponding<sp/>elements<sp/>from<sp/>the<sp/>view.</highlight></codeline>
<codeline lineno="1169"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1170"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>function<sp/>utilizes<sp/>a<sp/>random<sp/>number<sp/>generator<sp/>to<sp/>produce<sp/>a<sp/>set<sp/>of<sp/>indices<sp/>based<sp/>on</highlight></codeline>
<codeline lineno="1171"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>provided<sp/>parameters<sp/>and<sp/>returns<sp/>the<sp/>corresponding<sp/>elements<sp/>from<sp/>an<sp/>internal<sp/>view.</highlight></codeline>
<codeline lineno="1172"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1173"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="1174"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>best_n<sp/>(int):<sp/>The<sp/>upper<sp/>limit<sp/>for<sp/>the<sp/>random<sp/>integer<sp/>selection<sp/>range.</highlight></codeline>
<codeline lineno="1175" refid="classfcmaes_1_1mapelites_1_1_archive_1a574aed6e61fc20fb94b479cb8fd5fc55" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>chunk_size<sp/>(int):<sp/>The<sp/>number<sp/>of<sp/>random<sp/>integers<sp/>to<sp/>select.</highlight></codeline>
<codeline lineno="1176"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rg<sp/>(Generator):<sp/>A<sp/>random<sp/>number<sp/>generator<sp/>instance<sp/>to<sp/>produce<sp/>the<sp/>selection.</highlight></codeline>
<codeline lineno="1177"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1178"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="1179"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.ndarray:<sp/>The<sp/>array<sp/>of<sp/>selected<sp/>elements<sp/>corresponding<sp/>to<sp/>the<sp/>randomly<sp/>generated<sp/>indices.</highlight></codeline>
<codeline lineno="1180"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>selection<sp/>=<sp/>rg.integers(0,<sp/>best_n,<sp/>chunk_size)</highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>best_n<sp/>&lt;<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a543edcd72de56099d1f83c9dcd79e082" kindref="member">capacity</ref>:<sp/></highlight></codeline>
<codeline lineno="1183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>selection<sp/>=<sp/>np.fromiter((self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1aa1482261105e35a39ca342dd76b15a18" kindref="member">si</ref>[i]<sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>selection),<sp/>dtype=int)</highlight></codeline>
<codeline lineno="1184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a6cbf2375b7948682ad57e3ef3d2f1dcb" kindref="member">xs_view</ref>[selection]</highlight></codeline>
<codeline lineno="1185"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1186"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a691e8315e1b9c8d92b67520216c72cdf" kindref="member">random_xs_one</ref>(self,<sp/>best_n:<sp/>int,<sp/>rg:<sp/>Generator)<sp/>-&gt;<sp/>Tuple[np.ndarray,<sp/>float,<sp/>int]:</highlight></codeline>
<codeline lineno="1187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1188"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Selects<sp/>and<sp/>retrieves<sp/>random<sp/>elements<sp/>based<sp/>on<sp/>the<sp/>given<sp/>range<sp/>and<sp/>size.</highlight></codeline>
<codeline lineno="1189"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1190"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>function<sp/>utilizes<sp/>a<sp/>random<sp/>number<sp/>generator<sp/>to<sp/>select<sp/>an<sp/>index<sp/>from<sp/>a<sp/>range</highlight></codeline>
<codeline lineno="1191" refid="classfcmaes_1_1mapelites_1_1_archive_1a0e469ed5be63b9dd87ea220095b620b8" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>up<sp/>to<sp/>`best_n`<sp/>and<sp/>fetch<sp/>the<sp/>corresponding<sp/>elements.</highlight></codeline>
<codeline lineno="1192"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1193"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="1194"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>best_n:<sp/>The<sp/>upper<sp/>limit<sp/>(exclusive)<sp/>for<sp/>selecting<sp/>a<sp/>random<sp/>index,<sp/>provided</highlight></codeline>
<codeline lineno="1195"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>as<sp/>an<sp/>integer.</highlight></codeline>
<codeline lineno="1196"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rg:<sp/>An<sp/>instance<sp/>of<sp/>a<sp/>random<sp/>number<sp/>generator<sp/>implementing<sp/>the<sp/>`Generator`</highlight></codeline>
<codeline lineno="1197"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interface,<sp/>used<sp/>for<sp/>generating<sp/>random<sp/>numbers.</highlight></codeline>
<codeline lineno="1198"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1199"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="1200"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>A<sp/>tuple<sp/>containing:</highlight></codeline>
<codeline lineno="1201"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>The<sp/>randomly<sp/>selected<sp/>x-coordinate<sp/>as<sp/>a<sp/>numpy<sp/>array.</highlight></codeline>
<codeline lineno="1202"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>The<sp/>corresponding<sp/>y-coordinate<sp/>as<sp/>a<sp/>float.</highlight></codeline>
<codeline lineno="1203"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>The<sp/>randomly<sp/>chosen<sp/>index<sp/>as<sp/>an<sp/>integer.</highlight></codeline>
<codeline lineno="1204"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>int(rg.random()*best_n)</highlight></codeline>
<codeline lineno="1206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.get_x(i),<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1ac9390a3bfd798bdb09d79476ed6c6584" kindref="member">get_y</ref>(i),<sp/><sp/>i</highlight></codeline>
<codeline lineno="1207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1208" refid="classfcmaes_1_1mapelites_1_1_archive_1a5721ccf23e8de4509bc3a9e996e1861a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1abf0a5f4c90fb9600c527281e0e6b37bf" kindref="member">argsort</ref>(self)<sp/>-&gt;<sp/>np.ndarray:</highlight></codeline>
<codeline lineno="1209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1210"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Sorts<sp/>the<sp/>indices<sp/>of<sp/>the<sp/>array<sp/>returned<sp/>by<sp/>`get_ys()`<sp/>in<sp/>ascending<sp/>order.</highlight></codeline>
<codeline lineno="1211"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1212"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>sorts<sp/>the<sp/>elements<sp/>of<sp/>the<sp/>array<sp/>obtained<sp/>by<sp/>calling<sp/>`get_ys()`<sp/>and</highlight></codeline>
<codeline lineno="1213"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>returns<sp/>the<sp/>indices<sp/>that<sp/>would<sp/>sort<sp/>this<sp/>array<sp/>in<sp/>ascending<sp/>order.<sp/>The<sp/>sorted</highlight></codeline>
<codeline lineno="1214"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>indices<sp/>are<sp/>also<sp/>stored<sp/>in<sp/>the<sp/>`si`<sp/>attribute<sp/>for<sp/>future<sp/>use.</highlight></codeline>
<codeline lineno="1215"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1216"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="1217"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.ndarray:<sp/>The<sp/>indices<sp/>that<sp/>would<sp/>sort<sp/>the<sp/>array<sp/>in<sp/>ascending<sp/>order.</highlight></codeline>
<codeline lineno="1218"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1aa1482261105e35a39ca342dd76b15a18" kindref="member">si</ref><sp/>=<sp/>np.argsort(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a91c9f1ac5485896833fc7b9859b85af1" kindref="member">get_ys</ref>())</highlight></codeline>
<codeline lineno="1220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1aa1482261105e35a39ca342dd76b15a18" kindref="member">si</ref></highlight></codeline>
<codeline lineno="1221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1222"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a0bcd8007cc5cf709da8ccc42aa2c46eb" kindref="member">dump</ref>(self,<sp/>n:<sp/>Optional[int]<sp/>=<sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="1223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1224"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Prints<sp/>a<sp/>sorted<sp/>dump<sp/>of<sp/>data<sp/>points<sp/>up<sp/>to<sp/>the<sp/>specified<sp/>limit.</highlight></codeline>
<codeline lineno="1225"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1226"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>retrieves<sp/>a<sp/>list<sp/>of<sp/>data<sp/>points<sp/>(`ys`),<sp/>sorts<sp/>them<sp/>in<sp/>ascending</highlight></codeline>
<codeline lineno="1227"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>order,<sp/>and<sp/>prints<sp/>the<sp/>indices,<sp/>values,<sp/>additional<sp/>details,<sp/>and<sp/>associated</highlight></codeline>
<codeline lineno="1228"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>features<sp/>for<sp/>the<sp/>top<sp/>`n`<sp/>data<sp/>points.<sp/>If<sp/>`n`<sp/>is<sp/>not<sp/>specified,<sp/>it<sp/>defaults<sp/>to</highlight></codeline>
<codeline lineno="1229"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>object&apos;s<sp/>capacity.</highlight></codeline>
<codeline lineno="1230"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1231"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="1232" refid="classfcmaes_1_1mapelites_1_1_archive_1a691e8315e1b9c8d92b67520216c72cdf" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n:<sp/>Optional[int],<sp/>optional.<sp/>The<sp/>number<sp/>of<sp/>data<sp/>points<sp/>to<sp/>print.<sp/>Defaults<sp/>to</highlight></codeline>
<codeline lineno="1233"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>object&apos;s<sp/>capacity.</highlight></codeline>
<codeline lineno="1234"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>n<sp/></highlight><highlight class="keywordflow">is</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">None</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>=<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a543edcd72de56099d1f83c9dcd79e082" kindref="member">capacity</ref></highlight></codeline>
<codeline lineno="1237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ys<sp/>=<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a91c9f1ac5485896833fc7b9859b85af1" kindref="member">get_ys</ref>()</highlight></codeline>
<codeline lineno="1238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>si<sp/>=<sp/>np.argsort(ys)</highlight></codeline>
<codeline lineno="1239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>i<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>range(n):</highlight></codeline>
<codeline lineno="1240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(si[i],<sp/>ys[si[i]],<sp/>self.get_d(si[i]),<sp/>self.get_x(si[i]))<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1241"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1242"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1a4299111d24891cea4a03c19f28360923" kindref="member">info</ref>(self)<sp/>-&gt;<sp/>str:</highlight></codeline>
<codeline lineno="1243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1244"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Generates<sp/>a<sp/>formatted<sp/>string<sp/>containing<sp/>key<sp/>metrics.</highlight></codeline>
<codeline lineno="1245"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1246" refid="classfcmaes_1_1mapelites_1_1_archive_1abf0a5f4c90fb9600c527281e0e6b37bf" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>method<sp/>calculates<sp/>and<sp/>returns<sp/>a<sp/>string<sp/>with<sp/>the<sp/>following<sp/>information:</highlight></codeline>
<codeline lineno="1247" refid="classfcmaes_1_1mapelites_1_1_archive_1aa1482261105e35a39ca342dd76b15a18" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>occupied<sp/>cells,<sp/>the<sp/>quality<sp/>diversity<sp/>(QD)<sp/>score,<sp/>the<sp/>lowest<sp/>value<sp/>from</highlight></codeline>
<codeline lineno="1248"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>a<sp/>collection<sp/>of<sp/>data<sp/>(&apos;ys&apos;),<sp/>and<sp/>the<sp/>total<sp/>count<sp/>of<sp/>items.<sp/>The<sp/>output<sp/>is</highlight></codeline>
<codeline lineno="1249"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>formatted<sp/>as<sp/>a<sp/>single<sp/>string.</highlight></codeline>
<codeline lineno="1250"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1251"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="1252"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>str:<sp/>A<sp/>formatted<sp/>string<sp/>that<sp/>includes<sp/>occupied<sp/>cells,<sp/>QD<sp/>score<sp/>rounded</highlight></codeline>
<codeline lineno="1253"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>three<sp/>decimal<sp/>places,<sp/>the<sp/>minimum<sp/>value<sp/>from<sp/>&apos;ys&apos;<sp/>rounded<sp/>to<sp/>three</highlight></codeline>
<codeline lineno="1254"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>decimal<sp/>places,<sp/>and<sp/>the<sp/>total<sp/>count<sp/>of<sp/>items.</highlight></codeline>
<codeline lineno="1255"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>occ<sp/>=<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a7d6497547e738f46792eed929c0eb09c" kindref="member">get_occupied</ref>()</highlight></codeline>
<codeline lineno="1257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>score<sp/>=<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a50c9e9bac3b339e4158614dad396bb18" kindref="member">get_qd_score</ref>()</highlight></codeline>
<codeline lineno="1258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>best_y<sp/>=<sp/>np.amin(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1a91c9f1ac5485896833fc7b9859b85af1" kindref="member">get_ys</ref>())</highlight></codeline>
<codeline lineno="1259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>count<sp/>=<sp/>np.sum(self.<ref refid="classfcmaes_1_1mapelites_1_1_archive_1abfbc79753a308a9880da632d96b37d5c" kindref="member">get_counts</ref>())</highlight></codeline>
<codeline lineno="1260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>f</highlight><highlight class="stringliteral">&apos;{occ}<sp/>{score:.3f}<sp/>{best_y:.3f}<sp/>{count}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1261"><highlight class="normal"></highlight></codeline>
<codeline lineno="1262" refid="classfcmaes_1_1mapelites_1_1_archive_1a0bcd8007cc5cf709da8ccc42aa2c46eb" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1wrapper" kindref="compound">wrapper</ref>(object):</highlight></codeline>
<codeline lineno="1263"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;A<sp/>callable<sp/>class<sp/>designed<sp/>to<sp/>fit<sp/>and<sp/>evaluate<sp/>a<sp/>function<sp/>with<sp/>given<sp/>inputs.</highlight></codeline>
<codeline lineno="1264"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1265"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>class<sp/>acts<sp/>as<sp/>a<sp/>wrapper<sp/>that<sp/>integrates<sp/>a<sp/>user-defined<sp/>fitness<sp/>function.<sp/>It<sp/>manages</highlight></codeline>
<codeline lineno="1266"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>the<sp/>evaluation<sp/>count,<sp/>best<sp/>fitness<sp/>values,<sp/>and<sp/>optional<sp/>logging<sp/>and<sp/>saving<sp/>mechanisms<sp/>for</highlight></codeline>
<codeline lineno="1267"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>performance<sp/>monitoring.<sp/>It<sp/>is<sp/>particularly<sp/>useful<sp/>for<sp/>optimization<sp/>tasks<sp/>that<sp/>leverage</highlight></codeline>
<codeline lineno="1268"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>multi-processing<sp/>for<sp/>concurrent<sp/>evaluations.</highlight></codeline>
<codeline lineno="1269"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1270"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Attributes:</highlight></codeline>
<codeline lineno="1271"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fit<sp/>(Callable[[ArrayLike],<sp/>Tuple[float,<sp/>np.ndarray]]):<sp/>The<sp/>user-defined<sp/>function</highlight></codeline>
<codeline lineno="1272"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>that<sp/>computes<sp/>the<sp/>fitness<sp/>value<sp/>and<sp/>its<sp/>associated<sp/>descriptors<sp/>for<sp/>a<sp/>given<sp/>input.</highlight></codeline>
<codeline lineno="1273"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>evals<sp/>(multiprocessing.RawValue):<sp/>A<sp/>counter<sp/>for<sp/>the<sp/>number<sp/>of<sp/>evaluations<sp/>performed.</highlight></codeline>
<codeline lineno="1274"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1275"><highlight class="normal"></highlight></codeline>
<codeline lineno="1276"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1_archive_1ae996ab317d60b697d3c339df9335a60f" kindref="member">__init__</ref>(self,<sp/></highlight></codeline>
<codeline lineno="1277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fit:Callable[[ArrayLike],<sp/>Tuple[float,<sp/>np.ndarray]],<sp/></highlight></codeline>
<codeline lineno="1278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qd_dim:<sp/>int,<sp/></highlight></codeline>
<codeline lineno="1279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interval:<sp/>Optional[int]<sp/>=<sp/>1000000,</highlight></codeline>
<codeline lineno="1280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>save_interval:<sp/>Optional[int]<sp/>=<sp/>1E20):</highlight></codeline>
<codeline lineno="1281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1282"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Initializes<sp/>a<sp/>new<sp/>instance<sp/>of<sp/>the<sp/>class.</highlight></codeline>
<codeline lineno="1283" refid="classfcmaes_1_1mapelites_1_1_archive_1a4299111d24891cea4a03c19f28360923" refkind="member"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1284"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>constructor<sp/>sets<sp/>up<sp/>the<sp/>main<sp/>attributes<sp/>required<sp/>for<sp/>the<sp/>class,<sp/>including</highlight></codeline>
<codeline lineno="1285"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>fitness<sp/>function,<sp/>dimensionality<sp/>of<sp/>the<sp/>optimization<sp/>problem,<sp/>evaluation</highlight></codeline>
<codeline lineno="1286"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>intervals,<sp/>and<sp/>other<sp/>related<sp/>parameters.</highlight></codeline>
<codeline lineno="1287"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1288"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="1289"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fit<sp/>(Callable[[ArrayLike],<sp/>Tuple[float,<sp/>np.ndarray]]):<sp/>Fitness<sp/>function<sp/>used</highlight></codeline>
<codeline lineno="1290"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>evaluate<sp/>solutions.<sp/>It<sp/>should<sp/>take<sp/>an<sp/>input<sp/>of<sp/>type<sp/>ArrayLike<sp/>and</highlight></codeline>
<codeline lineno="1291"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>return<sp/>a<sp/>tuple<sp/>containing<sp/>a<sp/>float<sp/>and<sp/>an<sp/>np.ndarray.</highlight></codeline>
<codeline lineno="1292"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>qd_dim<sp/>(int):<sp/>Dimensionality<sp/>of<sp/>the<sp/>search/solution<sp/>space<sp/>to<sp/>be<sp/>optimized.</highlight></codeline>
<codeline lineno="1293"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>interval<sp/>(Optional[int]):<sp/>Interval<sp/>for<sp/>certain<sp/>operations<sp/>during<sp/>optimization.</highlight></codeline>
<codeline lineno="1294"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Defaults<sp/>to<sp/>1,000,000<sp/>if<sp/>not<sp/>specified.</highlight></codeline>
<codeline lineno="1295"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>save_interval<sp/>(Optional[int]):<sp/>Interval<sp/>for<sp/>saving<sp/>checkpoints.<sp/>Defaults<sp/>to</highlight></codeline>
<codeline lineno="1296"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>an<sp/>extremely<sp/>high<sp/>value<sp/>(1E20)<sp/>if<sp/>not<sp/>specified.</highlight></codeline>
<codeline lineno="1297"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.fit<sp/>=<sp/>fit</highlight></codeline>
<codeline lineno="1299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.evals<sp/>=<sp/>mp.RawValue(ct.c_int,<sp/>0)<sp/></highlight></codeline>
<codeline lineno="1300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.best_y<sp/>=<sp/>mp.RawValue(ct.c_double,<sp/>np.inf)<sp/></highlight></codeline>
<codeline lineno="1301" refid="classfcmaes_1_1mapelites_1_1wrapper" refkind="compound"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1wrapper_1a93873c0c4890d0bed1501c112c96cd3a" kindref="member">t0</ref><sp/>=<sp/>perf_counter()</highlight></codeline>
<codeline lineno="1302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1wrapper_1a02e60134786bef32dc1cc014911d00f8" kindref="member">qd_dim</ref><sp/>=<sp/>qd_dim</highlight></codeline>
<codeline lineno="1303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1wrapper_1a56117fe62174acee95b94c3635fc3b0b" kindref="member">interval</ref><sp/>=<sp/>interval</highlight></codeline>
<codeline lineno="1304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1wrapper_1a7550f0855e16b0f05f68bfe285d9960c" kindref="member">save_interval</ref><sp/>=<sp/>save_interval</highlight></codeline>
<codeline lineno="1305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1wrapper_1ac4dfd1c8307fa5f6c607ff70ac71f3ee" kindref="member">lock</ref><sp/>=<sp/>mp.Lock()</highlight></codeline>
<codeline lineno="1306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1307"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1wrapper_1aef447c485c8dad313f64e3df4768218e" kindref="member">__call__</ref>(self,<sp/>x:<sp/>ArrayLike):</highlight></codeline>
<codeline lineno="1308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1309"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Handles<sp/>the<sp/>evaluation<sp/>of<sp/>input<sp/>data,<sp/>including<sp/>logging<sp/>and<sp/>archiving<sp/>results,<sp/>while<sp/>maintaining</highlight></codeline>
<codeline lineno="1310"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>state<sp/>of<sp/>evaluations,<sp/>the<sp/>best<sp/>observed<sp/>outcome,<sp/>and<sp/>potential<sp/>exceptions<sp/>during<sp/>execution.</highlight></codeline>
<codeline lineno="1311"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1312"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="1313"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>(ArrayLike):<sp/>Input<sp/>data<sp/>array<sp/>to<sp/>be<sp/>evaluated.</highlight></codeline>
<codeline lineno="1314"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1315"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="1316"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tuple:<sp/>A<sp/>tuple<sp/>containing:</highlight></codeline>
<codeline lineno="1317"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>A<sp/>float<sp/>value<sp/>representing<sp/>the<sp/>evaluation<sp/>result<sp/>or<sp/>`np.inf`<sp/>if<sp/>the<sp/>result<sp/>is<sp/>invalid.</highlight></codeline>
<codeline lineno="1318"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>A<sp/>numpy<sp/>array<sp/>representing<sp/>the<sp/>descriptor<sp/>or<sp/>a<sp/>zero<sp/>array<sp/>if<sp/>the<sp/>result<sp/>is<sp/>invalid.</highlight></codeline>
<codeline lineno="1319"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1320"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Raises:</highlight></codeline>
<codeline lineno="1321"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Exception:<sp/>Logs<sp/>the<sp/>exception<sp/>details<sp/>if<sp/>execution<sp/>fails.</highlight></codeline>
<codeline lineno="1322"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1323" refid="classfcmaes_1_1mapelites_1_1wrapper_1aabff3459c811afa2fde70139254db138" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>np.isnan(x).any():</highlight></codeline>
<codeline lineno="1325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>np.inf,<sp/>np.zeros(self.<ref refid="classfcmaes_1_1mapelites_1_1wrapper_1a02e60134786bef32dc1cc014911d00f8" kindref="member">qd_dim</ref>)</highlight></codeline>
<codeline lineno="1326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">with</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1wrapper_1ac4dfd1c8307fa5f6c607ff70ac71f3ee" kindref="member">lock</ref>:</highlight></codeline>
<codeline lineno="1327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1wrapper_1a8ea76006dbf24383642dea6e049cbf21" kindref="member">evals</ref>.value<sp/>+=<sp/>1</highlight></codeline>
<codeline lineno="1328" refid="classfcmaes_1_1mapelites_1_1wrapper_1a3dcdc7f9a349494aad1b493a11cd42af" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>log<sp/>=<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1wrapper_1a8ea76006dbf24383642dea6e049cbf21" kindref="member">evals</ref>.value<sp/>%<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1wrapper_1a56117fe62174acee95b94c3635fc3b0b" kindref="member">interval</ref><sp/>==<sp/>0</highlight></codeline>
<codeline lineno="1329" refid="classfcmaes_1_1mapelites_1_1wrapper_1a8ea76006dbf24383642dea6e049cbf21" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>save<sp/>=<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1wrapper_1a8ea76006dbf24383642dea6e049cbf21" kindref="member">evals</ref>.value<sp/>%<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1wrapper_1a7550f0855e16b0f05f68bfe285d9960c" kindref="member">save_interval</ref><sp/>==<sp/>0</highlight></codeline>
<codeline lineno="1330" refid="classfcmaes_1_1mapelites_1_1wrapper_1ab23032c564e05c9cd76c2040c1ed9ac3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y,<sp/>desc<sp/>=<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1wrapper_1a3dcdc7f9a349494aad1b493a11cd42af" kindref="member">fit</ref>(x)</highlight></codeline>
<codeline lineno="1331" refid="classfcmaes_1_1mapelites_1_1wrapper_1a93873c0c4890d0bed1501c112c96cd3a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>np.isnan(y)<sp/></highlight><highlight class="keywordflow">or</highlight><highlight class="normal"><sp/>np.isnan(desc).any():</highlight></codeline>
<codeline lineno="1332" refid="classfcmaes_1_1mapelites_1_1wrapper_1a02e60134786bef32dc1cc014911d00f8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>np.inf,<sp/>np.zeros(self.<ref refid="classfcmaes_1_1mapelites_1_1wrapper_1a02e60134786bef32dc1cc014911d00f8" kindref="member">qd_dim</ref>)</highlight></codeline>
<codeline lineno="1333" refid="classfcmaes_1_1mapelites_1_1wrapper_1a56117fe62174acee95b94c3635fc3b0b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y0<sp/>=<sp/>y<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>np.isscalar(y)<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>sum(y)</highlight></codeline>
<codeline lineno="1334" refid="classfcmaes_1_1mapelites_1_1wrapper_1a7550f0855e16b0f05f68bfe285d9960c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>y0<sp/>&lt;<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1wrapper_1ab23032c564e05c9cd76c2040c1ed9ac3" kindref="member">best_y</ref>.value:</highlight></codeline>
<codeline lineno="1335" refid="classfcmaes_1_1mapelites_1_1wrapper_1ac4dfd1c8307fa5f6c607ff70ac71f3ee" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1wrapper_1ab23032c564e05c9cd76c2040c1ed9ac3" kindref="member">best_y</ref>.value<sp/>=<sp/>y0</highlight></codeline>
<codeline lineno="1336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>log<sp/>=<sp/></highlight><highlight class="keyword">True</highlight><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="1337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>log:</highlight></codeline>
<codeline lineno="1338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>archinfo<sp/>=<sp/>self.archive.info()<sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>hasattr(self,<sp/></highlight><highlight class="stringliteral">&apos;archive&apos;</highlight><highlight class="normal">)<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&apos;&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>logger.info(</highlight></codeline>
<codeline lineno="1340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f</highlight><highlight class="stringliteral">&apos;{dtime(self.t0)}<sp/>{archinfo}<sp/>{self.evals.value:.0f}<sp/>{self.evals.value/(1E-9<sp/>+<sp/>dtime(self.t0)):.1f}<sp/>{self.best_y.value:.3f}<sp/>{list(x)}&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>save<sp/></highlight><highlight class="keywordflow">and</highlight><highlight class="normal"><sp/>hasattr(self,<sp/></highlight><highlight class="stringliteral">&apos;archive&apos;</highlight><highlight class="normal">):</highlight></codeline>
<codeline lineno="1343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.archive.save(f</highlight><highlight class="stringliteral">&apos;{self.evals.value}&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>y,<sp/>desc</highlight></codeline>
<codeline lineno="1345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">except</highlight><highlight class="normal"><sp/>Exception<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>ex:</highlight></codeline>
<codeline lineno="1346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>print(str(ex))<sp/><sp/></highlight></codeline>
<codeline lineno="1347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>np.inf,<sp/>np.zeros(self.<ref refid="classfcmaes_1_1mapelites_1_1wrapper_1a02e60134786bef32dc1cc014911d00f8" kindref="member">qd_dim</ref>)</highlight></codeline>
<codeline lineno="1348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1349"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1in__niche__filter" kindref="compound">in_niche_filter</ref>(object):</highlight></codeline>
<codeline lineno="1350"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;Filters<sp/>and<sp/>evaluates<sp/>data<sp/>based<sp/>on<sp/>niche<sp/>and<sp/>fitness<sp/>criteria.</highlight></codeline>
<codeline lineno="1351"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1352" refid="classfcmaes_1_1mapelites_1_1wrapper_1aef447c485c8dad313f64e3df4768218e" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>class<sp/>determines<sp/>whether<sp/>a<sp/>given<sp/>data<sp/>point<sp/>belongs<sp/>to<sp/>a<sp/>specific<sp/>niche</highlight></codeline>
<codeline lineno="1353"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>and<sp/>evaluates<sp/>it<sp/>based<sp/>on<sp/>a<sp/>fitness<sp/>function.<sp/>If<sp/>the<sp/>data<sp/>point<sp/>does<sp/>not<sp/>belong</highlight></codeline>
<codeline lineno="1354"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>to<sp/>the<sp/>specified<sp/>niche,<sp/>it<sp/>assigns<sp/>an<sp/>infinite<sp/>fitness<sp/>value<sp/>to<sp/>indicate<sp/>that</highlight></codeline>
<codeline lineno="1355"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>the<sp/>point<sp/>is<sp/>not<sp/>relevant<sp/>to<sp/>the<sp/>niche<sp/>being<sp/>evaluated.</highlight></codeline>
<codeline lineno="1356"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1357"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Attributes:</highlight></codeline>
<codeline lineno="1358"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fit<sp/>(Callable[[ArrayLike],<sp/>Tuple[float,<sp/>np.ndarray]]):<sp/>A<sp/>fitness<sp/>evaluation</highlight></codeline>
<codeline lineno="1359"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>function<sp/>that<sp/>takes<sp/>an<sp/>input<sp/>of<sp/>type<sp/>ArrayLike<sp/>and<sp/>returns<sp/>a<sp/>tuple<sp/>with<sp/>a</highlight></codeline>
<codeline lineno="1360"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fitness<sp/>value<sp/>and<sp/>a<sp/>descriptor.</highlight></codeline>
<codeline lineno="1361"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index<sp/>(int):<sp/>Index<sp/>representing<sp/>the<sp/>specific<sp/>niche<sp/>to<sp/>evaluate<sp/>against.</highlight></codeline>
<codeline lineno="1362"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index_of_niches<sp/>(Callable[[ArrayLike],<sp/>np.ndarray]):<sp/>A<sp/>function<sp/>that<sp/>determines</highlight></codeline>
<codeline lineno="1363"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>niche<sp/>index<sp/>for<sp/>a<sp/>given<sp/>input<sp/>based<sp/>on<sp/>its<sp/>descriptor.</highlight></codeline>
<codeline lineno="1364"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1365"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1366"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1wrapper_1aabff3459c811afa2fde70139254db138" kindref="member">__init__</ref>(self,<sp/></highlight></codeline>
<codeline lineno="1367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fit:Callable[[ArrayLike],<sp/>Tuple[float,<sp/>np.ndarray]],<sp/></highlight></codeline>
<codeline lineno="1368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index:<sp/>int,<sp/></highlight></codeline>
<codeline lineno="1369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index_of_niches:<sp/>Callable[[ArrayLike],<sp/>np.ndarray]):</highlight></codeline>
<codeline lineno="1370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1371"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Initializes<sp/>an<sp/>instance<sp/>of<sp/>a<sp/>class<sp/>to<sp/>manage<sp/>niche-based<sp/>functionality<sp/>and<sp/>fitness<sp/>evaluation.</highlight></codeline>
<codeline lineno="1372"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1373"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>This<sp/>constructor<sp/>sets<sp/>up<sp/>the<sp/>necessary<sp/>components<sp/>to<sp/>evaluate<sp/>fitness<sp/>and<sp/>handle<sp/>niche-related</highlight></codeline>
<codeline lineno="1374"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>computations.</highlight></codeline>
<codeline lineno="1375"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1376"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="1377"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fit<sp/>(Callable[[ArrayLike],<sp/>Tuple[float,<sp/>np.ndarray]]):<sp/>A<sp/>function<sp/>that<sp/>takes<sp/>an<sp/>array-like</highlight></codeline>
<codeline lineno="1378"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>input<sp/>and<sp/>returns<sp/>a<sp/>tuple<sp/>containing<sp/>a<sp/>float<sp/>representing<sp/>the<sp/>fitness<sp/>value<sp/>and<sp/>a</highlight></codeline>
<codeline lineno="1379"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.ndarray<sp/>for<sp/>additional<sp/>fitness-related<sp/>data.</highlight></codeline>
<codeline lineno="1380"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index<sp/>(int):<sp/>An<sp/>integer<sp/>representing<sp/>the<sp/>index<sp/>or<sp/>identifier<sp/>for<sp/>this<sp/>instance.</highlight></codeline>
<codeline lineno="1381"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>index_of_niches<sp/>(Callable[[ArrayLike],<sp/>np.ndarray]):<sp/>A<sp/>function<sp/>that<sp/>takes<sp/>an<sp/>array-like</highlight></codeline>
<codeline lineno="1382"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>input<sp/>and<sp/>returns<sp/>a<sp/>numpy.ndarray<sp/>corresponding<sp/>to<sp/>the<sp/>indices<sp/>of<sp/>niches<sp/>associated</highlight></codeline>
<codeline lineno="1383"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>with<sp/>the<sp/>input.</highlight></codeline>
<codeline lineno="1384"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1wrapper_1a3dcdc7f9a349494aad1b493a11cd42af" kindref="member">fit</ref><sp/>=<sp/>fit</highlight></codeline>
<codeline lineno="1386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.index_of_niches<sp/>=<sp/>index_of_niches</highlight></codeline>
<codeline lineno="1387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>self.index<sp/>=<sp/>index</highlight></codeline>
<codeline lineno="1388"><highlight class="normal"></highlight></codeline>
<codeline lineno="1389"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="classfcmaes_1_1mapelites_1_1wrapper_1aef447c485c8dad313f64e3df4768218e" kindref="member">__call__</ref>(self,<sp/>x:<sp/>ArrayLike)<sp/>-&gt;<sp/>float:</highlight></codeline>
<codeline lineno="1390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1391"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Evaluates<sp/>the<sp/>input<sp/>by<sp/>fitting<sp/>it<sp/>and<sp/>checking<sp/>against<sp/>a<sp/>specific<sp/>index.<sp/>Returns<sp/>the</highlight></codeline>
<codeline lineno="1392"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>computed<sp/>result<sp/>if<sp/>the<sp/>index<sp/>matches;<sp/>otherwise,<sp/>returns<sp/>infinity.</highlight></codeline>
<codeline lineno="1393" refid="classfcmaes_1_1mapelites_1_1in__niche__filter" refkind="compound"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1394"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="1395"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>(ArrayLike):<sp/>Input<sp/>array<sp/>to<sp/>be<sp/>evaluated.</highlight></codeline>
<codeline lineno="1396"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1397"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="1398"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>float:<sp/>Computed<sp/>result<sp/>`y`<sp/>if<sp/>the<sp/>index<sp/>matches;<sp/>otherwise,<sp/>infinity<sp/>(np.inf).</highlight></codeline>
<codeline lineno="1399"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>y,<sp/>desc<sp/>=<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1in__niche__filter_1a92398321d5c000aad5ddad54cd92a349" kindref="member">fit</ref>(x)</highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1in__niche__filter_1ac6c721121ac09bd043d9d5bc141f79ff" kindref="member">index_of_niches</ref>([desc])[0]<sp/>==<sp/>self.<ref refid="classfcmaes_1_1mapelites_1_1in__niche__filter_1abefaec57e0e3215cd40bdcf1dc42f0e6" kindref="member">index</ref>:</highlight></codeline>
<codeline lineno="1402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>y</highlight></codeline>
<codeline lineno="1403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>np.inf</highlight></codeline>
<codeline lineno="1405"><highlight class="normal"></highlight></codeline>
<codeline lineno="1406"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacefcmaes_1_1mapelites_1a5f70b23800f6a77b08d918f5aa0f9b3d" kindref="member">variation_</ref>(pop,<sp/>lower,<sp/>upper,<sp/>rg,<sp/>dis_c<sp/>=<sp/>20,<sp/>dis_m<sp/>=<sp/>20):</highlight></codeline>
<codeline lineno="1407"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1408"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Generates<sp/>offspring<sp/>using<sp/>a<sp/>variation<sp/>operator<sp/>for<sp/>a<sp/>given<sp/>population<sp/>according<sp/>to<sp/>the<sp/>simulated</highlight></codeline>
<codeline lineno="1409"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>binary<sp/>crossover<sp/>(SBX)<sp/>and<sp/>polynomial<sp/>mutation<sp/>mechanisms.<sp/>This<sp/>method<sp/>scales<sp/>both<sp/>the<sp/>spread<sp/>factors</highlight></codeline>
<codeline lineno="1410"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>of<sp/>crossover<sp/>(`dis_c`)<sp/>and<sp/>mutation<sp/>(`dis_m`)<sp/>randomly<sp/>within<sp/>their<sp/>range<sp/>to<sp/>introduce<sp/>stochasticity.</highlight></codeline>
<codeline lineno="1411"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1412"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="1413" refid="classfcmaes_1_1mapelites_1_1in__niche__filter_1ae359024a8d9321fa9435b80d4f1c68b5" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pop<sp/>(np.ndarray):<sp/>2D<sp/>array<sp/>representing<sp/>the<sp/>population,<sp/>where<sp/>each<sp/>row<sp/>corresponds<sp/>to<sp/>an<sp/>individual<sp/>and</highlight></codeline>
<codeline lineno="1414"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>each<sp/>column<sp/>to<sp/>a<sp/>decision<sp/>variable.</highlight></codeline>
<codeline lineno="1415"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lower<sp/>(np.ndarray):<sp/>1D<sp/>array<sp/>specifying<sp/>the<sp/>lower<sp/>bound<sp/>of<sp/>each<sp/>decision<sp/>variable.<sp/>Its<sp/>length<sp/>must<sp/>match</highlight></codeline>
<codeline lineno="1416"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>number<sp/>of<sp/>columns<sp/>in<sp/>the<sp/>population.</highlight></codeline>
<codeline lineno="1417" refid="classfcmaes_1_1mapelites_1_1in__niche__filter_1a92398321d5c000aad5ddad54cd92a349" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upper<sp/>(np.ndarray):<sp/>1D<sp/>array<sp/>specifying<sp/>the<sp/>upper<sp/>bound<sp/>of<sp/>each<sp/>decision<sp/>variable.<sp/>Its<sp/>length<sp/>must<sp/>match</highlight></codeline>
<codeline lineno="1418" refid="classfcmaes_1_1mapelites_1_1in__niche__filter_1ac6c721121ac09bd043d9d5bc141f79ff" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>number<sp/>of<sp/>columns<sp/>in<sp/>the<sp/>population.</highlight></codeline>
<codeline lineno="1419" refid="classfcmaes_1_1mapelites_1_1in__niche__filter_1abefaec57e0e3215cd40bdcf1dc42f0e6" refkind="member"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rg<sp/>(np.random.Generator):<sp/>Random<sp/>generator<sp/>instance<sp/>for<sp/>stochastic<sp/>operations.</highlight></codeline>
<codeline lineno="1420"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dis_c<sp/>(float,<sp/>optional):<sp/>Distribution<sp/>index<sp/>for<sp/>crossover<sp/>operation,<sp/>controlling<sp/>spread<sp/>of<sp/>solutions</highlight></codeline>
<codeline lineno="1421"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>during<sp/>SBX.<sp/>Defaults<sp/>to<sp/>20.</highlight></codeline>
<codeline lineno="1422"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dis_m<sp/>(float,<sp/>optional):<sp/>Distribution<sp/>index<sp/>for<sp/>mutation<sp/>operation,<sp/>controlling<sp/>spread<sp/>of<sp/>mutations.</highlight></codeline>
<codeline lineno="1423"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Defaults<sp/>to<sp/>20.</highlight></codeline>
<codeline lineno="1424"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1425"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="1426"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.ndarray:<sp/>The<sp/>newly<sp/>generated<sp/>offspring<sp/>population,<sp/>with<sp/>the<sp/>same<sp/>shape<sp/>as<sp/>the<sp/>input<sp/>`pop`.</highlight></codeline>
<codeline lineno="1427"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1428"><highlight class="normal"><sp/><sp/><sp/><sp/>dis_c<sp/>*=<sp/>0.5<sp/>+<sp/>0.5*rg.random()<sp/></highlight><highlight class="comment">#<sp/>vary<sp/>spread<sp/>factors<sp/>randomly<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1429"><highlight class="normal"><sp/><sp/><sp/><sp/>dis_m<sp/>*=<sp/>0.5<sp/>+<sp/>0.5*rg.random()<sp/></highlight></codeline>
<codeline lineno="1430"><highlight class="normal"><sp/><sp/><sp/><sp/>pop<sp/>=<sp/>pop[:(len(pop)<sp/>//<sp/>2)<sp/>*<sp/>2][:]</highlight></codeline>
<codeline lineno="1431" refid="classfcmaes_1_1mapelites_1_1in__niche__filter_1a488d9065cc360b95c707fcd92793ff31" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>(n,<sp/>d)<sp/>=<sp/>np.shape(pop)</highlight></codeline>
<codeline lineno="1432"><highlight class="normal"><sp/><sp/><sp/><sp/>parent_1<sp/>=<sp/>pop[:n<sp/>//<sp/>2,<sp/>:]</highlight></codeline>
<codeline lineno="1433"><highlight class="normal"><sp/><sp/><sp/><sp/>parent_2<sp/>=<sp/>pop[n<sp/>//<sp/>2:,<sp/>:]</highlight></codeline>
<codeline lineno="1434"><highlight class="normal"><sp/><sp/><sp/><sp/>beta<sp/>=<sp/>np.zeros((n<sp/>//<sp/>2,<sp/>d))</highlight></codeline>
<codeline lineno="1435"><highlight class="normal"><sp/><sp/><sp/><sp/>mu<sp/>=<sp/>rg.random((n<sp/>//<sp/>2,<sp/>d))</highlight></codeline>
<codeline lineno="1436"><highlight class="normal"><sp/><sp/><sp/><sp/>beta[mu<sp/>&lt;=<sp/>0.5]<sp/>=<sp/>np.power(2<sp/>*<sp/>mu[mu<sp/>&lt;=<sp/>0.5],<sp/>1<sp/>/<sp/>(dis_c<sp/>+<sp/>1))</highlight></codeline>
<codeline lineno="1437"><highlight class="normal"><sp/><sp/><sp/><sp/>beta[mu<sp/>&gt;<sp/>0.5]<sp/>=<sp/>np.power(2<sp/>*<sp/>mu[mu<sp/>&gt;<sp/>0.5],<sp/>-1<sp/>/<sp/>(dis_c<sp/>+<sp/>1))</highlight></codeline>
<codeline lineno="1438"><highlight class="normal"><sp/><sp/><sp/><sp/>beta<sp/>=<sp/>beta<sp/>*<sp/>((-1)**<sp/>rg.integers(2,<sp/>size=(n<sp/>//<sp/>2,<sp/>d)))</highlight></codeline>
<codeline lineno="1439"><highlight class="normal"><sp/><sp/><sp/><sp/>beta[rg.random((n<sp/>//<sp/>2,<sp/>d))<sp/>&lt;<sp/>0.5]<sp/>=<sp/>1</highlight></codeline>
<codeline lineno="1440"><highlight class="normal"><sp/><sp/><sp/><sp/>parent_mean<sp/>=<sp/>(parent_1<sp/>+<sp/>parent_2)<sp/>/<sp/>2</highlight></codeline>
<codeline lineno="1441"><highlight class="normal"><sp/><sp/><sp/><sp/>parent_diff<sp/>=<sp/>(parent_1<sp/>-<sp/>parent_2)<sp/>/<sp/>2</highlight></codeline>
<codeline lineno="1442"><highlight class="normal"><sp/><sp/><sp/><sp/>offspring<sp/>=<sp/>np.vstack((parent_mean<sp/>+<sp/>beta<sp/>*<sp/>parent_diff,<sp/>parent_mean<sp/>-<sp/>beta<sp/>*<sp/>parent_diff))</highlight></codeline>
<codeline lineno="1443"><highlight class="normal"><sp/><sp/><sp/><sp/>site<sp/>=<sp/>rg.random((n,<sp/>d))<sp/>&lt;<sp/>1.0<sp/>/<sp/>d</highlight></codeline>
<codeline lineno="1444"><highlight class="normal"><sp/><sp/><sp/><sp/>mu<sp/>=<sp/>rg.random((n,<sp/>d))</highlight></codeline>
<codeline lineno="1445"><highlight class="normal"><sp/><sp/><sp/><sp/>temp<sp/>=<sp/>site<sp/>&amp;<sp/>(mu<sp/>&lt;=<sp/>0.5)</highlight></codeline>
<codeline lineno="1446"><highlight class="normal"><sp/><sp/><sp/><sp/>lower,<sp/>upper<sp/>=<sp/>np.tile(lower,<sp/>(n,<sp/>1)),<sp/>np.tile(upper,<sp/>(n,<sp/>1))</highlight></codeline>
<codeline lineno="1447"><highlight class="normal"><sp/><sp/><sp/><sp/>norm<sp/>=<sp/>(offspring[temp]<sp/>-<sp/>lower[temp])<sp/>/<sp/>(upper[temp]<sp/>-<sp/>lower[temp])</highlight></codeline>
<codeline lineno="1448"><highlight class="normal"><sp/><sp/><sp/><sp/>offspring[temp]<sp/>+=<sp/>(upper[temp]<sp/>-<sp/>lower[temp])<sp/>*<sp/>\</highlight></codeline>
<codeline lineno="1449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(np.power(2.<sp/>*<sp/>mu[temp]<sp/>+<sp/>(1.<sp/>-<sp/>2.<sp/>*<sp/>mu[temp])<sp/>*<sp/>np.power(np.abs(1.<sp/>-<sp/>norm),<sp/>dis_m<sp/>+<sp/>1.),</highlight></codeline>
<codeline lineno="1450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.<sp/>/<sp/>(dis_m<sp/>+<sp/>1))<sp/>-<sp/>1.)</highlight></codeline>
<codeline lineno="1451"><highlight class="normal"><sp/><sp/><sp/><sp/>temp<sp/>=<sp/>site<sp/>&amp;<sp/>(mu<sp/>&gt;<sp/>0.5)</highlight></codeline>
<codeline lineno="1452"><highlight class="normal"><sp/><sp/><sp/><sp/>norm<sp/>=<sp/>(upper[temp]<sp/>-<sp/>offspring[temp])<sp/>/<sp/>(upper[temp]<sp/>-<sp/>lower[temp])</highlight></codeline>
<codeline lineno="1453"><highlight class="normal"><sp/><sp/><sp/><sp/>offspring[temp]<sp/>+=<sp/>(upper[temp]<sp/>-<sp/>lower[temp])<sp/>*<sp/>\</highlight></codeline>
<codeline lineno="1454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(1.<sp/>-<sp/>np.power(</highlight></codeline>
<codeline lineno="1455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.<sp/>*<sp/>(1.<sp/>-<sp/>mu[temp])<sp/>+<sp/>2.<sp/>*<sp/>(mu[temp]<sp/>-<sp/>0.5)<sp/>*<sp/>np.power(np.abs(1.<sp/>-<sp/>norm),<sp/>dis_m<sp/>+<sp/>1.),</highlight></codeline>
<codeline lineno="1456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.<sp/>/<sp/>(dis_m<sp/>+<sp/>1.)))</highlight></codeline>
<codeline lineno="1457"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>np.clip(offspring,<sp/>lower,<sp/>upper)</highlight></codeline>
<codeline lineno="1458"><highlight class="normal"></highlight></codeline>
<codeline lineno="1459" refid="namespacefcmaes_1_1mapelites_1a5f70b23800f6a77b08d918f5aa0f9b3d" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacefcmaes_1_1mapelites_1aa557fd895bcaf40f495273ef16953c11" kindref="member">iso_dd_</ref>(x1,<sp/>x2,<sp/>lower,<sp/>upper,<sp/>rg,<sp/>iso_sigma<sp/>=<sp/>0.01,<sp/>line_sigma<sp/>=<sp/>0.2):</highlight></codeline>
<codeline lineno="1460"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1461"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Generates<sp/>isotropic<sp/>deviation<sp/>data<sp/>within<sp/>specified<sp/>bounds.</highlight></codeline>
<codeline lineno="1462"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1463"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>This<sp/>function<sp/>creates<sp/>a<sp/>variation<sp/>of<sp/>the<sp/>input<sp/>data<sp/>`x1`<sp/>influenced<sp/>by</highlight></codeline>
<codeline lineno="1464"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Gaussian<sp/>noise<sp/>parameters<sp/>for<sp/>isotropic<sp/>and<sp/>line<sp/>deviations.<sp/>The<sp/>result</highlight></codeline>
<codeline lineno="1465"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>is<sp/>clipped<sp/>to<sp/>remain<sp/>within<sp/>the<sp/>range<sp/>defined<sp/>by<sp/>the<sp/>`lower`<sp/>and<sp/>`upper`</highlight></codeline>
<codeline lineno="1466"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>bounds.</highlight></codeline>
<codeline lineno="1467"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1468"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="1469"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x1:<sp/>The<sp/>primary<sp/>input<sp/>array<sp/>for<sp/>generating<sp/>isotropic<sp/>deviation<sp/>data.</highlight></codeline>
<codeline lineno="1470"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x2:<sp/>The<sp/>secondary<sp/>input<sp/>array<sp/>influencing<sp/>line<sp/>deviation<sp/>calculation.</highlight></codeline>
<codeline lineno="1471"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lower:<sp/>The<sp/>lower<sp/>bound<sp/>for<sp/>clipping<sp/>the<sp/>resulting<sp/>data.</highlight></codeline>
<codeline lineno="1472"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upper:<sp/>The<sp/>upper<sp/>bound<sp/>for<sp/>clipping<sp/>the<sp/>resulting<sp/>data.</highlight></codeline>
<codeline lineno="1473"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rg:<sp/>Random<sp/>generator<sp/>object<sp/>used<sp/>for<sp/>generating<sp/>Gaussian<sp/>noise.</highlight></codeline>
<codeline lineno="1474"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>iso_sigma:<sp/>Standard<sp/>deviation<sp/>of<sp/>the<sp/>isotropic<sp/>Gaussian<sp/>noise.<sp/>Defaults</highlight></codeline>
<codeline lineno="1475"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>0.01.</highlight></codeline>
<codeline lineno="1476"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>line_sigma:<sp/>Standard<sp/>deviation<sp/>of<sp/>the<sp/>line<sp/>Gaussian<sp/>noise.<sp/>Defaults<sp/>to</highlight></codeline>
<codeline lineno="1477"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0.2.</highlight></codeline>
<codeline lineno="1478"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1479"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="1480"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ndarray:<sp/>The<sp/>processed<sp/>array<sp/>with<sp/>isotropic<sp/>and<sp/>line<sp/>deviations</highlight></codeline>
<codeline lineno="1481"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>applied<sp/>and<sp/>bounded<sp/>by<sp/>the<sp/>given<sp/>limits.</highlight></codeline>
<codeline lineno="1482"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1483"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1484"><highlight class="normal"><sp/><sp/><sp/><sp/>a<sp/>=<sp/>rg.normal(0,<sp/>iso_sigma,<sp/>x1.shape)<sp/></highlight></codeline>
<codeline lineno="1485"><highlight class="normal"><sp/><sp/><sp/><sp/>b<sp/>=<sp/>rg.normal(0,<sp/>line_sigma,<sp/>x2.shape)<sp/></highlight></codeline>
<codeline lineno="1486"><highlight class="normal"><sp/><sp/><sp/><sp/>z<sp/>=<sp/>x1<sp/>+<sp/>a<sp/>+<sp/>np.multiply(b,<sp/>(x1<sp/>-<sp/>x2))</highlight></codeline>
<codeline lineno="1487"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>np.clip(z,<sp/>lower,<sp/>upper)</highlight></codeline>
<codeline lineno="1488"><highlight class="normal"></highlight></codeline>
<codeline lineno="1489"><highlight class="normal"></highlight><highlight class="keyword">def<sp/></highlight><highlight class="normal"><ref refid="namespacefcmaes_1_1mapelites_1a1cd72ab87d7aa999a255ad854895d3aa" kindref="member">get_centers_</ref>(niche_num,<sp/>dim,<sp/>samples_per_niche):</highlight></codeline>
<codeline lineno="1490"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;&quot;&quot;</highlight></codeline>
<codeline lineno="1491"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Determines<sp/>and<sp/>returns<sp/>the<sp/>centers<sp/>of<sp/>niches<sp/>in<sp/>a<sp/>defined<sp/>space<sp/>using<sp/>k-means<sp/>clustering.</highlight></codeline>
<codeline lineno="1492"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>If<sp/>the<sp/>data<sp/>is<sp/>cached,<sp/>it<sp/>loads<sp/>the<sp/>cached<sp/>centers<sp/>for<sp/>faster<sp/>access.<sp/>Otherwise,<sp/>it<sp/>computes</highlight></codeline>
<codeline lineno="1493"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>the<sp/>centers<sp/>by<sp/>applying<sp/>k-means<sp/>clustering<sp/>on<sp/>randomly<sp/>generated<sp/>samples<sp/>and<sp/>caches<sp/>the</highlight></codeline>
<codeline lineno="1494"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>result<sp/>for<sp/>future<sp/>use.</highlight></codeline>
<codeline lineno="1495"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1496"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Args:</highlight></codeline>
<codeline lineno="1497"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>niche_num<sp/>(int):<sp/>Number<sp/>of<sp/>niches<sp/>or<sp/>clusters<sp/>to<sp/>determine<sp/>centers<sp/>for.</highlight></codeline>
<codeline lineno="1498"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dim<sp/>(int):<sp/>Dimensionality<sp/>of<sp/>the<sp/>space<sp/>where<sp/>the<sp/>niches<sp/>are<sp/>located.</highlight></codeline>
<codeline lineno="1499"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>samples_per_niche<sp/>(int):<sp/>Number<sp/>of<sp/>samples<sp/>used<sp/>per<sp/>niche<sp/>to<sp/>compute<sp/>the<sp/>centers.</highlight></codeline>
<codeline lineno="1500"><highlight class="stringliteral"></highlight></codeline>
<codeline lineno="1501"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>Returns:</highlight></codeline>
<codeline lineno="1502"><highlight class="stringliteral"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>numpy.ndarray:<sp/>An<sp/>array<sp/>representing<sp/>the<sp/>determined<sp/>centers<sp/>of<sp/>the<sp/>niches.</highlight></codeline>
<codeline lineno="1503"><highlight class="stringliteral"><sp/><sp/><sp/><sp/>&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1504"><highlight class="normal"><sp/><sp/><sp/><sp/>p<sp/>=<sp/>Path(</highlight><highlight class="stringliteral">&apos;voronoi_cache&apos;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1505"><highlight class="normal"><sp/><sp/><sp/><sp/>p.mkdir(exist_ok=</highlight><highlight class="keyword">True</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1506"><highlight class="normal"><sp/><sp/><sp/><sp/>fname<sp/>=<sp/>f</highlight><highlight class="stringliteral">&apos;centers_{niche_num}_{dim}_{samples_per_niche}.npz&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1507"><highlight class="normal"><sp/><sp/><sp/><sp/>files<sp/>=<sp/>p.glob(fname)</highlight></codeline>
<codeline lineno="1508"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>file<sp/></highlight><highlight class="keywordflow">in</highlight><highlight class="normal"><sp/>files:<sp/></highlight><highlight class="comment">#<sp/>if<sp/>cached<sp/>just<sp/>load</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">with</highlight><highlight class="normal"><sp/>np.load(file)<sp/></highlight><highlight class="keyword">as</highlight><highlight class="normal"><sp/>data:</highlight></codeline>
<codeline lineno="1510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>data[</highlight><highlight class="stringliteral">&apos;cs&apos;</highlight><highlight class="normal">]</highlight></codeline>
<codeline lineno="1511"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>descs<sp/>=<sp/>rng.uniform(0,<sp/>1,<sp/>(niche_num*samples_per_niche,<sp/>dim))</highlight></codeline>
<codeline lineno="1513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">#<sp/>Applies<sp/>KMeans<sp/>to<sp/>the<sp/>random<sp/>samples<sp/>determine<sp/>the<sp/>centers<sp/>of<sp/>each<sp/>niche.&quot;&quot;&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>k_means<sp/>=<sp/>KMeans(init=</highlight><highlight class="stringliteral">&apos;k-means++&apos;</highlight><highlight class="normal">,<sp/>n_clusters=niche_num,<sp/>n_init=1,<sp/>verbose=1)</highlight></codeline>
<codeline lineno="1515" refid="namespacefcmaes_1_1mapelites_1aa557fd895bcaf40f495273ef16953c11" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>k_means.fit(descs)</highlight></codeline>
<codeline lineno="1516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>centers<sp/>=<sp/>k_means.cluster_centers_</highlight></codeline>
<codeline lineno="1517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>np.savez_compressed(f</highlight><highlight class="stringliteral">&apos;voronoi_cache/centers_{niche_num}_{dim}_{samples_per_niche}&apos;</highlight><highlight class="normal">,<sp/>cs=centers)</highlight></codeline>
<codeline lineno="1518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>centers</highlight></codeline>
    </programlisting>
    <location file="fcmaes/mapelites.py"/>
  </compounddef>
</doxygen>
