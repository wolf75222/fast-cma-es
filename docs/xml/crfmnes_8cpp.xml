<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.13.2" xml:lang="en-US">
  <compounddef id="crfmnes_8cpp" kind="file" language="C++">
    <compoundname>crfmnes.cpp</compoundname>
    <includes local="no">Eigen/Core</includes>
    <includes local="no">Eigen/Eigenvalues</includes>
    <includes local="no">iostream</includes>
    <includes local="no">random</includes>
    <includes local="no">float.h</includes>
    <includes local="no">stdint.h</includes>
    <includes local="no">ctime</includes>
    <includes local="no">inttypes.h</includes>
    <includes refid="evaluator_8h" local="yes">evaluator.h</includes>
    <incdepgraph>
      <node id="1">
        <label>_fcmaescpp/crfmnes.cpp</label>
        <link refid="crfmnes_8cpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>evaluator.h</label>
        <link refid="evaluator_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>Eigen/Core</label>
      </node>
      <node id="3">
        <label>Eigen/Eigenvalues</label>
      </node>
      <node id="11">
        <label>algorithm</label>
      </node>
      <node id="16">
        <label>chrono</label>
      </node>
      <node id="17">
        <label>condition_variable</label>
      </node>
      <node id="8">
        <label>ctime</label>
      </node>
      <node id="6">
        <label>float.h</label>
      </node>
      <node id="9">
        <label>inttypes.h</label>
      </node>
      <node id="4">
        <label>iostream</label>
      </node>
      <node id="13">
        <label>mutex</label>
      </node>
      <node id="18">
        <label>pcg_random.hpp</label>
      </node>
      <node id="12">
        <label>queue</label>
      </node>
      <node id="5">
        <label>random</label>
      </node>
      <node id="7">
        <label>stdint.h</label>
      </node>
      <node id="14">
        <label>thread</label>
      </node>
      <node id="15">
        <label>vector</label>
      </node>
    </incdepgraph>
    <innerclass refid="classcrmfnes_1_1_crfmnes_optimizer" prot="public">crmfnes::CrfmnesOptimizer</innerclass>
    <innernamespace refid="namespacecrmfnes">crmfnes</innernamespace>
    <sectiondef kind="func">
      <memberdef kind="function" id="namespacecrmfnes_1a37f765d781ba1148662c876fc40498b8" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref></type>
        <definition>static vec crmfnes::sequence</definition>
        <argsstring>(double start, double end, double step)</argsstring>
        <name>sequence</name>
        <qualifiedname>crmfnes::sequence</qualifiedname>
        <param>
          <type>double</type>
          <declname>start</declname>
        </param>
        <param>
          <type>double</type>
          <declname>end</declname>
        </param>
        <param>
          <type>double</type>
          <declname>step</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="_fcmaescpp/crfmnes.cpp" line="28" column="12" bodyfile="_fcmaescpp/crfmnes.cpp" bodystart="28" bodyend="37"/>
        <referencedby refid="classcrmfnes_1_1_crfmnes_optimizer_1a05253e344b7c87ba83627a8b15bf384b" compoundref="crfmnes_8cpp" startline="43" endline="85">crmfnes::CrfmnesOptimizer::CrfmnesOptimizer</referencedby>
      </memberdef>
      <memberdef kind="function" id="crfmnes_8cpp_1a9081791c22cd931e965641b985273b52" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void optimizeCRFMNES_C</definition>
        <argsstring>(int64_t runid, callback_parallel func_par, int dim, double *init, double *lower, double *upper, double sigma, int maxEvals, double stopfitness, int popsize, int64_t seed, double penalty_coef, bool use_constraint_violation, bool normalize, double *res)</argsstring>
        <name>optimizeCRFMNES_C</name>
        <param>
          <type>int64_t</type>
          <declname>runid</declname>
        </param>
        <param>
          <type><ref refid="evaluator_8h_1a1adc681c70e547867358d25d5cf7eedc" kindref="member">callback_parallel</ref></type>
          <declname>func_par</declname>
        </param>
        <param>
          <type>int</type>
          <declname>dim</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>init</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>lower</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>upper</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sigma</declname>
        </param>
        <param>
          <type>int</type>
          <declname>maxEvals</declname>
        </param>
        <param>
          <type>double</type>
          <declname>stopfitness</declname>
        </param>
        <param>
          <type>int</type>
          <declname>popsize</declname>
        </param>
        <param>
          <type>int64_t</type>
          <declname>seed</declname>
        </param>
        <param>
          <type>double</type>
          <declname>penalty_coef</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>use_constraint_violation</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>normalize</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>res</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="_fcmaescpp/crfmnes.cpp" line="365" column="6" bodyfile="_fcmaescpp/crfmnes.cpp" bodystart="365" bodyend="403"/>
        <references refid="class_fitness_1aba60038eac4e0e15d995e57f4ba079e1" compoundref="evaluator_8h" startline="313" endline="315">Fitness::evaluations</references>
        <references refid="evaluator_8h_1ad0943ebd623281f526e5aee2aa818895" compoundref="evaluator_8h" startline="86" endline="88">noop_callback</references>
        <references refid="class_fitness_1a31beb7ecb5fa49ac03b43abe444ab9a6" compoundref="evaluator_8h" startline="333" endline="335">Fitness::setNormalize</references>
      </memberdef>
      <memberdef kind="function" id="crfmnes_8cpp_1a8ad70c1b6cadd1ed7b3bfa0d60d96911" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>uintptr_t</type>
        <definition>uintptr_t initCRFMNES_C</definition>
        <argsstring>(int64_t runid, int dim, double *init, double *lower, double *upper, double sigma, int popsize, int64_t seed, double penalty_coef, bool use_constraint_violation, bool normalize)</argsstring>
        <name>initCRFMNES_C</name>
        <param>
          <type>int64_t</type>
          <declname>runid</declname>
        </param>
        <param>
          <type>int</type>
          <declname>dim</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>init</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>lower</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>upper</declname>
        </param>
        <param>
          <type>double</type>
          <declname>sigma</declname>
        </param>
        <param>
          <type>int</type>
          <declname>popsize</declname>
        </param>
        <param>
          <type>int64_t</type>
          <declname>seed</declname>
        </param>
        <param>
          <type>double</type>
          <declname>penalty_coef</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>use_constraint_violation</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>normalize</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="_fcmaescpp/crfmnes.cpp" line="405" column="11" bodyfile="_fcmaescpp/crfmnes.cpp" bodystart="405" bodyend="430"/>
        <references refid="evaluator_8h_1ad0943ebd623281f526e5aee2aa818895" compoundref="evaluator_8h" startline="86" endline="88">noop_callback</references>
        <references refid="evaluator_8h_1ac05c49788a31e5f7cb8efbe8ca3b548e" compoundref="evaluator_8h" startline="90" endline="91">noop_callback_par</references>
        <references refid="class_fitness_1a31beb7ecb5fa49ac03b43abe444ab9a6" compoundref="evaluator_8h" startline="333" endline="335">Fitness::setNormalize</references>
      </memberdef>
      <memberdef kind="function" id="crfmnes_8cpp_1a22d09131327c77abfd090eaa649faf5d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void destroyCRFMNES_C</definition>
        <argsstring>(uintptr_t ptr)</argsstring>
        <name>destroyCRFMNES_C</name>
        <param>
          <type>uintptr_t</type>
          <declname>ptr</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="_fcmaescpp/crfmnes.cpp" line="432" column="6" bodyfile="_fcmaescpp/crfmnes.cpp" bodystart="432" bodyend="437"/>
      </memberdef>
      <memberdef kind="function" id="crfmnes_8cpp_1aa1796ba79109494532e2a57b9555b7e5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void askCRFMNES_C</definition>
        <argsstring>(uintptr_t ptr, double *xs)</argsstring>
        <name>askCRFMNES_C</name>
        <param>
          <type>uintptr_t</type>
          <declname>ptr</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>xs</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="_fcmaescpp/crfmnes.cpp" line="439" column="6" bodyfile="_fcmaescpp/crfmnes.cpp" bodystart="439" bodyend="450"/>
        <references refid="class_fitness_1a7fdca1fda75e3976b91e1e9e0eb12057" compoundref="evaluator_8h" startline="348" endline="353">Fitness::decode</references>
        <references refid="class_fitness_1a2085e5ce1a0afa5949366f580d5ec5a4" compoundref="evaluator_8h" startline="240" endline="244">Fitness::getClosestFeasible</references>
      </memberdef>
      <memberdef kind="function" id="crfmnes_8cpp_1a39b04e71778a1006c8cc1bea2d082074" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int tellCRFMNES_C</definition>
        <argsstring>(uintptr_t ptr, double *ys)</argsstring>
        <name>tellCRFMNES_C</name>
        <param>
          <type>uintptr_t</type>
          <declname>ptr</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>ys</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="_fcmaescpp/crfmnes.cpp" line="452" column="5" bodyfile="_fcmaescpp/crfmnes.cpp" bodystart="452" bodyend="469"/>
      </memberdef>
      <memberdef kind="function" id="crfmnes_8cpp_1ae309750075a3655886dcf9647435b799" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int populationCRFMNES_C</definition>
        <argsstring>(uintptr_t ptr, double *xs)</argsstring>
        <name>populationCRFMNES_C</name>
        <param>
          <type>uintptr_t</type>
          <declname>ptr</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>xs</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="_fcmaescpp/crfmnes.cpp" line="471" column="5" bodyfile="_fcmaescpp/crfmnes.cpp" bodystart="471" bodyend="482"/>
      </memberdef>
      <memberdef kind="function" id="crfmnes_8cpp_1aefaccee22121ee2d0f43d33fd5968c22" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int resultCRFMNES_C</definition>
        <argsstring>(uintptr_t ptr, double *res)</argsstring>
        <name>resultCRFMNES_C</name>
        <param>
          <type>uintptr_t</type>
          <declname>ptr</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>res</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="_fcmaescpp/crfmnes.cpp" line="484" column="5" bodyfile="_fcmaescpp/crfmnes.cpp" bodystart="484" bodyend="497"/>
        <references refid="class_fitness_1aba60038eac4e0e15d995e57f4ba079e1" compoundref="evaluator_8h" startline="313" endline="315">Fitness::evaluations</references>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">//<sp/>Copyright<sp/>(c)<sp/>Dietmar<sp/>Wolz.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">//<sp/>This<sp/>source<sp/>code<sp/>is<sp/>licensed<sp/>under<sp/>the<sp/>MIT<sp/>license<sp/>found<sp/>in<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="comment">//<sp/>LICENSE<sp/>file<sp/>in<sp/>the<sp/>root<sp/>directory.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Eigen<sp/>based<sp/>implementation<sp/>of<sp/>Fast<sp/>Moving<sp/>Natural<sp/>Evolution<sp/>Strategy</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>for<sp/>High-Dimensional<sp/>Problems<sp/>(CR-FM-NES),<sp/>see<sp/>https://arxiv.org/abs/2201.11422<sp/>.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>Derived<sp/>from<sp/>https://github.com/nomuramasahir0/crfmnes<sp/>.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Requires<sp/>Eigen<sp/>version<sp/>&gt;=<sp/>3.4<sp/>because<sp/>new<sp/>slicing<sp/>capabilities<sp/>are<sp/>used,<sp/>see</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="comment">//<sp/>https://eigen.tuxfamily.org/dox-devel/group__TutorialSlicingIndexing.html</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="comment">//<sp/>requires<sp/>https://github.com/bab2min/EigenRand<sp/>for<sp/>random<sp/>number<sp/>generation.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Eigen/Core&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Eigen/Eigenvalues&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;iostream&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;random&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;float.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdint.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;ctime&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;inttypes.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="evaluator_8h" kindref="compound">evaluator.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="keyword">using<sp/>namespace<sp/></highlight><highlight class="normal">std;</highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight></codeline>
<codeline lineno="26" refid="namespacecrmfnes" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespacecrmfnes" kindref="compound">crmfnes</ref><sp/>{</highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight></codeline>
<codeline lineno="28" refid="namespacecrmfnes_1a37f765d781ba1148662c876fc40498b8" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="namespacecrmfnes_1a37f765d781ba1148662c876fc40498b8" kindref="member">sequence</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>start,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>end,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>step)<sp/>{</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>size<sp/>=<sp/>(int)<sp/>((end<sp/>-<sp/>start)<sp/>/<sp/>step<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>d(size);</highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>value<sp/>=<sp/>start;</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>r<sp/>=<sp/>0;<sp/>r<sp/>&lt;<sp/>size;<sp/>r++)<sp/>{</highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d(r)<sp/>=<sp/>value;</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>+=<sp/>step;</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>d;</highlight></codeline>
<codeline lineno="37"><highlight class="normal">}</highlight></codeline>
<codeline lineno="38"><highlight class="normal"></highlight></codeline>
<codeline lineno="39" refid="classcrmfnes_1_1_crfmnes_optimizer" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a05253e344b7c87ba83627a8b15bf384b" kindref="member">CrfmnesOptimizer</ref><sp/>{</highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight></codeline>
<codeline lineno="43" refid="classcrmfnes_1_1_crfmnes_optimizer_1a05253e344b7c87ba83627a8b15bf384b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a05253e344b7c87ba83627a8b15bf384b" kindref="member">CrfmnesOptimizer</ref>(int64_t<sp/><sp/>runid_,<sp/><ref refid="class_fitness" kindref="compound">Fitness</ref>*<sp/>fitfun_,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dim_,<sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>m_,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigma_,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>lamb_,</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>maxEvaluations_,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>stopfitness_,</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>penalty_coef_,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>use_constraint_violation_,<sp/>int64_t<sp/><sp/>seed)<sp/>{</highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a94ef5ecb5b443d6bea2755f8f5ff101e" kindref="member">runid</ref><sp/>=<sp/>runid_;</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df" kindref="member">fitfun</ref><sp/>=<sp/>fitfun_;</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref><sp/>=<sp/>dim_;</highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af0db5eb5a3f56f27d4b98d761e72d1a0" kindref="member">m</ref><sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df" kindref="member">fitfun</ref>-&gt;encode(m_);</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a4c0820d04c88fd8fee328b76e876b802" kindref="member">sigma</ref><sp/>=<sp/>sigma_;</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref><sp/>=<sp/>lamb_;</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a36b0425100406234215eea1c9b13e9ce" kindref="member">mu</ref><sp/>=<sp/>lamb_/2;</highlight></codeline>
<codeline lineno="54"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1abbde930c83008df3cc0ffc0274f9d42f" kindref="member">maxEvaluations</ref><sp/>=<sp/>maxEvaluations_;</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae32d48173c079d73cce875635b480add" kindref="member">stopfitness</ref><sp/>=<sp/>stopfitness_;</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a8e0fa412cfd0b5c7e65ecab47b329cdc" kindref="member">penalty_coef</ref><sp/>=<sp/>penalty_coef_<sp/>&gt;<sp/>0<sp/>?<sp/>penalty_coef_<sp/>:<sp/>1e5;</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a129a0aa8de197876c8b303efb52aec42" kindref="member">use_constraint_violation</ref><sp/>=<sp/>use_constraint_violation_;</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aadf548da26f22c15246e777fd2a5f850" kindref="member">rs</ref><sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>pcg64(seed);</highlight></codeline>
<codeline lineno="59"><highlight class="normal"></highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a052fd208dd9ea12039373c6fc9d3f272" kindref="member">stop</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1acbc3a84327f441962eeda759eb1e888c" kindref="member">v</ref><sp/>=<sp/><ref refid="evaluator_8h_1a5b652df2286e1f0c4dae7d4dd841bb8f" kindref="member">normalVec</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>,<sp/>*<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aadf548da26f22c15246e777fd2a5f850" kindref="member">rs</ref>)<sp/>/<sp/>sqrt(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>);</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5" kindref="member">D</ref><sp/>=<sp/><ref refid="evaluator_8h_1a493b3a74ec3481711548e4b506b009cd" kindref="member">constant</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>,<sp/>1);</highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a276111d6b0fdeb972925d988901da9b4" kindref="member">w_rank_hat</ref><sp/>=<sp/>((log(<ref refid="namespacecrmfnes_1a37f765d781ba1148662c876fc40498b8" kindref="member">sequence</ref>(1,<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>,<sp/>1).array())<sp/>*<sp/>-1.)<sp/>+<sp/>log(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a36b0425100406234215eea1c9b13e9ce" kindref="member">mu</ref><sp/>+<sp/>1)).cwiseMax(0);</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a696d7a7a6fa5842a0aefc5c61de232b6" kindref="member">w_rank</ref><sp/>=<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a276111d6b0fdeb972925d988901da9b4" kindref="member">w_rank_hat</ref><sp/>/<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a276111d6b0fdeb972925d988901da9b4" kindref="member">w_rank_hat</ref>.sum()).array()<sp/>-<sp/>(1.<sp/>/<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>);</highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>wlamb<sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a696d7a7a6fa5842a0aefc5c61de232b6" kindref="member">w_rank</ref>.array()<sp/>+<sp/>(1.<sp/>/<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>);</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c" kindref="member">mueff</ref><sp/>=<sp/>1.<sp/>/<sp/>(wlamb.transpose()<sp/>*<sp/>wlamb)(0,0);</highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aff1006f7662b3b17b824b151b40a8165" kindref="member">cs</ref><sp/>=<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c" kindref="member">mueff</ref><sp/>+<sp/>2.)<sp/>/<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref><sp/>+<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c" kindref="member">mueff</ref><sp/>+<sp/>5.);</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa5bfe0c1ff87f0fefc54e2246a06c2ad" kindref="member">cc</ref><sp/>=<sp/>(4.<sp/>+<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c" kindref="member">mueff</ref><sp/>/<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>)<sp/>/<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref><sp/>+<sp/>4.<sp/>+<sp/>2.<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c" kindref="member">mueff</ref><sp/>/<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>);</highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1acf5da4897c7d05b4a560483aa902dc85" kindref="member">c1_cma</ref><sp/>=<sp/>2.<sp/>/<sp/>(pow(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref><sp/>+<sp/>1.3,<sp/>2)<sp/>+<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c" kindref="member">mueff</ref>);</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>initialization</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa5b420b40b5781750b33e17ccdb2d2d6" kindref="member">chiN</ref><sp/>=<sp/>sqrt(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>)<sp/>*<sp/>(1.<sp/>-<sp/>1.<sp/>/<sp/>(4.<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>)<sp/>+<sp/>1.<sp/>/<sp/>(21.<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref><sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>));</highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ac80232587fb6c3f7ee255f6f008cde98" kindref="member">pc</ref><sp/>=<sp/><ref refid="evaluator_8h_1a909812174fa9829bc49f6e00edb00b90" kindref="member">zeros</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>);</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae3129ee6c7c9205a66634a2f2df6ae0b" kindref="member">ps</ref><sp/>=<sp/><ref refid="evaluator_8h_1a909812174fa9829bc49f6e00edb00b90" kindref="member">zeros</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>);</highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>distance<sp/>weight<sp/>parameter</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5" kindref="member">h_inv</ref><sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af30c10c32f611845931c3a8dc034874f" kindref="member">get_h_inv</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>);</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>learning<sp/>rate</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a352856a88945aa103202f415a9b8b90f" kindref="member">eta_m</ref><sp/>=<sp/>1.0;</highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa686eecadca99ea7ee1064afda80c369" kindref="member">eta_move_sigma</ref><sp/>=<sp/>1.;</highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aad0299e6e1ed76e143db1ef75d1a3c7b" kindref="member">g</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a85f1a006b0a3aa878e22e0b65517142e" kindref="member">no_of_evals</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1" kindref="member">z</ref><sp/>=<sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>,<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>);</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae7104ec4f55d2e4bedb9ac8e885cc3d9" kindref="member">f_best</ref><sp/>=<sp/>INFINITY;</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af415b05895f150b3f59613fb3e5a67ed" kindref="member">x_best</ref><sp/>=<sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>);</highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight></codeline>
<codeline lineno="87" refid="classcrmfnes_1_1_crfmnes_optimizer_1a23aa6d542c16d17a68a0fd29b13b36b9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">virtual</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a23aa6d542c16d17a68a0fd29b13b36b9" kindref="member">~CrfmnesOptimizer</ref>()<sp/>{</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aadf548da26f22c15246e777fd2a5f850" kindref="member">rs</ref>;</highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight></codeline>
<codeline lineno="91" refid="classcrmfnes_1_1_crfmnes_optimizer_1aa451fe19e5c4b4617099daf96ed4d171" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa451fe19e5c4b4617099daf96ed4d171" kindref="member">doOptimize</ref>()<sp/>{</highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>--------------------<sp/>Generation<sp/>Loop<sp/>--------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a9979f360a5500c2e9eb53522659bd745" kindref="member">iterations</ref><sp/>=<sp/>1;<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df" kindref="member">fitfun</ref>-&gt;evaluations()<sp/>&lt;<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1abbde930c83008df3cc0ffc0274f9d42f" kindref="member">maxEvaluations</ref><sp/>&amp;&amp;<sp/>!<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df" kindref="member">fitfun</ref>-&gt;terminate();</highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a9979f360a5500c2e9eb53522659bd745" kindref="member">iterations</ref>++)<sp/>{</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>generate<sp/>and<sp/>evaluate<sp/>lamb<sp/>offspring</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>xs<sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ac3695788414c855140e6615040309e42" kindref="member">ask</ref>();</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>evs(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>);</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df" kindref="member">fitfun</ref>-&gt;values(xs,<sp/>evs);</highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aae1806b3f5cca0f2f27363c38c83a836" kindref="member">tell</ref>(evs);</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(std::exception<sp/>&amp;e)<sp/>{</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a052fd208dd9ea12039373c6fc9d3f272" kindref="member">stop</ref><sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a052fd208dd9ea12039373c6fc9d3f272" kindref="member">stop</ref><sp/>!=<sp/>0)</highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="108"><highlight class="normal"></highlight></codeline>
<codeline lineno="109" refid="classcrmfnes_1_1_crfmnes_optimizer_1a2351c27b7cd4710d802d0a86dd6ea39f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a2351c27b7cd4710d802d0a86dd6ea39f" kindref="member">getPopulation</ref>()<sp/>{</highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ad68ee5ba071c8eb355a3fbe1b306adb7" kindref="member">xs_no_sort</ref>;</highlight></codeline>
<codeline lineno="111"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight></codeline>
<codeline lineno="113" refid="classcrmfnes_1_1_crfmnes_optimizer_1a7ee78ff487813e794ab15e0374a35f6c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a7ee78ff487813e794ab15e0374a35f6c" kindref="member">getBestX</ref>()<sp/>{</highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af415b05895f150b3f59613fb3e5a67ed" kindref="member">x_best</ref>;</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="116"><highlight class="normal"></highlight></codeline>
<codeline lineno="117" refid="classcrmfnes_1_1_crfmnes_optimizer_1abea9bcf06910aef210b31f43504c340c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1abea9bcf06910aef210b31f43504c340c" kindref="member">getBestValue</ref>()<sp/>{</highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae7104ec4f55d2e4bedb9ac8e885cc3d9" kindref="member">f_best</ref>;</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight></codeline>
<codeline lineno="121" refid="classcrmfnes_1_1_crfmnes_optimizer_1a4735fca2ded46c9ae1e713ae3d77b152" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a4735fca2ded46c9ae1e713ae3d77b152" kindref="member">getIterations</ref>()<sp/>{</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a9979f360a5500c2e9eb53522659bd745" kindref="member">iterations</ref>;</highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="125" refid="classcrmfnes_1_1_crfmnes_optimizer_1acdb727b084e729ed508db581aaee4ee7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1acdb727b084e729ed508db581aaee4ee7" kindref="member">getStop</ref>()<sp/>{</highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a052fd208dd9ea12039373c6fc9d3f272" kindref="member">stop</ref>;</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="128"><highlight class="normal"></highlight></codeline>
<codeline lineno="129" refid="classcrmfnes_1_1_crfmnes_optimizer_1a07a2bffa713685aa8e13ff615d46081c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_fitness" kindref="compound">Fitness</ref>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a07a2bffa713685aa8e13ff615d46081c" kindref="member">getFitfun</ref>()<sp/>{</highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df" kindref="member">fitfun</ref>;</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="132"><highlight class="normal"></highlight></codeline>
<codeline lineno="133" refid="classcrmfnes_1_1_crfmnes_optimizer_1a7f114cfa6d21f79ace8fed2094960cce" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a7f114cfa6d21f79ace8fed2094960cce" kindref="member">getDim</ref>()<sp/>{</highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>;</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="136"><highlight class="normal"></highlight></codeline>
<codeline lineno="137" refid="classcrmfnes_1_1_crfmnes_optimizer_1ab5d2acf44525abcdfae3a8ec346f345a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab5d2acf44525abcdfae3a8ec346f345a" kindref="member">getPopsize</ref>()<sp/>{</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>;</highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="140"><highlight class="normal"></highlight></codeline>
<codeline lineno="141" refid="classcrmfnes_1_1_crfmnes_optimizer_1ac3695788414c855140e6615040309e42" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ac3695788414c855140e6615040309e42" kindref="member">ask</ref>()<sp/>{</highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>zhalf<sp/>=<sp/><ref refid="evaluator_8h_1a231544ac51b3f9312c104a3b7a3c49a6" kindref="member">normal</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>,<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a36b0425100406234215eea1c9b13e9ce" kindref="member">mu</ref>,<sp/>*<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aadf548da26f22c15246e777fd2a5f850" kindref="member">rs</ref>);</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&lt;<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a36b0425100406234215eea1c9b13e9ce" kindref="member">mu</ref>)<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1" kindref="member">z</ref>.col(i)<sp/>=<sp/>zhalf.col(i);</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1" kindref="member">z</ref>.col(i)<sp/>=<sp/>-zhalf.col(i-<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a36b0425100406234215eea1c9b13e9ce" kindref="member">mu</ref>);</highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a7bc978613195f2ba7b83cc3a48e102ba" kindref="member">normv</ref><sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1acbc3a84327f441962eeda759eb1e888c" kindref="member">v</ref>.norm();</highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e" kindref="member">normv2</ref><sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a7bc978613195f2ba7b83cc3a48e102ba" kindref="member">normv</ref>*<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a7bc978613195f2ba7b83cc3a48e102ba" kindref="member">normv</ref>;</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb" kindref="member">vbar</ref><sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1acbc3a84327f441962eeda759eb1e888c" kindref="member">v</ref><sp/>/<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a7bc978613195f2ba7b83cc3a48e102ba" kindref="member">normv</ref>;</highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a70a1083d613aed87133542c0817f0df9" kindref="member">y</ref><sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1" kindref="member">z</ref><sp/>+<sp/>((sqrt(1<sp/>+<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e" kindref="member">normv2</ref>)<sp/>-<sp/>1.)<sp/>*<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb" kindref="member">vbar</ref><sp/><sp/>*<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb" kindref="member">vbar</ref>.transpose()<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1" kindref="member">z</ref>)));</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab3f078f7cce59803c94ed53e685f2e3b" kindref="member">x</ref><sp/>=<sp/>((<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a4c0820d04c88fd8fee328b76e876b802" kindref="member">sigma</ref><sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a70a1083d613aed87133542c0817f0df9" kindref="member">y</ref>.array()).colwise()<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5" kindref="member">D</ref>.array()).colwise()<sp/>+<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af0db5eb5a3f56f27d4b98d761e72d1a0" kindref="member">m</ref>.array();</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab3f078f7cce59803c94ed53e685f2e3b" kindref="member">x</ref>;</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="154"><highlight class="normal"></highlight></codeline>
<codeline lineno="155" refid="classcrmfnes_1_1_crfmnes_optimizer_1aae1806b3f5cca0f2f27363c38c83a836" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aae1806b3f5cca0f2f27363c38c83a836" kindref="member">tell</ref>(<ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>&amp;evs)<sp/>{</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a676c36938614690f4db2c6d9ccee7df4" kindref="member">evals_no_sort</ref><sp/>=<sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref>(evs);</highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>k<sp/>=<sp/>0;<sp/>k<sp/>&lt;<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>;<sp/>k++)<sp/>{</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!isfinite(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a676c36938614690f4db2c6d9ccee7df4" kindref="member">evals_no_sort</ref>[k]))</highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a676c36938614690f4db2c6d9ccee7df4" kindref="member">evals_no_sort</ref>[k]<sp/>=<sp/>DBL_MAX;</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ad68ee5ba071c8eb355a3fbe1b306adb7" kindref="member">xs_no_sort</ref><sp/>=<sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab3f078f7cce59803c94ed53e685f2e3b" kindref="member">x</ref>);</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d" kindref="member">ivec</ref><sp/>sorted_indices;</highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a129a0aa8de197876c8b303efb52aec42" kindref="member">use_constraint_violation</ref>)<sp/>{</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>violations<sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df" kindref="member">fitfun</ref>-&gt;violations(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab3f078f7cce59803c94ed53e685f2e3b" kindref="member">x</ref>,<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a8e0fa412cfd0b5c7e65ecab47b329cdc" kindref="member">penalty_coef</ref>);</highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sorted_indices<sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a914d39cf65f7277f14b0ed3cbf4e0d73" kindref="member">sort_indices_by</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a676c36938614690f4db2c6d9ccee7df4" kindref="member">evals_no_sort</ref><sp/>+<sp/>violations,<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1" kindref="member">z</ref>);</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sorted_indices<sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a914d39cf65f7277f14b0ed3cbf4e0d73" kindref="member">sort_indices_by</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a676c36938614690f4db2c6d9ccee7df4" kindref="member">evals_no_sort</ref>,<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1" kindref="member">z</ref>);</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>best_eval_id<sp/>=<sp/>sorted_indices[0];</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>f_best_<sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a676c36938614690f4db2c6d9ccee7df4" kindref="member">evals_no_sort</ref>[best_eval_id];</highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1" kindref="member">z</ref><sp/>=<sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1" kindref="member">z</ref>)(Eigen::indexing::all,<sp/>sorted_indices);</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a70a1083d613aed87133542c0817f0df9" kindref="member">y</ref><sp/>=<sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a70a1083d613aed87133542c0817f0df9" kindref="member">y</ref>)(Eigen::indexing::all,<sp/>sorted_indices);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab3f078f7cce59803c94ed53e685f2e3b" kindref="member">x</ref><sp/>=<sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab3f078f7cce59803c94ed53e685f2e3b" kindref="member">x</ref>)(Eigen::indexing::all,<sp/>sorted_indices);</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a85f1a006b0a3aa878e22e0b65517142e" kindref="member">no_of_evals</ref><sp/>+=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>;</highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aad0299e6e1ed76e143db1ef75d1a3c7b" kindref="member">g</ref><sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(f_best_<sp/>&lt;<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae7104ec4f55d2e4bedb9ac8e885cc3d9" kindref="member">f_best</ref>)<sp/>{</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae7104ec4f55d2e4bedb9ac8e885cc3d9" kindref="member">f_best</ref><sp/>=<sp/>f_best_;</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af415b05895f150b3f59613fb3e5a67ed" kindref="member">x_best</ref><sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df" kindref="member">fitfun</ref>-&gt;decode(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ad68ee5ba071c8eb355a3fbe1b306adb7" kindref="member">xs_no_sort</ref>.col(best_eval_id));</highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae7104ec4f55d2e4bedb9ac8e885cc3d9" kindref="member">f_best</ref><sp/>&lt;<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae32d48173c079d73cce875635b480add" kindref="member">stopfitness</ref>)</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a052fd208dd9ea12039373c6fc9d3f272" kindref="member">stop</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//cout<sp/>&lt;&lt;<sp/>f_best<sp/>&lt;&lt;<sp/>endl;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>This<sp/>operation<sp/>assumes<sp/>that<sp/>if<sp/>the<sp/>solution<sp/>is<sp/>infeasible,<sp/>infinity<sp/>comes<sp/>in<sp/>as<sp/>input.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>lambF<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>k<sp/>=<sp/>0;<sp/>k<sp/>&lt;<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>;<sp/>k++)</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a676c36938614690f4db2c6d9ccee7df4" kindref="member">evals_no_sort</ref>[k]<sp/>&lt;<sp/>DBL_MAX)<sp/>lambF++;</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>evolution<sp/>path<sp/>p_sigma</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae3129ee6c7c9205a66634a2f2df6ae0b" kindref="member">ps</ref><sp/>=<sp/>(1<sp/>-<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aff1006f7662b3b17b824b151b40a8165" kindref="member">cs</ref>)<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae3129ee6c7c9205a66634a2f2df6ae0b" kindref="member">ps</ref><sp/>+<sp/>sqrt(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aff1006f7662b3b17b824b151b40a8165" kindref="member">cs</ref><sp/>*<sp/>(2.<sp/>-<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aff1006f7662b3b17b824b151b40a8165" kindref="member">cs</ref>)<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c" kindref="member">mueff</ref>)<sp/>*<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1" kindref="member">z</ref><sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a696d7a7a6fa5842a0aefc5c61de232b6" kindref="member">w_rank</ref>);</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>ps_norm<sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae3129ee6c7c9205a66634a2f2df6ae0b" kindref="member">ps</ref>.norm();</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>distance<sp/>weight</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>w_tmp(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>);</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>k<sp/>=<sp/>0;<sp/>k<sp/>&lt;<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>;<sp/>k++)</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>w_tmp[k]<sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a276111d6b0fdeb972925d988901da9b4" kindref="member">w_rank_hat</ref>[k]<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ad0e305a53657d5e357d198610c0c21e3" kindref="member">w_dist_hat</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1" kindref="member">z</ref>.col(k),<sp/>lambF);</highlight></codeline>
<codeline lineno="194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>weights_dist<sp/>=<sp/>(w_tmp<sp/>/<sp/>w_tmp.sum()).array()<sp/>-<sp/>1.<sp/>/<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>;</highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>switching<sp/>weights<sp/>and<sp/>learning<sp/>rate</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>weights<sp/>=<sp/>ps_norm<sp/>&gt;=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa5b420b40b5781750b33e17ccdb2d2d6" kindref="member">chiN</ref><sp/>?<sp/>weights_dist<sp/>:<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a696d7a7a6fa5842a0aefc5c61de232b6" kindref="member">w_rank</ref>;</highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>eta_sigma<sp/>=<sp/>ps_norm<sp/>&gt;=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa5b420b40b5781750b33e17ccdb2d2d6" kindref="member">chiN</ref><sp/>?<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa686eecadca99ea7ee1064afda80c369" kindref="member">eta_move_sigma</ref><sp/>:</highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(ps_norm<sp/>&gt;=<sp/>0.1<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa5b420b40b5781750b33e17ccdb2d2d6" kindref="member">chiN</ref><sp/>?<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1afa07fb187d0982f0bdcf00c943e9e641" kindref="member">eta_stag_sigma</ref>(lambF)<sp/>:<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a1748dadb5cbf900c7835cabfbb898456" kindref="member">eta_conv_sigma</ref>(lambF));</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>update<sp/>pc,<sp/>m</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>wxm<sp/>=<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab3f078f7cce59803c94ed53e685f2e3b" kindref="member">x</ref>.array().colwise()<sp/>-<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af0db5eb5a3f56f27d4b98d761e72d1a0" kindref="member">m</ref>.array()).matrix()<sp/>*<sp/>weights;</highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ac80232587fb6c3f7ee255f6f008cde98" kindref="member">pc</ref><sp/>=<sp/>(1.<sp/>-<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa5bfe0c1ff87f0fefc54e2246a06c2ad" kindref="member">cc</ref>)<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ac80232587fb6c3f7ee255f6f008cde98" kindref="member">pc</ref><sp/>+<sp/>sqrt(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa5bfe0c1ff87f0fefc54e2246a06c2ad" kindref="member">cc</ref><sp/>*<sp/>(2.<sp/>-<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa5bfe0c1ff87f0fefc54e2246a06c2ad" kindref="member">cc</ref>)<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c" kindref="member">mueff</ref>)<sp/>*<sp/>wxm<sp/>/<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a4c0820d04c88fd8fee328b76e876b802" kindref="member">sigma</ref>;</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af0db5eb5a3f56f27d4b98d761e72d1a0" kindref="member">m</ref><sp/>+=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a352856a88945aa103202f415a9b8b90f" kindref="member">eta_m</ref><sp/>*<sp/>wxm;</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>calculate<sp/>s,<sp/>t</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>step1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>normv4<sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e" kindref="member">normv2</ref><sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e" kindref="member">normv2</ref>;</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>exY(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>,<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>+1);</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>k<sp/>=<sp/>0;<sp/>k<sp/>&lt;<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>;<sp/>k++)</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>exY.col(k)<sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a70a1083d613aed87133542c0817f0df9" kindref="member">y</ref>.col(k);</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>exY.col(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>)<sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ac80232587fb6c3f7ee255f6f008cde98" kindref="member">pc</ref>.array()<sp/>/<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5" kindref="member">D</ref>.array();</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>yy<sp/>=<sp/>exY.array()<sp/>*<sp/>exY.array();<sp/><sp/></highlight><highlight class="comment">//<sp/>dim<sp/>x<sp/>lamb+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>ip_yvbar<sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb" kindref="member">vbar</ref>.transpose()<sp/>*<sp/>exY;</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>yvbar<sp/>=<sp/>exY.array().colwise()<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb" kindref="member">vbar</ref>.array();<sp/></highlight><highlight class="comment">//<sp/>dim<sp/>x<sp/>lamb+1.<sp/>exYvbar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>gammav<sp/>=<sp/>1.<sp/>+<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e" kindref="member">normv2</ref>;</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>vbarbar<sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb" kindref="member">vbar</ref>.array()<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb" kindref="member">vbar</ref>.array();</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>alphavd<sp/>=<sp/>min(1.,<sp/>sqrt(normv4<sp/>+<sp/>(2<sp/>*<sp/>gammav<sp/>-<sp/>sqrt(gammav))<sp/>/<sp/>vbarbar.maxCoeff())<sp/>/<sp/>(2.<sp/>+<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e" kindref="member">normv2</ref>));<sp/><sp/></highlight><highlight class="comment">//<sp/>scalar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>vbar_bc<sp/>=<sp/><ref refid="evaluator_8h_1a909812174fa9829bc49f6e00edb00b90" kindref="member">zeros</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>,<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>+1).colwise()<sp/>+<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb" kindref="member">vbar</ref>;<sp/></highlight><highlight class="comment">//<sp/>broadcasting<sp/>vbar</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>ibg<sp/>=<sp/>(ip_yvbar.array()*ip_yvbar.array())<sp/>+<sp/>gammav;</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>t<sp/>=<sp/>(exY.array().rowwise()<sp/>*<sp/>ip_yvbar.transpose().array())<sp/>-</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(vbar_bc.array().rowwise()<sp/>*<sp/>ibg.transpose().array())<sp/>/<sp/>2.;</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>b<sp/>=<sp/>-(1<sp/>-<sp/>alphavd<sp/>*<sp/>alphavd)<sp/>*<sp/>normv4<sp/>/<sp/>gammav<sp/>+<sp/>2<sp/>*<sp/>alphavd<sp/>*<sp/>alphavd;</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>H<sp/>=<sp/><ref refid="evaluator_8h_1a493b3a74ec3481711548e4b506b009cd" kindref="member">constant</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>,<sp/>2.)<sp/>-<sp/>(b<sp/>+<sp/>2<sp/>*<sp/>alphavd<sp/>*<sp/>alphavd)<sp/>*<sp/>vbarbar;<sp/><sp/></highlight><highlight class="comment">//<sp/>dim<sp/>x<sp/>1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>invH<sp/>=<sp/>1.<sp/>/<sp/>H.array();</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>s_step1<sp/>=<sp/>yy.array()<sp/>-<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e" kindref="member">normv2</ref><sp/>/<sp/>gammav<sp/>*<sp/>(yvbar.array().rowwise()<sp/>*<sp/>ip_yvbar.transpose().array()).array()</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/><ref refid="evaluator_8h_1a493b3a74ec3481711548e4b506b009cd" kindref="member">constant</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>,<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>+1,<sp/>1.).array();<sp/></highlight><highlight class="comment">//<sp/>dim<sp/>x<sp/>lamb+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>ip_vbart<sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb" kindref="member">vbar</ref>.transpose()<sp/>*<sp/>t;<sp/><sp/></highlight><highlight class="comment">//<sp/>1<sp/>x<sp/>lamb+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>s_step2<sp/>=<sp/>s_step1.array()</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>(alphavd<sp/>/<sp/>gammav<sp/>*<sp/>((2<sp/>+<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e" kindref="member">normv2</ref>)<sp/>*<sp/>(t.array().colwise()<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb" kindref="member">vbar</ref>.array()).array()</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e" kindref="member">normv2</ref><sp/>*<sp/>(vbarbar<sp/>*<sp/>ip_vbart.transpose())).array()));<sp/><sp/></highlight><highlight class="comment">//<sp/>dim<sp/>x<sp/>lamb+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>invHvbarbar<sp/>=<sp/>invH.array()<sp/>*<sp/>vbarbar.array();</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>ip_s_step2invHvbarbar<sp/>=<sp/>invHvbarbar.transpose()<sp/>*<sp/>s_step2;<sp/><sp/></highlight><highlight class="comment">//<sp/>1<sp/>x<sp/>lamb+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"></highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>div<sp/>=<sp/>1<sp/>+<sp/>b<sp/>*<sp/>(vbarbar.transpose()<sp/>*<sp/>invHvbarbar)(0,0);</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(div<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="234"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>div<sp/>=<sp/>1E-13;int</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">throw</highlight><highlight class="normal"><sp/>std::invalid_argument(<sp/></highlight><highlight class="stringliteral">&quot;division<sp/>by<sp/>0&quot;</highlight><highlight class="normal"><sp/>);</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>s<sp/>=<sp/>(s_step2.array().colwise()<sp/>*<sp/>invH.array()).array()</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>((b<sp/>/<sp/>div)<sp/>*<sp/>(invHvbarbar<sp/>*<sp/>ip_s_step2invHvbarbar.transpose())).array();<sp/><sp/></highlight><highlight class="comment">//<sp/>dim<sp/>x<sp/>lamb+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="238"><highlight class="normal"></highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>ip_svbarbar<sp/>=<sp/>vbarbar.transpose()<sp/>*<sp/>s;<sp/><sp/></highlight><highlight class="comment">//<sp/>1<sp/>x<sp/>lamb+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>t<sp/>=<sp/>t.array()<sp/>-<sp/>alphavd<sp/>*<sp/>((2<sp/>+<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e" kindref="member">normv2</ref>)<sp/>*<sp/>(s.array().colwise()<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb" kindref="member">vbar</ref>.array()).array()</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb" kindref="member">vbar</ref><sp/>*<sp/>ip_svbarbar.transpose()).array());<sp/><sp/></highlight><highlight class="comment">//<sp/>dim<sp/>x<sp/>lamb+1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>update<sp/>v,<sp/>D</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>exw(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>+1);</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>k<sp/>=<sp/>0;<sp/>k<sp/>&lt;<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>;<sp/>k++)</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>exw[k]<sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae0b69c9a8ba0266efb3fe667de42134f" kindref="member">eta_B</ref>(lambF)<sp/>*<sp/>weights[k];</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>exw[<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>]<sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a61b800bdcb2be2c0add38eabc9bb2df5" kindref="member">c1</ref>(lambF);</highlight></codeline>
<codeline lineno="247"><highlight class="normal"></highlight></codeline>
<codeline lineno="248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1acbc3a84327f441962eeda759eb1e888c" kindref="member">v</ref><sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1acbc3a84327f441962eeda759eb1e888c" kindref="member">v</ref>.array()<sp/>+<sp/>(t<sp/>*<sp/>exw).array()<sp/>/<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a7bc978613195f2ba7b83cc3a48e102ba" kindref="member">normv</ref>;</highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5" kindref="member">D</ref><sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5" kindref="member">D</ref>.array()<sp/>+<sp/>(s<sp/>*<sp/>exw).array()<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5" kindref="member">D</ref>.array();</highlight></codeline>
<codeline lineno="250"><highlight class="normal"></highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>calculate<sp/>detA</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5" kindref="member">D</ref>.minCoeff()<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//throw<sp/>std::invalid_argument(<sp/>&quot;D<sp/>&lt;<sp/>0&quot;<sp/>);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a052fd208dd9ea12039373c6fc9d3f272" kindref="member">stop</ref><sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>nthrootdetA<sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a1c0bc5770261a21ed819387c339b3c05" kindref="member">cexp</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5" kindref="member">D</ref>.array().log().sum()<sp/>/<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref><sp/>+<sp/>log(1<sp/>+<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1acbc3a84327f441962eeda759eb1e888c" kindref="member">v</ref>.transpose()<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1acbc3a84327f441962eeda759eb1e888c" kindref="member">v</ref>)(0,0))<sp/>/<sp/>(2<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>));</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5" kindref="member">D</ref><sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5" kindref="member">D</ref>.array()<sp/>/<sp/>nthrootdetA;</highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>update<sp/>sigma</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>G_s<sp/>=<sp/>(((<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1" kindref="member">z</ref>.array()<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1" kindref="member">z</ref>.array()).array()<sp/>-<sp/><ref refid="evaluator_8h_1a493b3a74ec3481711548e4b506b009cd" kindref="member">constant</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>,<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>,<sp/>1.).array()).matrix()<sp/>*<sp/>weights).sum()<sp/>/<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>;</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a4c0820d04c88fd8fee328b76e876b802" kindref="member">sigma</ref><sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a4c0820d04c88fd8fee328b76e876b802" kindref="member">sigma</ref><sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a1c0bc5770261a21ed819387c339b3c05" kindref="member">cexp</ref>(eta_sigma<sp/>/<sp/>2<sp/>*<sp/>G_s);</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="263"><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="265"><highlight class="normal"></highlight></codeline>
<codeline lineno="266" refid="classcrmfnes_1_1_crfmnes_optimizer_1a1c0bc5770261a21ed819387c339b3c05" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a1c0bc5770261a21ed819387c339b3c05" kindref="member">cexp</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>a)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>exp(min(a,<sp/>100.0));<sp/>}<sp/></highlight><highlight class="comment">//<sp/>avoid<sp/>overflow</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="267" refid="classcrmfnes_1_1_crfmnes_optimizer_1a61b800bdcb2be2c0add38eabc9bb2df5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a61b800bdcb2be2c0add38eabc9bb2df5" kindref="member">c1</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>lambF)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1acf5da4897c7d05b4a560483aa902dc85" kindref="member">c1_cma</ref><sp/>*<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref><sp/>-<sp/>5)<sp/>/<sp/>6<sp/>*<sp/>(lambF<sp/>/<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>);<sp/>}</highlight></codeline>
<codeline lineno="268" refid="classcrmfnes_1_1_crfmnes_optimizer_1ae0b69c9a8ba0266efb3fe667de42134f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae0b69c9a8ba0266efb3fe667de42134f" kindref="member">eta_B</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>lambF)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>tanh((min(0.02<sp/>*<sp/>lambF,<sp/>3<sp/>*<sp/>log(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>))<sp/>+<sp/>5)<sp/>/<sp/>(0.23<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref><sp/>+<sp/>25));<sp/>}</highlight></codeline>
<codeline lineno="269" refid="classcrmfnes_1_1_crfmnes_optimizer_1a13448f49cc0f161fa5fdbd6430cc7804" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a13448f49cc0f161fa5fdbd6430cc7804" kindref="member">alpha_dist</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>lambF)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5" kindref="member">h_inv</ref><sp/>*<sp/>min(1.,<sp/>sqrt(((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>)<sp/>/<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>))<sp/>*<sp/>sqrt(((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)lambF)<sp/>/<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>);<sp/>}</highlight></codeline>
<codeline lineno="270" refid="classcrmfnes_1_1_crfmnes_optimizer_1ad0e305a53657d5e357d198610c0c21e3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ad0e305a53657d5e357d198610c0c21e3" kindref="member">w_dist_hat</ref>(<ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1" kindref="member">z</ref>,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>lambF)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a1c0bc5770261a21ed819387c339b3c05" kindref="member">cexp</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a13448f49cc0f161fa5fdbd6430cc7804" kindref="member">alpha_dist</ref>(lambF)<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1" kindref="member">z</ref>.norm());<sp/>}</highlight></codeline>
<codeline lineno="271" refid="classcrmfnes_1_1_crfmnes_optimizer_1afa07fb187d0982f0bdcf00c943e9e641" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1afa07fb187d0982f0bdcf00c943e9e641" kindref="member">eta_stag_sigma</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>lambF)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>tanh((0.024<sp/>*<sp/>lambF<sp/>+<sp/>0.7<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref><sp/>+<sp/>20.)<sp/>/<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref><sp/>+<sp/>12.));<sp/>}</highlight></codeline>
<codeline lineno="272" refid="classcrmfnes_1_1_crfmnes_optimizer_1a1748dadb5cbf900c7835cabfbb898456" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a1748dadb5cbf900c7835cabfbb898456" kindref="member">eta_conv_sigma</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>lambF)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>2.<sp/>*<sp/>tanh((0.025<sp/>*<sp/>lambF<sp/>+<sp/>0.75<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref><sp/>+<sp/>10.)<sp/>/<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref><sp/>+<sp/>4.));<sp/>}</highlight></codeline>
<codeline lineno="273" refid="classcrmfnes_1_1_crfmnes_optimizer_1a8f9c2b6e89e25a5c3e0d50a8eb4011be" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a8f9c2b6e89e25a5c3e0d50a8eb4011be" kindref="member">f</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>a)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><sp/>((1.<sp/>+<sp/>a<sp/>*<sp/>a)<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a1c0bc5770261a21ed819387c339b3c05" kindref="member">cexp</ref>(a<sp/>*<sp/>a<sp/>/<sp/>2.)<sp/>/<sp/>0.24)<sp/>-<sp/>10.<sp/>-<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>;<sp/>}</highlight></codeline>
<codeline lineno="274" refid="classcrmfnes_1_1_crfmnes_optimizer_1a7f306ac3a58b6ed9f29babc44fbe466b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a7f306ac3a58b6ed9f29babc44fbe466b" kindref="member">f_prime</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>a)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><sp/>(1.<sp/>/<sp/>0.24)<sp/>*<sp/>a<sp/>*<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a1c0bc5770261a21ed819387c339b3c05" kindref="member">cexp</ref>(a<sp/>*<sp/>a<sp/>/<sp/>2.)<sp/>*<sp/>(3.<sp/>+<sp/>a<sp/>*<sp/>a);<sp/>}</highlight></codeline>
<codeline lineno="275"><highlight class="normal"></highlight></codeline>
<codeline lineno="276" refid="classcrmfnes_1_1_crfmnes_optimizer_1af30c10c32f611845931c3a8dc034874f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af30c10c32f611845931c3a8dc034874f" kindref="member">get_h_inv</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>)<sp/>{</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5" kindref="member">h_inv</ref><sp/>=<sp/>1.0;</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(abs(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a8f9c2b6e89e25a5c3e0d50a8eb4011be" kindref="member">f</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5" kindref="member">h_inv</ref>))<sp/>&gt;<sp/>1e-10)</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5" kindref="member">h_inv</ref><sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5" kindref="member">h_inv</ref><sp/>-<sp/>0.5<sp/>*<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a8f9c2b6e89e25a5c3e0d50a8eb4011be" kindref="member">f</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5" kindref="member">h_inv</ref>)<sp/>/<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a7f306ac3a58b6ed9f29babc44fbe466b" kindref="member">f_prime</ref>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5" kindref="member">h_inv</ref>));</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5" kindref="member">h_inv</ref>;</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="282"><highlight class="normal"></highlight></codeline>
<codeline lineno="283" refid="classcrmfnes_1_1_crfmnes_optimizer_1adae78062208e6dc79abad146a0461ec3" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1adae78062208e6dc79abad146a0461ec3" kindref="member">num_feasible</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>&amp;evals)<sp/>{</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>evals.size();<sp/>i++)</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(evals[i]<sp/>!=<sp/>INFINITY)<sp/>n++;</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>n;</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="289"><highlight class="normal"></highlight></codeline>
<codeline lineno="290" refid="classcrmfnes_1_1_crfmnes_optimizer_1a914d39cf65f7277f14b0ed3cbf4e0d73" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d" kindref="member">ivec</ref><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a914d39cf65f7277f14b0ed3cbf4e0d73" kindref="member">sort_indices_by</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>&amp;evals,<sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1" kindref="member">z</ref>)<sp/>{</highlight></codeline>
<codeline lineno="291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>lam<sp/>=<sp/>evals.size();</highlight></codeline>
<codeline lineno="292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d" kindref="member">ivec</ref><sp/>sorted_indices<sp/>=<sp/><ref refid="evaluator_8h_1a7689f88ea48c85c22d9b34208decd67c" kindref="member">sort_index</ref>(evals);</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>sorted_evals<sp/>=<sp/>evals(sorted_indices);</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>no_of_feasible_solutions<sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1adae78062208e6dc79abad146a0461ec3" kindref="member">num_feasible</ref>(sorted_evals);</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(no_of_feasible_solutions<sp/>!=<sp/>lam)<sp/>{</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>distances(lam<sp/>-<sp/>no_of_feasible_solutions);</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>lam;<sp/>i++)</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(evals[i]<sp/>==<sp/>INFINITY)<sp/>{</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>distances[n]<sp/>=<sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1" kindref="member">z</ref>.col(i).squaredNorm();</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n++;</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d" kindref="member">ivec</ref><sp/>indices_sorted_by_distance<sp/>=<sp/><ref refid="evaluator_8h_1a7689f88ea48c85c22d9b34208decd67c" kindref="member">sort_index</ref>(distances);</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>no_of_feasible_solutions;<sp/>i<sp/>&lt;<sp/>lam;<sp/>i++)</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sorted_indices[i]<sp/>=<sp/>sorted_indices[no_of_feasible_solutions</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/>indices_sorted_by_distance[i-no_of_feasible_solutions]];</highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>sorted_indices;</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="310"><highlight class="normal"></highlight></codeline>
<codeline lineno="311" refid="classcrmfnes_1_1_crfmnes_optimizer_1a94ef5ecb5b443d6bea2755f8f5ff101e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>int64_t<sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a94ef5ecb5b443d6bea2755f8f5ff101e" kindref="member">runid</ref>;</highlight></codeline>
<codeline lineno="312" refid="classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_fitness" kindref="compound">Fitness</ref><sp/>*<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a4c445b517a62b00b96b57dfb9813d6df" kindref="member">fitfun</ref>;</highlight></codeline>
<codeline lineno="313" refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae8f11358c33f0923b4a9e8b5717fcc9b" kindref="member">dim</ref>;</highlight></codeline>
<codeline lineno="314" refid="classcrmfnes_1_1_crfmnes_optimizer_1af0db5eb5a3f56f27d4b98d761e72d1a0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af0db5eb5a3f56f27d4b98d761e72d1a0" kindref="member">m</ref>;</highlight></codeline>
<codeline lineno="315" refid="classcrmfnes_1_1_crfmnes_optimizer_1a4c0820d04c88fd8fee328b76e876b802" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a4c0820d04c88fd8fee328b76e876b802" kindref="member">sigma</ref>;</highlight></codeline>
<codeline lineno="316" refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab1d3f2692777e3bd4c769b8a10b9a3cd" kindref="member">lamb</ref>;</highlight></codeline>
<codeline lineno="317" refid="classcrmfnes_1_1_crfmnes_optimizer_1a36b0425100406234215eea1c9b13e9ce" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a36b0425100406234215eea1c9b13e9ce" kindref="member">mu</ref>;</highlight></codeline>
<codeline lineno="318" refid="classcrmfnes_1_1_crfmnes_optimizer_1a129a0aa8de197876c8b303efb52aec42" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a129a0aa8de197876c8b303efb52aec42" kindref="member">use_constraint_violation</ref>;</highlight></codeline>
<codeline lineno="319" refid="classcrmfnes_1_1_crfmnes_optimizer_1aadf548da26f22c15246e777fd2a5f850" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>pcg64<sp/>*<ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aadf548da26f22c15246e777fd2a5f850" kindref="member">rs</ref>;</highlight></codeline>
<codeline lineno="320" refid="classcrmfnes_1_1_crfmnes_optimizer_1acbc3a84327f441962eeda759eb1e888c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1acbc3a84327f441962eeda759eb1e888c" kindref="member">v</ref>;</highlight></codeline>
<codeline lineno="321" refid="classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a684b752fdb0d7c4b1f2cdf467930faf5" kindref="member">D</ref>;</highlight></codeline>
<codeline lineno="322" refid="classcrmfnes_1_1_crfmnes_optimizer_1a8e0fa412cfd0b5c7e65ecab47b329cdc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a8e0fa412cfd0b5c7e65ecab47b329cdc" kindref="member">penalty_coef</ref>;</highlight></codeline>
<codeline lineno="323" refid="classcrmfnes_1_1_crfmnes_optimizer_1a276111d6b0fdeb972925d988901da9b4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a276111d6b0fdeb972925d988901da9b4" kindref="member">w_rank_hat</ref>;</highlight></codeline>
<codeline lineno="324" refid="classcrmfnes_1_1_crfmnes_optimizer_1a696d7a7a6fa5842a0aefc5c61de232b6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a696d7a7a6fa5842a0aefc5c61de232b6" kindref="member">w_rank</ref>;</highlight></codeline>
<codeline lineno="325" refid="classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aab8f01e12fdcb233497debd49422d67c" kindref="member">mueff</ref>;</highlight></codeline>
<codeline lineno="326" refid="classcrmfnes_1_1_crfmnes_optimizer_1aff1006f7662b3b17b824b151b40a8165" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aff1006f7662b3b17b824b151b40a8165" kindref="member">cs</ref>;</highlight></codeline>
<codeline lineno="327" refid="classcrmfnes_1_1_crfmnes_optimizer_1aa5bfe0c1ff87f0fefc54e2246a06c2ad" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa5bfe0c1ff87f0fefc54e2246a06c2ad" kindref="member">cc</ref>;</highlight></codeline>
<codeline lineno="328" refid="classcrmfnes_1_1_crfmnes_optimizer_1acf5da4897c7d05b4a560483aa902dc85" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1acf5da4897c7d05b4a560483aa902dc85" kindref="member">c1_cma</ref>;</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>initialization</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="330" refid="classcrmfnes_1_1_crfmnes_optimizer_1aa5b420b40b5781750b33e17ccdb2d2d6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa5b420b40b5781750b33e17ccdb2d2d6" kindref="member">chiN</ref>;</highlight></codeline>
<codeline lineno="331" refid="classcrmfnes_1_1_crfmnes_optimizer_1ac80232587fb6c3f7ee255f6f008cde98" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ac80232587fb6c3f7ee255f6f008cde98" kindref="member">pc</ref>;</highlight></codeline>
<codeline lineno="332" refid="classcrmfnes_1_1_crfmnes_optimizer_1ae3129ee6c7c9205a66634a2f2df6ae0b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae3129ee6c7c9205a66634a2f2df6ae0b" kindref="member">ps</ref>;</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>distance<sp/>weight<sp/>parameter</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="334" refid="classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1afb276c3887c0b199f31b724b3d4c82e5" kindref="member">h_inv</ref>;</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>learning<sp/>rate</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="336" refid="classcrmfnes_1_1_crfmnes_optimizer_1a352856a88945aa103202f415a9b8b90f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a352856a88945aa103202f415a9b8b90f" kindref="member">eta_m</ref>;</highlight></codeline>
<codeline lineno="337" refid="classcrmfnes_1_1_crfmnes_optimizer_1aa686eecadca99ea7ee1064afda80c369" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa686eecadca99ea7ee1064afda80c369" kindref="member">eta_move_sigma</ref>;</highlight></codeline>
<codeline lineno="338"><highlight class="normal"></highlight></codeline>
<codeline lineno="339" refid="classcrmfnes_1_1_crfmnes_optimizer_1aad0299e6e1ed76e143db1ef75d1a3c7b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aad0299e6e1ed76e143db1ef75d1a3c7b" kindref="member">g</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="340" refid="classcrmfnes_1_1_crfmnes_optimizer_1a85f1a006b0a3aa878e22e0b65517142e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a85f1a006b0a3aa878e22e0b65517142e" kindref="member">no_of_evals</ref>;</highlight></codeline>
<codeline lineno="341" refid="classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af8751cd4ca7041f11f83cb5e3faffde1" kindref="member">z</ref>;</highlight></codeline>
<codeline lineno="342"><highlight class="normal"></highlight></codeline>
<codeline lineno="343" refid="classcrmfnes_1_1_crfmnes_optimizer_1ae7104ec4f55d2e4bedb9ac8e885cc3d9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae7104ec4f55d2e4bedb9ac8e885cc3d9" kindref="member">f_best</ref>;</highlight></codeline>
<codeline lineno="344" refid="classcrmfnes_1_1_crfmnes_optimizer_1af415b05895f150b3f59613fb3e5a67ed" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1af415b05895f150b3f59613fb3e5a67ed" kindref="member">x_best</ref>;</highlight></codeline>
<codeline lineno="345" refid="classcrmfnes_1_1_crfmnes_optimizer_1ad68ee5ba071c8eb355a3fbe1b306adb7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ad68ee5ba071c8eb355a3fbe1b306adb7" kindref="member">xs_no_sort</ref>;</highlight></codeline>
<codeline lineno="346" refid="classcrmfnes_1_1_crfmnes_optimizer_1a676c36938614690f4db2c6d9ccee7df4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a676c36938614690f4db2c6d9ccee7df4" kindref="member">evals_no_sort</ref>;</highlight></codeline>
<codeline lineno="347"><highlight class="normal"></highlight></codeline>
<codeline lineno="348" refid="classcrmfnes_1_1_crfmnes_optimizer_1a9979f360a5500c2e9eb53522659bd745" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a9979f360a5500c2e9eb53522659bd745" kindref="member">iterations</ref>;</highlight></codeline>
<codeline lineno="349" refid="classcrmfnes_1_1_crfmnes_optimizer_1abbde930c83008df3cc0ffc0274f9d42f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1abbde930c83008df3cc0ffc0274f9d42f" kindref="member">maxEvaluations</ref>;</highlight></codeline>
<codeline lineno="350" refid="classcrmfnes_1_1_crfmnes_optimizer_1ae32d48173c079d73cce875635b480add" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ae32d48173c079d73cce875635b480add" kindref="member">stopfitness</ref>;</highlight></codeline>
<codeline lineno="351" refid="classcrmfnes_1_1_crfmnes_optimizer_1a052fd208dd9ea12039373c6fc9d3f272" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a052fd208dd9ea12039373c6fc9d3f272" kindref="member">stop</ref>;</highlight></codeline>
<codeline lineno="352"><highlight class="normal"></highlight></codeline>
<codeline lineno="353" refid="classcrmfnes_1_1_crfmnes_optimizer_1a7bc978613195f2ba7b83cc3a48e102ba" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a7bc978613195f2ba7b83cc3a48e102ba" kindref="member">normv</ref>;</highlight></codeline>
<codeline lineno="354" refid="classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a864c3927e72f4eac9fa682e84396cd0e" kindref="member">normv2</ref>;</highlight></codeline>
<codeline lineno="355" refid="classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1aa12a412b683512f38cfe0dc8e2575dbb" kindref="member">vbar</ref>;</highlight></codeline>
<codeline lineno="356" refid="classcrmfnes_1_1_crfmnes_optimizer_1a70a1083d613aed87133542c0817f0df9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1a70a1083d613aed87133542c0817f0df9" kindref="member">y</ref>;</highlight></codeline>
<codeline lineno="357" refid="classcrmfnes_1_1_crfmnes_optimizer_1ab3f078f7cce59803c94ed53e685f2e3b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer_1ab3f078f7cce59803c94ed53e685f2e3b" kindref="member">x</ref>;</highlight></codeline>
<codeline lineno="358"><highlight class="normal"></highlight></codeline>
<codeline lineno="359"><highlight class="normal">};</highlight></codeline>
<codeline lineno="360"><highlight class="normal">}</highlight></codeline>
<codeline lineno="361"><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"></highlight><highlight class="keyword">using<sp/>namespace<sp/></highlight><highlight class="normal"><ref refid="namespacecrmfnes" kindref="compound">crmfnes</ref>;</highlight></codeline>
<codeline lineno="363"><highlight class="normal"></highlight></codeline>
<codeline lineno="364"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;C&quot;</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="365" refid="crfmnes_8cpp_1a9081791c22cd931e965641b985273b52" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="crfmnes_8cpp_1a9081791c22cd931e965641b985273b52" kindref="member">optimizeCRFMNES_C</ref>(int64_t<sp/><sp/>runid,<sp/><ref refid="evaluator_8h_1a1adc681c70e547867358d25d5cf7eedc" kindref="member">callback_parallel</ref><sp/>func_par,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dim,</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*init,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*lower,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*upper,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigma,</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>maxEvals,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>stopfitness,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>popsize,</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int64_t<sp/><sp/>seed,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>penalty_coef,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>use_constraint_violation,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>normalize,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*<sp/>res)<sp/>{</highlight></codeline>
<codeline lineno="369"><highlight class="normal"></highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>guess(dim),<sp/>lower_limit(dim),<sp/>upper_limit(dim);</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>dim;<sp/>i++)<sp/></highlight><highlight class="comment">//<sp/>guess<sp/>is<sp/>mandatory</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>guess[i]<sp/>=<sp/>init[i];</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(lower<sp/>!=<sp/>NULL<sp/>&amp;&amp;<sp/>upper<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>dim;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>guess[i]<sp/>=<sp/>init[i];</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lower_limit[i]<sp/>=<sp/>lower[i];</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upper_limit[i]<sp/>=<sp/>upper[i];</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lower_limit.resize(0);</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upper_limit.resize(0);</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>normalize<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="384"><highlight class="normal"></highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_fitness" kindref="compound">Fitness</ref><sp/>fitfun(<ref refid="evaluator_8h_1ad0943ebd623281f526e5aee2aa818895" kindref="member">noop_callback</ref>,<sp/>func_par,<sp/>dim,<sp/>1,<sp/>lower_limit,<sp/>upper_limit);</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/>fitfun.<ref refid="class_fitness_1a31beb7ecb5fa49ac03b43abe444ab9a6" kindref="member">setNormalize</ref>(normalize);</highlight></codeline>
<codeline lineno="387"><highlight class="normal"></highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer" kindref="compound">CrfmnesOptimizer</ref><sp/>opt(runid,<sp/>&amp;fitfun,<sp/>dim,<sp/>guess,<sp/>sigma,<sp/>popsize,</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>maxEvals,<sp/>stopfitness,<sp/>penalty_coef,<sp/>use_constraint_violation,<sp/>seed);</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>opt.doOptimize();</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(std::exception<sp/>&amp;e)<sp/>{</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cout<sp/>&lt;&lt;<sp/>e.what()<sp/>&lt;&lt;<sp/>endl;</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>bestX<sp/>=<sp/>opt.getBestX();</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>bestY<sp/>=<sp/>opt.getBestValue();</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>dim;<sp/>i++)</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res[i]<sp/>=<sp/>bestX[i];</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/>res[dim]<sp/>=<sp/>bestY;</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/>res[dim<sp/>+<sp/>1]<sp/>=<sp/>fitfun.<ref refid="class_fitness_1aba60038eac4e0e15d995e57f4ba079e1" kindref="member">evaluations</ref>();</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/>res[dim<sp/>+<sp/>2]<sp/>=<sp/>opt.getIterations();</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/>res[dim<sp/>+<sp/>3]<sp/>=<sp/>opt.getStop();</highlight></codeline>
<codeline lineno="403"><highlight class="normal">}</highlight></codeline>
<codeline lineno="404"><highlight class="normal"></highlight></codeline>
<codeline lineno="405" refid="crfmnes_8cpp_1a8ad70c1b6cadd1ed7b3bfa0d60d96911" refkind="member"><highlight class="normal">uintptr_t<sp/><ref refid="crfmnes_8cpp_1a8ad70c1b6cadd1ed7b3bfa0d60d96911" kindref="member">initCRFMNES_C</ref>(int64_t<sp/><sp/>runid,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dim,</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*init,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*lower,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*upper,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sigma,</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>popsize,<sp/>int64_t<sp/><sp/>seed,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>penalty_coef,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>use_constraint_violation,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>normalize)<sp/>{</highlight></codeline>
<codeline lineno="408"><highlight class="normal"></highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>guess(dim),<sp/>lower_limit(dim),<sp/>upper_limit(dim);</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>dim;<sp/>i++)<sp/></highlight><highlight class="comment">//<sp/>guess<sp/>is<sp/>mandatory</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>guess[i]<sp/>=<sp/>init[i];</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(lower<sp/>!=<sp/>NULL<sp/>&amp;&amp;<sp/>upper<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>dim;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>guess[i]<sp/>=<sp/>init[i];</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lower_limit[i]<sp/>=<sp/>lower[i];</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upper_limit[i]<sp/>=<sp/>upper[i];</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lower_limit.resize(0);</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upper_limit.resize(0);</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>normalize<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="class_fitness" kindref="compound">Fitness</ref>*<sp/>fitfun<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_fitness" kindref="compound">Fitness</ref>(<ref refid="evaluator_8h_1ad0943ebd623281f526e5aee2aa818895" kindref="member">noop_callback</ref>,<sp/><ref refid="evaluator_8h_1ac05c49788a31e5f7cb8efbe8ca3b548e" kindref="member">noop_callback_par</ref>,<sp/>dim,<sp/>1,<sp/>lower_limit,<sp/>upper_limit);</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/>fitfun-&gt;<ref refid="class_fitness_1a31beb7ecb5fa49ac03b43abe444ab9a6" kindref="member">setNormalize</ref>(normalize);</highlight></codeline>
<codeline lineno="425"><highlight class="normal"></highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer" kindref="compound">CrfmnesOptimizer</ref>*<sp/>opt<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer" kindref="compound">CrfmnesOptimizer</ref>(runid,<sp/>fitfun,<sp/>dim,<sp/>guess,<sp/>sigma,<sp/>popsize,</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0,<sp/>-DBL_MAX,<sp/>penalty_coef,<sp/>use_constraint_violation,<sp/>seed);</highlight></codeline>
<codeline lineno="428"><highlight class="normal"></highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(uintptr_t)<sp/>opt;</highlight></codeline>
<codeline lineno="430"><highlight class="normal">}</highlight></codeline>
<codeline lineno="431"><highlight class="normal"></highlight></codeline>
<codeline lineno="432" refid="crfmnes_8cpp_1a22d09131327c77abfd090eaa649faf5d" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="crfmnes_8cpp_1a22d09131327c77abfd090eaa649faf5d" kindref="member">destroyCRFMNES_C</ref>(uintptr_t<sp/>ptr)<sp/>{</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer" kindref="compound">CrfmnesOptimizer</ref>*<sp/>opt<sp/>=<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer" kindref="compound">CrfmnesOptimizer</ref>*)ptr;</highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_fitness" kindref="compound">Fitness</ref>*<sp/>fitfun<sp/>=<sp/>opt-&gt;getFitfun();</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>fitfun;</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>opt;</highlight></codeline>
<codeline lineno="437"><highlight class="normal">}</highlight></codeline>
<codeline lineno="438"><highlight class="normal"></highlight></codeline>
<codeline lineno="439" refid="crfmnes_8cpp_1aa1796ba79109494532e2a57b9555b7e5" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="crfmnes_8cpp_1aa1796ba79109494532e2a57b9555b7e5" kindref="member">askCRFMNES_C</ref>(uintptr_t<sp/>ptr,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*<sp/>xs)<sp/>{</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer" kindref="compound">CrfmnesOptimizer</ref><sp/>*opt<sp/>=<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer" kindref="compound">CrfmnesOptimizer</ref>*)<sp/>ptr;</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n<sp/>=<sp/>opt-&gt;getDim();</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>lamb<sp/>=<sp/>opt-&gt;getPopsize();</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>popX<sp/>=<sp/>opt-&gt;ask();</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_fitness" kindref="compound">Fitness</ref>*<sp/>fitfun<sp/>=<sp/>opt-&gt;getFitfun();</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>p<sp/>=<sp/>0;<sp/>p<sp/>&lt;<sp/>lamb;<sp/>p++)<sp/>{</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>x<sp/>=<sp/>fitfun-&gt;<ref refid="class_fitness_1a2085e5ce1a0afa5949366f580d5ec5a4" kindref="member">getClosestFeasible</ref>(fitfun-&gt;<ref refid="class_fitness_1a7fdca1fda75e3976b91e1e9e0eb12057" kindref="member">decode</ref>(popX.col(p)));</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n;<sp/>i++)</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xs[p<sp/>*<sp/>n<sp/>+<sp/>i]<sp/>=<sp/>x[i];</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="450"><highlight class="normal">}</highlight></codeline>
<codeline lineno="451"><highlight class="normal"></highlight></codeline>
<codeline lineno="452" refid="crfmnes_8cpp_1a39b04e71778a1006c8cc1bea2d082074" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="crfmnes_8cpp_1a39b04e71778a1006c8cc1bea2d082074" kindref="member">tellCRFMNES_C</ref>(uintptr_t<sp/>ptr,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*<sp/>ys)<sp/>{</highlight><highlight class="comment">//,<sp/>double*<sp/>xs)<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer" kindref="compound">CrfmnesOptimizer</ref><sp/>*opt<sp/>=<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer" kindref="compound">CrfmnesOptimizer</ref>*)<sp/>ptr;</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>lamb<sp/>=<sp/>opt-&gt;getPopsize();</highlight></codeline>
<codeline lineno="455"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>int<sp/>dim<sp/>=<sp/>opt-&gt;getDim();</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="456"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>Fitness*<sp/>fitfun<sp/>=<sp/>opt-&gt;getFitfun();</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="457"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>mat<sp/>popX(dim,<sp/>lamb);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="458"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>for<sp/>(int<sp/>p<sp/>=<sp/>0;<sp/>p<sp/>&lt;<sp/>lamb;<sp/>p++)<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="459"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vec<sp/>x(dim);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="460"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>for<sp/>(int<sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>dim;<sp/>i++)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="461"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x[i]<sp/>=<sp/>xs[p<sp/>*<sp/>dim<sp/>+<sp/>i];</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="462"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>popX.col(p)<sp/>=<sp/>fitfun-&gt;decode(x);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="463"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>vals(lamb);</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>lamb;<sp/>i++)</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vals[i]<sp/>=<sp/>ys[i];</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/>opt-&gt;tell(vals);</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>opt-&gt;getStop();</highlight></codeline>
<codeline lineno="469"><highlight class="normal">}</highlight></codeline>
<codeline lineno="470"><highlight class="normal"></highlight></codeline>
<codeline lineno="471" refid="crfmnes_8cpp_1ae309750075a3655886dcf9647435b799" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="crfmnes_8cpp_1ae309750075a3655886dcf9647435b799" kindref="member">populationCRFMNES_C</ref>(uintptr_t<sp/>ptr,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*<sp/>xs)<sp/>{</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer" kindref="compound">CrfmnesOptimizer</ref><sp/>*opt<sp/>=<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer" kindref="compound">CrfmnesOptimizer</ref>*)<sp/>ptr;</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dim<sp/>=<sp/>opt-&gt;getDim();</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>lamb<sp/>=<sp/>opt-&gt;getPopsize();</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>popX<sp/>=<sp/>opt-&gt;getPopulation();</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>p<sp/>=<sp/>0;<sp/>p<sp/>&lt;<sp/>lamb;<sp/>p++)<sp/>{</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>x<sp/>=<sp/>popX.col(p);</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>dim;<sp/>i++)</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x[i]<sp/>=<sp/>xs[p<sp/>*<sp/>dim<sp/>+<sp/>i];</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>opt-&gt;getStop();</highlight></codeline>
<codeline lineno="482"><highlight class="normal">}</highlight></codeline>
<codeline lineno="483"><highlight class="normal"></highlight></codeline>
<codeline lineno="484" refid="crfmnes_8cpp_1aefaccee22121ee2d0f43d33fd5968c22" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="crfmnes_8cpp_1aefaccee22121ee2d0f43d33fd5968c22" kindref="member">resultCRFMNES_C</ref>(uintptr_t<sp/>ptr,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*<sp/>res)<sp/>{</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classcrmfnes_1_1_crfmnes_optimizer" kindref="compound">CrfmnesOptimizer</ref><sp/>*opt<sp/>=<sp/>(<ref refid="classcrmfnes_1_1_crfmnes_optimizer" kindref="compound">CrfmnesOptimizer</ref>*)<sp/>ptr;</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>bestX<sp/>=<sp/>opt-&gt;getBestX();</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>bestY<sp/>=<sp/>opt-&gt;getBestValue();</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n<sp/>=<sp/>bestX.size();</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>bestX.size();<sp/>i++)</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res[i]<sp/>=<sp/>bestX[i];</highlight></codeline>
<codeline lineno="491"><highlight class="normal"><sp/><sp/><sp/><sp/>res[n]<sp/>=<sp/>bestY;</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_fitness" kindref="compound">Fitness</ref>*<sp/>fitfun<sp/>=<sp/>opt-&gt;getFitfun();</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/>res[n<sp/>+<sp/>1]<sp/>=<sp/>fitfun-&gt;<ref refid="class_fitness_1aba60038eac4e0e15d995e57f4ba079e1" kindref="member">evaluations</ref>();</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/>res[n<sp/>+<sp/>2]<sp/>=<sp/>opt-&gt;getIterations();</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/>res[n<sp/>+<sp/>3]<sp/>=<sp/>opt-&gt;getStop();</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>opt-&gt;getStop();</highlight></codeline>
<codeline lineno="497"><highlight class="normal">}</highlight></codeline>
<codeline lineno="498"><highlight class="normal"></highlight></codeline>
<codeline lineno="499"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="_fcmaescpp/crfmnes.cpp"/>
  </compounddef>
</doxygen>
