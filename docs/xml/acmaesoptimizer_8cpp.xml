<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.13.2" xml:lang="en-US">
  <compounddef id="acmaesoptimizer_8cpp" kind="file" language="C++">
    <compoundname>acmaesoptimizer.cpp</compoundname>
    <includes local="no">Eigen/Core</includes>
    <includes local="no">Eigen/Eigenvalues</includes>
    <includes local="no">iostream</includes>
    <includes local="no">random</includes>
    <includes local="no">float.h</includes>
    <includes local="no">stdint.h</includes>
    <includes local="no">ctime</includes>
    <includes refid="evaluator_8h" local="yes">evaluator.h</includes>
    <incdepgraph>
      <node id="1">
        <label>_fcmaescpp/acmaesoptimizer.cpp</label>
        <link refid="acmaesoptimizer_8cpp"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="9">
        <label>evaluator.h</label>
        <link refid="evaluator_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>Eigen/Core</label>
      </node>
      <node id="3">
        <label>Eigen/Eigenvalues</label>
      </node>
      <node id="10">
        <label>algorithm</label>
      </node>
      <node id="15">
        <label>chrono</label>
      </node>
      <node id="16">
        <label>condition_variable</label>
      </node>
      <node id="8">
        <label>ctime</label>
      </node>
      <node id="6">
        <label>float.h</label>
      </node>
      <node id="4">
        <label>iostream</label>
      </node>
      <node id="12">
        <label>mutex</label>
      </node>
      <node id="17">
        <label>pcg_random.hpp</label>
      </node>
      <node id="11">
        <label>queue</label>
      </node>
      <node id="5">
        <label>random</label>
      </node>
      <node id="7">
        <label>stdint.h</label>
      </node>
      <node id="13">
        <label>thread</label>
      </node>
      <node id="14">
        <label>vector</label>
      </node>
    </incdepgraph>
    <innerclass refid="classacmaes_1_1_acmaes_optimizer" prot="public">acmaes::AcmaesOptimizer</innerclass>
    <innernamespace refid="namespaceacmaes">acmaes</innernamespace>
    <innernamespace refid="namespacestd">std</innernamespace>
    <sectiondef kind="func">
      <memberdef kind="function" id="namespaceacmaes_1a8f3b844e07e4684f10852956288758de" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d" kindref="member">ivec</ref></type>
        <definition>static ivec acmaes::inverse</definition>
        <argsstring>(const ivec &amp;indices)</argsstring>
        <name>inverse</name>
        <qualifiedname>acmaes::inverse</qualifiedname>
        <param>
          <type>const <ref refid="daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d" kindref="member">ivec</ref> &amp;</type>
          <declname>indices</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="_fcmaescpp/acmaesoptimizer.cpp" line="34" column="13" bodyfile="_fcmaescpp/acmaesoptimizer.cpp" bodystart="34" bodyend="39"/>
        <references refid="namespaceacmaes_1a8f3b844e07e4684f10852956288758de" compoundref="acmaesoptimizer_8cpp" startline="34" endline="39">acmaes::inverse</references>
        <referencedby refid="namespaceacmaes_1a8f3b844e07e4684f10852956288758de" compoundref="acmaesoptimizer_8cpp" startline="34" endline="39">acmaes::inverse</referencedby>
        <referencedby refid="classacmaes_1_1_acmaes_optimizer_1a911e67d9e8445b3a8be575f184341b8e" compoundref="acmaesoptimizer_8cpp" startline="201" endline="242">acmaes::AcmaesOptimizer::updateCovariance</referencedby>
      </memberdef>
      <memberdef kind="function" id="namespaceacmaes_1aa2100c3aed4c265a18c551b1c748a588" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref></type>
        <definition>static vec acmaes::sequence</definition>
        <argsstring>(double start, double end, double step)</argsstring>
        <name>sequence</name>
        <qualifiedname>acmaes::sequence</qualifiedname>
        <param>
          <type>double</type>
          <declname>start</declname>
        </param>
        <param>
          <type>double</type>
          <declname>end</declname>
        </param>
        <param>
          <type>double</type>
          <declname>step</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="_fcmaescpp/acmaesoptimizer.cpp" line="41" column="12" bodyfile="_fcmaescpp/acmaesoptimizer.cpp" bodystart="41" bodyend="50"/>
        <referencedby refid="classacmaes_1_1_acmaes_optimizer_1a1a141c42370061770c70d35a2e72e22f" compoundref="acmaesoptimizer_8cpp" startline="56" endline="174">acmaes::AcmaesOptimizer::AcmaesOptimizer</referencedby>
      </memberdef>
      <memberdef kind="function" id="acmaesoptimizer_8cpp_1afc81c91b36bdd348c03d272ec53f027a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void optimizeACMA_C</definition>
        <argsstring>(long runid, callback_type func, callback_parallel func_par, int dim, double *init, double *lower, double *upper, double *sigma, int maxEvals, double stopfitness, double stopTolHistFun, int mu, int popsize, double accuracy, long seed, bool normalize, bool use_delayed_update, int update_gap, int workers, double *res)</argsstring>
        <name>optimizeACMA_C</name>
        <param>
          <type>long</type>
          <declname>runid</declname>
        </param>
        <param>
          <type><ref refid="evaluator_8h_1af419da391481d5e767cbe038009da309" kindref="member">callback_type</ref></type>
          <declname>func</declname>
        </param>
        <param>
          <type><ref refid="evaluator_8h_1a1adc681c70e547867358d25d5cf7eedc" kindref="member">callback_parallel</ref></type>
          <declname>func_par</declname>
        </param>
        <param>
          <type>int</type>
          <declname>dim</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>init</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>lower</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>upper</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>sigma</declname>
        </param>
        <param>
          <type>int</type>
          <declname>maxEvals</declname>
        </param>
        <param>
          <type>double</type>
          <declname>stopfitness</declname>
        </param>
        <param>
          <type>double</type>
          <declname>stopTolHistFun</declname>
        </param>
        <param>
          <type>int</type>
          <declname>mu</declname>
        </param>
        <param>
          <type>int</type>
          <declname>popsize</declname>
        </param>
        <param>
          <type>double</type>
          <declname>accuracy</declname>
        </param>
        <param>
          <type>long</type>
          <declname>seed</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>normalize</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>use_delayed_update</declname>
        </param>
        <param>
          <type>int</type>
          <declname>update_gap</declname>
        </param>
        <param>
          <type>int</type>
          <declname>workers</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>res</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="_fcmaescpp/acmaesoptimizer.cpp" line="560" column="6" bodyfile="_fcmaescpp/acmaesoptimizer.cpp" bodystart="560" bodyend="604"/>
        <references refid="class_fitness_1a31beb7ecb5fa49ac03b43abe444ab9a6" compoundref="evaluator_8h" startline="333" endline="335">Fitness::setNormalize</references>
      </memberdef>
      <memberdef kind="function" id="acmaesoptimizer_8cpp_1ab128d45080b4023edb28550611997afe" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>uintptr_t</type>
        <definition>uintptr_t initACMA_C</definition>
        <argsstring>(long runid, int dim, double *init, double *lower, double *upper, double *sigma, int maxEvals, double stopfitness, double stopTolHistFun, int mu, int popsize, double accuracy, long seed, bool normalize, bool use_delayed_update, int update_gap)</argsstring>
        <name>initACMA_C</name>
        <param>
          <type>long</type>
          <declname>runid</declname>
        </param>
        <param>
          <type>int</type>
          <declname>dim</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>init</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>lower</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>upper</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>sigma</declname>
        </param>
        <param>
          <type>int</type>
          <declname>maxEvals</declname>
        </param>
        <param>
          <type>double</type>
          <declname>stopfitness</declname>
        </param>
        <param>
          <type>double</type>
          <declname>stopTolHistFun</declname>
        </param>
        <param>
          <type>int</type>
          <declname>mu</declname>
        </param>
        <param>
          <type>int</type>
          <declname>popsize</declname>
        </param>
        <param>
          <type>double</type>
          <declname>accuracy</declname>
        </param>
        <param>
          <type>long</type>
          <declname>seed</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>normalize</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>use_delayed_update</declname>
        </param>
        <param>
          <type>int</type>
          <declname>update_gap</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="_fcmaescpp/acmaesoptimizer.cpp" line="606" column="11" bodyfile="_fcmaescpp/acmaesoptimizer.cpp" bodystart="606" bodyend="634"/>
        <references refid="evaluator_8h_1ad0943ebd623281f526e5aee2aa818895" compoundref="evaluator_8h" startline="86" endline="88">noop_callback</references>
        <references refid="evaluator_8h_1ac05c49788a31e5f7cb8efbe8ca3b548e" compoundref="evaluator_8h" startline="90" endline="91">noop_callback_par</references>
        <references refid="class_fitness_1a31beb7ecb5fa49ac03b43abe444ab9a6" compoundref="evaluator_8h" startline="333" endline="335">Fitness::setNormalize</references>
      </memberdef>
      <memberdef kind="function" id="acmaesoptimizer_8cpp_1a7b2394fc01d8d5612733f943d54a8982" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void destroyACMA_C</definition>
        <argsstring>(uintptr_t ptr)</argsstring>
        <name>destroyACMA_C</name>
        <param>
          <type>uintptr_t</type>
          <declname>ptr</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="_fcmaescpp/acmaesoptimizer.cpp" line="636" column="6" bodyfile="_fcmaescpp/acmaesoptimizer.cpp" bodystart="636" bodyend="641"/>
      </memberdef>
      <memberdef kind="function" id="acmaesoptimizer_8cpp_1afd9ea227572135d9dd02fe7ec9d489e4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void askACMA_C</definition>
        <argsstring>(uintptr_t ptr, double *xs)</argsstring>
        <name>askACMA_C</name>
        <param>
          <type>uintptr_t</type>
          <declname>ptr</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>xs</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="_fcmaescpp/acmaesoptimizer.cpp" line="643" column="6" bodyfile="_fcmaescpp/acmaesoptimizer.cpp" bodystart="643" bodyend="654"/>
        <references refid="class_fitness_1a7fdca1fda75e3976b91e1e9e0eb12057" compoundref="evaluator_8h" startline="348" endline="353">Fitness::decode</references>
      </memberdef>
      <memberdef kind="function" id="acmaesoptimizer_8cpp_1a2cb3fdf36ee5dee68f436f1efa6be820" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int tellACMA_C</definition>
        <argsstring>(uintptr_t ptr, double *ys)</argsstring>
        <name>tellACMA_C</name>
        <param>
          <type>uintptr_t</type>
          <declname>ptr</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>ys</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="_fcmaescpp/acmaesoptimizer.cpp" line="656" column="5" bodyfile="_fcmaescpp/acmaesoptimizer.cpp" bodystart="656" bodyend="664"/>
      </memberdef>
      <memberdef kind="function" id="acmaesoptimizer_8cpp_1ac4c1234b83df26634971a6707db1809d" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int tellXACMA_C</definition>
        <argsstring>(uintptr_t ptr, double *ys, double *xs)</argsstring>
        <name>tellXACMA_C</name>
        <param>
          <type>uintptr_t</type>
          <declname>ptr</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>ys</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>xs</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="_fcmaescpp/acmaesoptimizer.cpp" line="666" column="5" bodyfile="_fcmaescpp/acmaesoptimizer.cpp" bodystart="666" bodyend="683"/>
        <references refid="class_fitness_1ab56956f8f382ffe1b9de9d35d156a65e" compoundref="evaluator_8h" startline="341" endline="346">Fitness::encode</references>
      </memberdef>
      <memberdef kind="function" id="acmaesoptimizer_8cpp_1a76a358e67b1d48a0f0f7813dd201efdf" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int populationACMA_C</definition>
        <argsstring>(uintptr_t ptr, double *xs)</argsstring>
        <name>populationACMA_C</name>
        <param>
          <type>uintptr_t</type>
          <declname>ptr</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>xs</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="_fcmaescpp/acmaesoptimizer.cpp" line="685" column="5" bodyfile="_fcmaescpp/acmaesoptimizer.cpp" bodystart="685" bodyend="696"/>
      </memberdef>
      <memberdef kind="function" id="acmaesoptimizer_8cpp_1abe96370a07bb4c8fff0bc6e13e105c29" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int resultACMA_C</definition>
        <argsstring>(uintptr_t ptr, double *res)</argsstring>
        <name>resultACMA_C</name>
        <param>
          <type>uintptr_t</type>
          <declname>ptr</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>res</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="_fcmaescpp/acmaesoptimizer.cpp" line="698" column="5" bodyfile="_fcmaescpp/acmaesoptimizer.cpp" bodystart="698" bodyend="711"/>
        <references refid="class_fitness_1aba60038eac4e0e15d995e57f4ba079e1" compoundref="evaluator_8h" startline="313" endline="315">Fitness::evaluations</references>
      </memberdef>
      <memberdef kind="function" id="acmaesoptimizer_8cpp_1a679cc7980203dbcbbe97d11014fdb5bf" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int</type>
        <definition>int testACMA_C</definition>
        <argsstring>(int n, double *res)</argsstring>
        <name>testACMA_C</name>
        <param>
          <type>int</type>
          <declname>n</declname>
        </param>
        <param>
          <type>double *</type>
          <declname>res</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="_fcmaescpp/acmaesoptimizer.cpp" line="713" column="5" bodyfile="_fcmaescpp/acmaesoptimizer.cpp" bodystart="713" bodyend="719"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">//<sp/>Copyright<sp/>(c)<sp/>Dietmar<sp/>Wolz.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">//<sp/>This<sp/>source<sp/>code<sp/>is<sp/>licensed<sp/>under<sp/>the<sp/>MIT<sp/>license<sp/>found<sp/>in<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="comment">//<sp/>LICENSE<sp/>file<sp/>in<sp/>the<sp/>root<sp/>directory.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Eigen<sp/>based<sp/>implementation<sp/>of<sp/>active<sp/>CMA-ES</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Supports<sp/>parallel<sp/>fitness<sp/>function<sp/>evaluation.<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="comment">//<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="comment">//<sp/>For<sp/>expensive<sp/>objective<sp/>functions<sp/>(e.g.<sp/>machine<sp/>learning<sp/>parameter<sp/>optimization)<sp/>use<sp/>the<sp/>workers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="comment">//<sp/>parameter<sp/>to<sp/>parallelize<sp/>objective<sp/>function<sp/>evaluation.<sp/>The<sp/>workers<sp/>parameter<sp/>should<sp/>be<sp/>limited</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="comment">//<sp/>the<sp/>population<sp/>size<sp/>because<sp/>otherwize<sp/>poulation<sp/>update<sp/>is<sp/>delayed.<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Derived<sp/>from<sp/>http://cma.gforge.inria.fr/cmaes.m<sp/>which<sp/>follows</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight><highlight class="comment">//<sp/>https://www.researchgate.net/publication/227050324_The_CMA_Evolution_Strategy_A_Comparing_Review</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Requires<sp/>Eigen<sp/>version<sp/>&gt;=<sp/>3.4<sp/>because<sp/>new<sp/>slicing<sp/>capabilities<sp/>are<sp/>used,<sp/>see</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="comment">//<sp/>https://eigen.tuxfamily.org/dox-devel/group__TutorialSlicingIndexing.html</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="comment">//<sp/>requires<sp/>https://github.com/bab2min/EigenRand<sp/>for<sp/>random<sp/>number<sp/>generation.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Eigen/Core&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;Eigen/Eigenvalues&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;iostream&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;random&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;float.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdint.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;ctime&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="evaluator_8h" kindref="compound">evaluator.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="keyword">using<sp/>namespace<sp/></highlight><highlight class="normal">std;</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight></codeline>
<codeline lineno="32" refid="namespaceacmaes" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespaceacmaes" kindref="compound">acmaes</ref><sp/>{</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight></codeline>
<codeline lineno="34" refid="namespaceacmaes_1a8f3b844e07e4684f10852956288758de" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d" kindref="member">ivec</ref><sp/><ref refid="namespaceacmaes_1a8f3b844e07e4684f10852956288758de" kindref="member">inverse</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d" kindref="member">ivec</ref><sp/>&amp;indices)<sp/>{</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d" kindref="member">ivec</ref><sp/><ref refid="namespaceacmaes_1a8f3b844e07e4684f10852956288758de" kindref="member">inverse</ref><sp/>=<sp/><ref refid="daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d" kindref="member">ivec</ref>(indices.size());</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>indices.size();<sp/>i++)</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="namespaceacmaes_1a8f3b844e07e4684f10852956288758de" kindref="member">inverse</ref>(indices(i))<sp/>=<sp/>i;</highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="namespaceacmaes_1a8f3b844e07e4684f10852956288758de" kindref="member">inverse</ref>;</highlight></codeline>
<codeline lineno="39"><highlight class="normal">}</highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight></codeline>
<codeline lineno="41" refid="namespaceacmaes_1aa2100c3aed4c265a18c551b1c748a588" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="namespaceacmaes_1aa2100c3aed4c265a18c551b1c748a588" kindref="member">sequence</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>start,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>end,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>step)<sp/>{</highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>size<sp/>=<sp/>(int)<sp/>((end<sp/>-<sp/>start)<sp/>/<sp/>step<sp/>+<sp/>1);</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>d(size);</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>value<sp/>=<sp/>start;</highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>r<sp/>=<sp/>0;<sp/>r<sp/>&lt;<sp/>size;<sp/>r++)<sp/>{</highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>d(r)<sp/>=<sp/>value;</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>value<sp/>+=<sp/>step;</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>d;</highlight></codeline>
<codeline lineno="50"><highlight class="normal">}</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="52" refid="classacmaes_1_1_acmaes_optimizer" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classacmaes_1_1_acmaes_optimizer_1a1a141c42370061770c70d35a2e72e22f" kindref="member">AcmaesOptimizer</ref><sp/>{</highlight></codeline>
<codeline lineno="53"><highlight class="normal"></highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="55"><highlight class="normal"></highlight></codeline>
<codeline lineno="56" refid="classacmaes_1_1_acmaes_optimizer_1a1a141c42370061770c70d35a2e72e22f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a1a141c42370061770c70d35a2e72e22f" kindref="member">AcmaesOptimizer</ref>(</highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>runid_,<sp/><ref refid="class_fitness" kindref="compound">Fitness</ref><sp/>*fitfun_,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>popsize_,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>mu_,</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>&amp;guess_,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>&amp;inputSigma_,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>maxEvaluations_,</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>accuracy_,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>stopfitness_,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>stopTolHistFun_,</highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>update_gap_,<sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>seed)<sp/>{</highlight></codeline>
<codeline lineno="60"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>runid<sp/>used<sp/>for<sp/>debugging<sp/>/<sp/>logging</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a755e250be4d7f61b3d813a4f13a25282" kindref="member">runid</ref><sp/>=<sp/>runid_;</highlight></codeline>
<codeline lineno="62"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>fitness<sp/>function<sp/>to<sp/>minimize</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref><sp/>=<sp/>fitfun_;</highlight></codeline>
<codeline lineno="64"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>initial<sp/>guess<sp/>for<sp/>the<sp/>arguments<sp/>of<sp/>the<sp/>fitness<sp/>function</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a73710e1f7b550eb765980f6d8205acd2" kindref="member">guess</ref><sp/>=<sp/>guess_;</highlight></codeline>
<codeline lineno="66"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>accuracy<sp/>=<sp/>1.0<sp/>is<sp/>default,<sp/>&gt;<sp/>1.0<sp/>reduces<sp/>accuracy</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1af49bb3ec0e42ef7f4cbfe3934abc026a" kindref="member">accuracy</ref><sp/>=<sp/>accuracy_;</highlight></codeline>
<codeline lineno="68"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>number<sp/>of<sp/>objective<sp/>variables/problem<sp/>dimension</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref><sp/>=<sp/>guess_.size();</highlight></codeline>
<codeline lineno="70"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>population<sp/>size,<sp/>offspring<sp/>number.<sp/>The<sp/>primary<sp/>strategy<sp/>parameter<sp/>to<sp/>play</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="71"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>with,<sp/>which<sp/>can<sp/>be<sp/>increased<sp/>from<sp/>its<sp/>default<sp/>value.<sp/>Increasing<sp/>the</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="72"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>population<sp/>size<sp/>improves<sp/>global<sp/>search<sp/>properties<sp/>in<sp/>exchange<sp/>to<sp/>speed.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Speed<sp/>decreases,<sp/>as<sp/>a<sp/>rule,<sp/>at<sp/>most<sp/>linearly<sp/>with<sp/>increasing<sp/>population</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>size.<sp/>It<sp/>is<sp/>advisable<sp/>to<sp/>begin<sp/>with<sp/>the<sp/>default<sp/>small<sp/>population<sp/>size.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(popsize_<sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="76"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref><sp/>=<sp/>popsize_;</highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref><sp/>=<sp/>4<sp/>+<sp/>int(3.<sp/>*<sp/>log(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>));</highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>individual<sp/>sigma<sp/>values<sp/>-<sp/>initial<sp/>search<sp/>volume.<sp/>inputSigma<sp/>determines</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>the<sp/>initial<sp/>coordinate<sp/>wise<sp/>standard<sp/>deviations<sp/>for<sp/>the<sp/>search.<sp/>Setting</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>SIGMA<sp/>one<sp/>third<sp/>of<sp/>the<sp/>initial<sp/>search<sp/>region<sp/>is<sp/>appropriate.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(inputSigma_.size()<sp/>==<sp/>1)</highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1aa64448926972de66e258f3eae95993d4" kindref="member">inputSigma</ref><sp/>=<sp/>vec::Constant(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>,<sp/>inputSigma_[0]);</highlight></codeline>
<codeline lineno="84"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1aa64448926972de66e258f3eae95993d4" kindref="member">inputSigma</ref><sp/>=<sp/>inputSigma_;</highlight></codeline>
<codeline lineno="86"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>overall<sp/>standard<sp/>deviation<sp/>-<sp/>search<sp/>volume.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a9290a3cb7cec20b03d78ccc1b53a06dc" kindref="member">sigma</ref><sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1aa64448926972de66e258f3eae95993d4" kindref="member">inputSigma</ref>.maxCoeff();</highlight></codeline>
<codeline lineno="88"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>termination<sp/>criteria</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>maximal<sp/>number<sp/>of<sp/>evaluations<sp/>allowed.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="90"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a64b1dc96aadfd73ac75ac18f602a4be5" kindref="member">maxEvaluations</ref><sp/>=<sp/>maxEvaluations_;</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>limit<sp/>for<sp/>fitness<sp/>value.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a8257d791e3d09fefa27942e2842a02f5" kindref="member">stopfitness</ref><sp/>=<sp/>stopfitness_;</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>stop<sp/>if<sp/>x-changes<sp/>larger<sp/>stopTolUpX.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1acd6aa48f968c88bbf105a05bc2b66112" kindref="member">stopTolUpX</ref><sp/>=<sp/>1e3<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a9290a3cb7cec20b03d78ccc1b53a06dc" kindref="member">sigma</ref>;</highlight></codeline>
<codeline lineno="95"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>stop<sp/>if<sp/>x-change<sp/>smaller<sp/>stopTolX.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a676d55f32118eeb0bdf0546721f9ae23" kindref="member">stopTolX</ref><sp/>=<sp/>1e-11<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a9290a3cb7cec20b03d78ccc1b53a06dc" kindref="member">sigma</ref><sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1af49bb3ec0e42ef7f4cbfe3934abc026a" kindref="member">accuracy</ref>;</highlight></codeline>
<codeline lineno="97"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>stop<sp/>if<sp/>fun-changes<sp/>smaller<sp/>stopTolFun.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a14dd207015f4c247ca4a80c683a8b0f6" kindref="member">stopTolFun</ref><sp/>=<sp/>1e-12<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1af49bb3ec0e42ef7f4cbfe3934abc026a" kindref="member">accuracy</ref>;</highlight></codeline>
<codeline lineno="99"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>stop<sp/>if<sp/>back<sp/>fun-changes<sp/>smaller<sp/>stopTolHistFun.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a93f72fbef497480928c9e7b04123e930" kindref="member">stopTolHistFun</ref><sp/>=<sp/>stopTolHistFun_<sp/>&lt;<sp/>0<sp/>?<sp/>1e-13<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1af49bb3ec0e42ef7f4cbfe3934abc026a" kindref="member">accuracy</ref><sp/>:<sp/>stopTolHistFun_;</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>selection<sp/>strategy<sp/>parameters</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>number<sp/>of<sp/>parents/points<sp/>for<sp/>recombination.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a9fba5c1ce916fdda28b4e9af75ef693f" kindref="member">mu</ref><sp/>=<sp/>mu_<sp/>&gt;<sp/>0<sp/>?<sp/>mu_<sp/>:<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref><sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>array<sp/>for<sp/>weighted<sp/>recombination.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a535998e869d050bac252c34d8b570b0f" kindref="member">weights</ref><sp/>=<sp/>(log(<ref refid="namespaceacmaes_1aa2100c3aed4c265a18c551b1c748a588" kindref="member">sequence</ref>(1,<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a9fba5c1ce916fdda28b4e9af75ef693f" kindref="member">mu</ref>,<sp/>1).array())<sp/>*<sp/>-1.)<sp/>+<sp/>log(<ref refid="classacmaes_1_1_acmaes_optimizer_1a9fba5c1ce916fdda28b4e9af75ef693f" kindref="member">mu</ref><sp/>+<sp/>0.5);</highlight></codeline>
<codeline lineno="106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sumw<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a535998e869d050bac252c34d8b570b0f" kindref="member">weights</ref>.sum();</highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sumwq<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a535998e869d050bac252c34d8b570b0f" kindref="member">weights</ref>.squaredNorm();</highlight></codeline>
<codeline lineno="108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a535998e869d050bac252c34d8b570b0f" kindref="member">weights</ref><sp/>*=<sp/>1.<sp/>/<sp/>sumw;</highlight></codeline>
<codeline lineno="109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>variance-effectiveness<sp/>of<sp/>sum<sp/>w_i<sp/>x_i.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a12077354f7b80409fe6506c29b4f9d05" kindref="member">mueff</ref><sp/>=<sp/>sumw<sp/>*<sp/>sumw<sp/>/<sp/>sumwq;</highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>dynamic<sp/>strategy<sp/>parameters<sp/>and<sp/>constants</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>cumulation<sp/>constant.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1adda41c9a7372cec6cbe9277c09117829" kindref="member">cc</ref><sp/>=<sp/>(4.<sp/>+<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a12077354f7b80409fe6506c29b4f9d05" kindref="member">mueff</ref><sp/>/<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>)<sp/>/<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref><sp/>+<sp/>4.<sp/>+<sp/>2.<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a12077354f7b80409fe6506c29b4f9d05" kindref="member">mueff</ref><sp/>/<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>);</highlight></codeline>
<codeline lineno="115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>cumulation<sp/>constant<sp/>for<sp/>step-size.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ab72d93c09c86ab626df76157673b5d57" kindref="member">cs</ref><sp/>=<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a12077354f7b80409fe6506c29b4f9d05" kindref="member">mueff</ref><sp/>+<sp/>2.)<sp/>/<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref><sp/>+<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a12077354f7b80409fe6506c29b4f9d05" kindref="member">mueff</ref><sp/>+<sp/>3.);</highlight></codeline>
<codeline lineno="117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>damping<sp/>for<sp/>step-size.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a42ca377b32c9aba2a082b73203c7dddd" kindref="member">damps</ref><sp/>=<sp/>(1.<sp/>+<sp/>2.<sp/>*<sp/>std::max(0.,<sp/>sqrt((<ref refid="classacmaes_1_1_acmaes_optimizer_1a12077354f7b80409fe6506c29b4f9d05" kindref="member">mueff</ref><sp/>-<sp/>1.)<sp/>/<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref><sp/>+<sp/>1.))<sp/>-<sp/>1.))</highlight></codeline>
<codeline lineno="119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>max(0.3,</highlight></codeline>
<codeline lineno="120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.<sp/>-<sp/></highlight><highlight class="comment">//<sp/>modification<sp/>for<sp/>short<sp/>runs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref><sp/>/<sp/>(1e-6<sp/>+<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a64b1dc96aadfd73ac75ac18f602a4be5" kindref="member">maxEvaluations</ref>/<ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref>)))</highlight></codeline>
<codeline lineno="122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ab72d93c09c86ab626df76157673b5d57" kindref="member">cs</ref>;<sp/></highlight><highlight class="comment">//<sp/>minor<sp/>increment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>learning<sp/>rate<sp/>for<sp/>rank-one<sp/>update.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a8a406c0b2eac5e1e7c775e6951858172" kindref="member">ccov1</ref><sp/>=<sp/>2.<sp/>/<sp/>((<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref><sp/>+<sp/>1.3)<sp/>*<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref><sp/>+<sp/>1.3)<sp/>+<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a12077354f7b80409fe6506c29b4f9d05" kindref="member">mueff</ref>);</highlight></codeline>
<codeline lineno="125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>learning<sp/>rate<sp/>for<sp/>rank-mu<sp/>update&apos;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ad5f6392eb25c1d4afeeab490c8d1556f" kindref="member">ccovmu</ref><sp/>=<sp/>min(1.<sp/>-<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a8a406c0b2eac5e1e7c775e6951858172" kindref="member">ccov1</ref>,</highlight></codeline>
<codeline lineno="127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>2.<sp/>*<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a12077354f7b80409fe6506c29b4f9d05" kindref="member">mueff</ref><sp/>-<sp/>2.<sp/>+<sp/>1.<sp/>/<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a12077354f7b80409fe6506c29b4f9d05" kindref="member">mueff</ref>)</highlight></codeline>
<codeline lineno="128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/<sp/>((<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref><sp/>+<sp/>2.)<sp/>*<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref><sp/>+<sp/>2.)<sp/>+<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a12077354f7b80409fe6506c29b4f9d05" kindref="member">mueff</ref>));</highlight></codeline>
<codeline lineno="129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>expectation<sp/>of<sp/>||N(0,I)||<sp/>==<sp/>norm(randn(N,1)).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a6bff526b6be45c84a7196b26f9c10375" kindref="member">chiN</ref><sp/>=<sp/>sqrt(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>)<sp/>*<sp/>(1.<sp/>-<sp/>1.<sp/>/<sp/>(4.<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>)<sp/>+<sp/>1<sp/>/<sp/>(21.<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref><sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>));</highlight></codeline>
<codeline lineno="131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ab663ec0cbe33131f3d5c9b5f30236b8b" kindref="member">ccov1Sep</ref><sp/>=<sp/>min(1.,<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a8a406c0b2eac5e1e7c775e6951858172" kindref="member">ccov1</ref><sp/>*<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref><sp/>+<sp/>1.5)<sp/>/<sp/>3.);</highlight></codeline>
<codeline lineno="132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ac2566f3a92b546f094a7bb8ec5d87de6" kindref="member">ccovmuSep</ref><sp/>=<sp/>min(1.<sp/>-<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a8a406c0b2eac5e1e7c775e6951858172" kindref="member">ccov1</ref>,<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ad5f6392eb25c1d4afeeab490c8d1556f" kindref="member">ccovmu</ref><sp/>*<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref><sp/>+<sp/>1.5)<sp/>/<sp/>3.);</highlight></codeline>
<codeline lineno="133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>lazy<sp/>covariance<sp/>update<sp/>gap</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a56b024cd6dc9dfcc03b282918f905d4d" kindref="member">lazy_update_gap</ref><sp/>=</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>update_gap_<sp/>&gt;=<sp/>0<sp/>?</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>update_gap_<sp/>:</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.0<sp/>/<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a8a406c0b2eac5e1e7c775e6951858172" kindref="member">ccov1</ref><sp/>+<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ad5f6392eb25c1d4afeeab490c8d1556f" kindref="member">ccovmu</ref><sp/>+<sp/>1e-23)<sp/>/<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref><sp/>/<sp/>10.0;</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>CMA<sp/>internal<sp/>values<sp/>-<sp/>updated<sp/>each<sp/>generation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>objective<sp/>variables.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a7824c6afa9a2633c7e24d71db2f52787" kindref="member">xmean</ref><sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>-&gt;encode(<ref refid="classacmaes_1_1_acmaes_optimizer_1a73710e1f7b550eb765980f6d8205acd2" kindref="member">guess</ref>);</highlight></codeline>
<codeline lineno="141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>evolution<sp/>path.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a3b2ec952c9c29e2c8fe353a7eb7b3a6f" kindref="member">pc</ref><sp/>=<sp/><ref refid="evaluator_8h_1a909812174fa9829bc49f6e00edb00b90" kindref="member">zeros</ref>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>);</highlight></codeline>
<codeline lineno="143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>evolution<sp/>path<sp/>for<sp/>sigma.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a941f1cfcd98230d2022fb506e62b96df" kindref="member">ps</ref><sp/>=<sp/><ref refid="evaluator_8h_1a909812174fa9829bc49f6e00edb00b90" kindref="member">zeros</ref>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>);</highlight></codeline>
<codeline lineno="145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>norm<sp/>of<sp/>ps,<sp/>stored<sp/>for<sp/>efficiency.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1adffd8b681b2402481801e0cc34b9d6e2" kindref="member">normps</ref><sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a941f1cfcd98230d2022fb506e62b96df" kindref="member">ps</ref>.norm();</highlight></codeline>
<codeline lineno="147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>coordinate<sp/>system.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a326b26c7190938716b46310b7985fb1f" kindref="member">B</ref><sp/>=<sp/>Eigen::MatrixXd::Identity(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>,<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>);</highlight></codeline>
<codeline lineno="149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>diagonal<sp/>of<sp/>sqrt(D),<sp/>stored<sp/>for<sp/>efficiency.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref><sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1aa64448926972de66e258f3eae95993d4" kindref="member">inputSigma</ref><sp/>/<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a9290a3cb7cec20b03d78ccc1b53a06dc" kindref="member">sigma</ref>;</highlight></codeline>
<codeline lineno="151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1af0d9962901e706966ac55076a9123de0" kindref="member">diagC</ref><sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref>.cwiseProduct(<ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref>);</highlight></codeline>
<codeline lineno="152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>B*D,<sp/>stored<sp/>for<sp/>efficiency.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a28b375f6c8c9333a8d11169a4b4bbf51" kindref="member">BD</ref><sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a326b26c7190938716b46310b7985fb1f" kindref="member">B</ref>.cwiseProduct(<ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref>.transpose().replicate(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>,<sp/>1));</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>covariance<sp/>matrix.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1aff3401adacb15732828daef99c6d7dab" kindref="member">C</ref><sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a326b26c7190938716b46310b7985fb1f" kindref="member">B</ref><sp/>*<sp/>(Eigen::MatrixXd::Identity(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>,<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>)<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a326b26c7190938716b46310b7985fb1f" kindref="member">B</ref>.transpose());</highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>number<sp/>of<sp/>iterations.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a2c9bbb5f803acf531a67986025d0e913" kindref="member">iterations</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>size<sp/>of<sp/>history<sp/>queue<sp/>of<sp/>best<sp/>values.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a51907ba6ceea0937ac45997d424ca5ed" kindref="member">historySize</ref><sp/>=<sp/>10<sp/>+<sp/>int(3.<sp/>*<sp/>10.<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref><sp/>/<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref>);</highlight></codeline>
<codeline lineno="160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>stop<sp/>criteria</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a1529659459b814102415217b9ce822c6" kindref="member">stop</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>best<sp/>value<sp/>so<sp/>far</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a13682ca7e26ba1755a7a7b09d446ac8a" kindref="member">bestValue</ref><sp/>=<sp/>DBL_MAX;</highlight></codeline>
<codeline lineno="164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>best<sp/>parameters<sp/>so<sp/>far</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1acfda423e0a6771582cf79f67f0e66954" kindref="member">bestX</ref><sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a73710e1f7b550eb765980f6d8205acd2" kindref="member">guess</ref>;</highlight></codeline>
<codeline lineno="166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>history<sp/>queue<sp/>of<sp/>best<sp/>values.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a4f8eb45ad2bbe6ee494dc655173f2f86" kindref="member">fitnessHistory</ref><sp/>=<sp/>vec::Constant(<ref refid="classacmaes_1_1_acmaes_optimizer_1a51907ba6ceea0937ac45997d424ca5ed" kindref="member">historySize</ref>,<sp/>DBL_MAX);</highlight></codeline>
<codeline lineno="168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a4f8eb45ad2bbe6ee494dc655173f2f86" kindref="member">fitnessHistory</ref>(0)<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a13682ca7e26ba1755a7a7b09d446ac8a" kindref="member">bestValue</ref>;</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a6484fd82e910d1481f21c2c85a267f56" kindref="member">rs</ref><sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>pcg64(seed);</highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822ff0e80ba2c337ea65b4b361d7b332" kindref="member">computeArz</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ae72ada0035312e1bb1edf6ad35204f71" kindref="member">fitness</ref><sp/>=<sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref>(<ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref>);</highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a54b9d653087f054270a377aeafa63e02" kindref="member">arx</ref><sp/>=<sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>,<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref>);</highlight></codeline>
<codeline lineno="174"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight></codeline>
<codeline lineno="176" refid="classacmaes_1_1_acmaes_optimizer_1ad1c4b82ea7f71d9d61f45fc4978cc734" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ad1c4b82ea7f71d9d61f45fc4978cc734" kindref="member">~AcmaesOptimizer</ref>()<sp/>{</highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a6484fd82e910d1481f21c2c85a267f56" kindref="member">rs</ref>;</highlight></codeline>
<codeline lineno="178"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="179"><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>param<sp/>zmean<sp/>weighted<sp/>row<sp/>matrix<sp/>of<sp/>the<sp/>gaussian<sp/>random<sp/>numbers<sp/>generating<sp/>the<sp/>current<sp/>offspring</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>param<sp/>xold<sp/>xmean<sp/>matrix<sp/>of<sp/>the<sp/>previous<sp/>generation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>return<sp/>hsig<sp/>flag<sp/>indicating<sp/>a<sp/>small<sp/>correction</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"></highlight></codeline>
<codeline lineno="184" refid="classacmaes_1_1_acmaes_optimizer_1ae9f3415b9bcc43366193e7d4b0beda87" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ae9f3415b9bcc43366193e7d4b0beda87" kindref="member">updateEvolutionPaths</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>&amp;zmean,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>&amp;xold)<sp/>{</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a941f1cfcd98230d2022fb506e62b96df" kindref="member">ps</ref><sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a941f1cfcd98230d2022fb506e62b96df" kindref="member">ps</ref><sp/>*<sp/>(1.<sp/>-<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ab72d93c09c86ab626df76157673b5d57" kindref="member">cs</ref>)<sp/>+<sp/>((<ref refid="classacmaes_1_1_acmaes_optimizer_1a326b26c7190938716b46310b7985fb1f" kindref="member">B</ref><sp/>*<sp/>zmean)<sp/>*<sp/>sqrt(<ref refid="classacmaes_1_1_acmaes_optimizer_1ab72d93c09c86ab626df76157673b5d57" kindref="member">cs</ref><sp/>*<sp/>(2.<sp/>-<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ab72d93c09c86ab626df76157673b5d57" kindref="member">cs</ref>)<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a12077354f7b80409fe6506c29b4f9d05" kindref="member">mueff</ref>));</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1adffd8b681b2402481801e0cc34b9d6e2" kindref="member">normps</ref><sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a941f1cfcd98230d2022fb506e62b96df" kindref="member">ps</ref>.norm();</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>hsig<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1adffd8b681b2402481801e0cc34b9d6e2" kindref="member">normps</ref><sp/>/<sp/>sqrt(1.<sp/>-<sp/>pow(1.<sp/>-<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ab72d93c09c86ab626df76157673b5d57" kindref="member">cs</ref>,<sp/>2.<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a2c9bbb5f803acf531a67986025d0e913" kindref="member">iterations</ref>))<sp/>/<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a6bff526b6be45c84a7196b26f9c10375" kindref="member">chiN</ref></highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&lt;<sp/>1.4<sp/>+<sp/>2.<sp/>/<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref><sp/>+<sp/>1.);</highlight></codeline>
<codeline lineno="189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a3b2ec952c9c29e2c8fe353a7eb7b3a6f" kindref="member">pc</ref><sp/>*=<sp/>(1.<sp/>-<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1adda41c9a7372cec6cbe9277c09117829" kindref="member">cc</ref>);</highlight></codeline>
<codeline lineno="190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(hsig)</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a3b2ec952c9c29e2c8fe353a7eb7b3a6f" kindref="member">pc</ref><sp/>+=<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a7824c6afa9a2633c7e24d71db2f52787" kindref="member">xmean</ref><sp/>-<sp/>xold)<sp/>*<sp/>(sqrt(<ref refid="classacmaes_1_1_acmaes_optimizer_1adda41c9a7372cec6cbe9277c09117829" kindref="member">cc</ref><sp/>*<sp/>(2.<sp/>-<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1adda41c9a7372cec6cbe9277c09117829" kindref="member">cc</ref>)<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a12077354f7b80409fe6506c29b4f9d05" kindref="member">mueff</ref>)<sp/>/<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a9290a3cb7cec20b03d78ccc1b53a06dc" kindref="member">sigma</ref>);</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>hsig;</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="194"><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>param<sp/>hsig<sp/>flag<sp/>indicating<sp/>a<sp/>small<sp/>correction</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>param<sp/>bestArx<sp/>fitness-sorted<sp/>matrix<sp/>of<sp/>the<sp/>argument<sp/>vectors<sp/>producing<sp/>the<sp/>current<sp/>offspring</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="197"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>param<sp/>arz<sp/>unsorted<sp/>matrix<sp/>containing<sp/>the<sp/>gaussian<sp/>random<sp/>values<sp/>of<sp/>the<sp/>current<sp/>offspring</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>param<sp/>arindex<sp/>indices<sp/>indicating<sp/>the<sp/>fitness-order<sp/>of<sp/>the<sp/>current<sp/>offspring</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>param<sp/>xold<sp/>xmean<sp/>matrix<sp/>of<sp/>the<sp/>previous<sp/>generation</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="201" refid="classacmaes_1_1_acmaes_optimizer_1a911e67d9e8445b3a8be575f184341b8e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a911e67d9e8445b3a8be575f184341b8e" kindref="member">updateCovariance</ref>(</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>hsig,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>&amp;bestArx,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>&amp;<ref refid="classacmaes_1_1_acmaes_optimizer_1a29fdebcd5e9fe0daa7d3ab4b6b4eaf66" kindref="member">arz</ref>,</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d" kindref="member">ivec</ref><sp/>&amp;arindex,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>&amp;xold)<sp/>{</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>negccov<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a8a406c0b2eac5e1e7c775e6951858172" kindref="member">ccov1</ref><sp/>+<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ad5f6392eb25c1d4afeeab490c8d1556f" kindref="member">ccovmu</ref><sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>arpos<sp/>=<sp/>(bestArx<sp/>-<sp/>xold.replicate(1,<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a9fba5c1ce916fdda28b4e9af75ef693f" kindref="member">mu</ref>))<sp/>*<sp/>(1.<sp/>/<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a9290a3cb7cec20b03d78ccc1b53a06dc" kindref="member">sigma</ref>);<sp/></highlight><highlight class="comment">//<sp/>mu<sp/>difference<sp/>vectors</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>roneu<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a3b2ec952c9c29e2c8fe353a7eb7b3a6f" kindref="member">pc</ref><sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a3b2ec952c9c29e2c8fe353a7eb7b3a6f" kindref="member">pc</ref>.transpose()<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a8a406c0b2eac5e1e7c775e6951858172" kindref="member">ccov1</ref>;</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>minor<sp/>correction<sp/>if<sp/>hsig==false</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>oldFac<sp/>=<sp/>hsig<sp/>?<sp/>0<sp/>:<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a8a406c0b2eac5e1e7c775e6951858172" kindref="member">ccov1</ref><sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1adda41c9a7372cec6cbe9277c09117829" kindref="member">cc</ref><sp/>*<sp/>(2.<sp/>-<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1adda41c9a7372cec6cbe9277c09117829" kindref="member">cc</ref>);</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>oldFac<sp/>+=<sp/>1.<sp/>-<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a8a406c0b2eac5e1e7c775e6951858172" kindref="member">ccov1</ref><sp/>-<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ad5f6392eb25c1d4afeeab490c8d1556f" kindref="member">ccovmu</ref>;</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Adapt<sp/>covariance<sp/>matrix<sp/>C<sp/>active<sp/>CMA</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>negccov<sp/>=<sp/>(1.<sp/>-<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ad5f6392eb25c1d4afeeab490c8d1556f" kindref="member">ccovmu</ref>)<sp/>*<sp/>0.25<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a12077354f7b80409fe6506c29b4f9d05" kindref="member">mueff</ref></highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>/<sp/>(pow(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref><sp/>+<sp/>2.,<sp/>1.5)<sp/>+<sp/>2.<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a12077354f7b80409fe6506c29b4f9d05" kindref="member">mueff</ref>);</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>negminresidualvariance<sp/>=<sp/>0.66;</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>keep<sp/>at<sp/>least<sp/>0.66<sp/>in<sp/>all<sp/>directions,<sp/>small<sp/>popsize<sp/>are<sp/>most<sp/>critical</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>negalphaold<sp/>=<sp/>0.5;<sp/></highlight><highlight class="comment">//<sp/>where<sp/>to<sp/>make<sp/>up<sp/>for<sp/>the<sp/>variance<sp/>loss,</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>prepare<sp/>vectors,<sp/>compute<sp/>negative<sp/>updating<sp/>matrix<sp/>Cneg</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d" kindref="member">ivec</ref><sp/>arReverseIndex<sp/>=<sp/>arindex.reverse();</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>arzneg<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29fdebcd5e9fe0daa7d3ab4b6b4eaf66" kindref="member">arz</ref>(Eigen::indexing::all,<sp/>arReverseIndex.head(<ref refid="classacmaes_1_1_acmaes_optimizer_1a9fba5c1ce916fdda28b4e9af75ef693f" kindref="member">mu</ref>));</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>arnorms<sp/>=<sp/>arzneg.colwise().norm();</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d" kindref="member">ivec</ref><sp/>idxnorms<sp/>=<sp/><ref refid="evaluator_8h_1a7689f88ea48c85c22d9b34208decd67c" kindref="member">sort_index</ref>(arnorms);</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>arnormsSorted<sp/>=<sp/>arnorms(idxnorms);</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d" kindref="member">ivec</ref><sp/>idxReverse<sp/>=<sp/>idxnorms.reverse();</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>arnormsReverse<sp/>=<sp/>arnorms(idxReverse);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>arnorms<sp/>=<sp/>arnormsReverse.cwiseQuotient(arnormsSorted);</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>arnormsInv<sp/>=<sp/>arnorms(<ref refid="namespaceacmaes_1a8f3b844e07e4684f10852956288758de" kindref="member">inverse</ref>(idxnorms));</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>sqarnw<sp/>=<sp/>arnormsInv.cwiseProduct(arnormsInv).transpose()</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a535998e869d050bac252c34d8b570b0f" kindref="member">weights</ref>;</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>negcovMax<sp/>=<sp/>(1.<sp/>-<sp/>negminresidualvariance)<sp/>/<sp/>sqarnw(0);</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(negccov<sp/>&gt;<sp/>negcovMax)</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>negccov<sp/>=<sp/>negcovMax;</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>arzneg<sp/>=<sp/>arzneg.cwiseProduct(</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>arnormsInv.transpose().replicate(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>,<sp/>1));</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>artmp<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a28b375f6c8c9333a8d11169a4b4bbf51" kindref="member">BD</ref><sp/>*<sp/>arzneg;</highlight></codeline>
<codeline lineno="234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>Cneg<sp/>=<sp/>artmp<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a535998e869d050bac252c34d8b570b0f" kindref="member">weights</ref>.asDiagonal()<sp/>*<sp/>artmp.transpose();</highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>oldFac<sp/>+=<sp/>negalphaold<sp/>*<sp/>negccov;</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1aff3401adacb15732828daef99c6d7dab" kindref="member">C</ref><sp/>=<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1aff3401adacb15732828daef99c6d7dab" kindref="member">C</ref><sp/>*<sp/>oldFac)<sp/>+<sp/>roneu</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>+<sp/>(arpos<sp/>*<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1ad5f6392eb25c1d4afeeab490c8d1556f" kindref="member">ccovmu</ref><sp/>+<sp/>(1.<sp/>-<sp/>negalphaold)<sp/>*<sp/>negccov)</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a535998e869d050bac252c34d8b570b0f" kindref="member">weights</ref>.replicate(1,<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>).cwiseProduct(</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>arpos.transpose()))<sp/>-<sp/>(Cneg<sp/>*<sp/>negccov);</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>negccov;</highlight></codeline>
<codeline lineno="242"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="243"><highlight class="normal"></highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Update<sp/>B<sp/>and<sp/>diagD<sp/>from<sp/>C</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>param<sp/>negccov<sp/>Negative<sp/>covariance<sp/>factor.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="246"><highlight class="normal"></highlight></codeline>
<codeline lineno="247" refid="classacmaes_1_1_acmaes_optimizer_1a6e1292651cf19abf87f9ece1aa9c92d7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a6e1292651cf19abf87f9ece1aa9c92d7" kindref="member">updateBD</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>negccov)<sp/>{</highlight></codeline>
<codeline lineno="248"><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a8a406c0b2eac5e1e7c775e6951858172" kindref="member">ccov1</ref><sp/>+<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ad5f6392eb25c1d4afeeab490c8d1556f" kindref="member">ccovmu</ref><sp/>+<sp/>negccov<sp/>&gt;<sp/>0</highlight></codeline>
<codeline lineno="250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>(std::fmod(<ref refid="classacmaes_1_1_acmaes_optimizer_1a2c9bbb5f803acf531a67986025d0e913" kindref="member">iterations</ref>,</highlight></codeline>
<codeline lineno="251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1.<sp/>/<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a8a406c0b2eac5e1e7c775e6951858172" kindref="member">ccov1</ref><sp/>+<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ad5f6392eb25c1d4afeeab490c8d1556f" kindref="member">ccovmu</ref><sp/>+<sp/>negccov)<sp/>/<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref><sp/>/<sp/>10.))<sp/>&lt;<sp/>1.)<sp/>{</highlight></codeline>
<codeline lineno="252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>to<sp/>achieve<sp/>O(N^2)<sp/>enforce<sp/>symmetry<sp/>to<sp/>prevent<sp/>complex<sp/>numbers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>triC<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1aff3401adacb15732828daef99c6d7dab" kindref="member">C</ref>.triangularView&lt;Eigen::Upper&gt;();</highlight></codeline>
<codeline lineno="254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>triC1<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1aff3401adacb15732828daef99c6d7dab" kindref="member">C</ref>.triangularView&lt;Eigen::StrictlyUpper&gt;();</highlight></codeline>
<codeline lineno="255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1aff3401adacb15732828daef99c6d7dab" kindref="member">C</ref><sp/>=<sp/>triC<sp/>+<sp/>triC1.transpose();</highlight></codeline>
<codeline lineno="256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Eigen::SelfAdjointEigenSolver&lt;mat&gt;<sp/>sades;</highlight></codeline>
<codeline lineno="257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sades.compute(<ref refid="classacmaes_1_1_acmaes_optimizer_1aff3401adacb15732828daef99c6d7dab" kindref="member">C</ref>);</highlight></codeline>
<codeline lineno="258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>diagD<sp/>defines<sp/>the<sp/>scaling</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref><sp/>=<sp/>sades.eigenvalues();</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a326b26c7190938716b46310b7985fb1f" kindref="member">B</ref><sp/>=<sp/>sades.eigenvectors();</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref>.minCoeff()<sp/>&lt;=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>;<sp/>i++)</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref>(i,<sp/>0)<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref>(i,<sp/>0)<sp/>=<sp/>0.;</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tfac<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref>.maxCoeff()<sp/>/<sp/>1e14;</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1aff3401adacb15732828daef99c6d7dab" kindref="member">C</ref><sp/>+=<sp/>Eigen::MatrixXd::Identity(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>,<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>)<sp/>*<sp/>tfac;</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref><sp/>+=<sp/>vec::Constant(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>,<sp/>1.0)<sp/>*<sp/>tfac;</highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref>.maxCoeff()<sp/>&gt;<sp/>1e14<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref>.minCoeff())<sp/>{</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>tfac<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref>.maxCoeff()<sp/>/<sp/>1e14<sp/>-<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref>.minCoeff();</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1aff3401adacb15732828daef99c6d7dab" kindref="member">C</ref><sp/>+=<sp/>Eigen::MatrixXd::Identity(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>,<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>)<sp/>*<sp/>tfac;</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref><sp/>+=<sp/>vec::Constant(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>,<sp/>1.0)<sp/>*<sp/>tfac;</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1af0d9962901e706966ac55076a9123de0" kindref="member">diagC</ref><sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1aff3401adacb15732828daef99c6d7dab" kindref="member">C</ref>.diagonal();</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref><sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref>.cwiseSqrt();<sp/></highlight><highlight class="comment">//<sp/>D<sp/>contains<sp/>standard<sp/>deviations<sp/>now</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a28b375f6c8c9333a8d11169a4b4bbf51" kindref="member">BD</ref><sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a326b26c7190938716b46310b7985fb1f" kindref="member">B</ref>.cwiseProduct(<ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref>.transpose().replicate(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>,<sp/>1));</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="279"><highlight class="normal"></highlight></codeline>
<codeline lineno="280" refid="classacmaes_1_1_acmaes_optimizer_1ae6ef63f98f9b5b9034438301df2ca323" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ae6ef63f98f9b5b9034438301df2ca323" kindref="member">ask_all</ref>()<sp/>{<sp/></highlight><highlight class="comment">//<sp/>undecoded</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>generate<sp/>popsize<sp/>offspring.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29fdebcd5e9fe0daa7d3ab4b6b4eaf66" kindref="member">arz</ref><sp/>=<sp/><ref refid="evaluator_8h_1a231544ac51b3f9312c104a3b7a3c49a6" kindref="member">normal</ref>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>,<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref>,<sp/>*<ref refid="classacmaes_1_1_acmaes_optimizer_1a6484fd82e910d1481f21c2c85a267f56" kindref="member">rs</ref>);</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>xs(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>,<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref>);</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>k<sp/>=<sp/>0;<sp/>k<sp/>&lt;<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref>;<sp/>k++)<sp/>{</highlight></codeline>
<codeline lineno="285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>delta<sp/>=<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a28b375f6c8c9333a8d11169a4b4bbf51" kindref="member">BD</ref><sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29fdebcd5e9fe0daa7d3ab4b6b4eaf66" kindref="member">arz</ref>.col(k))<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a9290a3cb7cec20b03d78ccc1b53a06dc" kindref="member">sigma</ref>;</highlight></codeline>
<codeline lineno="286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xs.col(k)<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>-&gt;getClosestFeasibleNormed(<ref refid="classacmaes_1_1_acmaes_optimizer_1a7824c6afa9a2633c7e24d71db2f52787" kindref="member">xmean</ref><sp/>+<sp/>delta);</highlight></codeline>
<codeline lineno="287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822ff0e80ba2c337ea65b4b361d7b332" kindref="member">computeArz</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>xs;</highlight></codeline>
<codeline lineno="290"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="291"><highlight class="normal"></highlight></codeline>
<codeline lineno="292" refid="classacmaes_1_1_acmaes_optimizer_1ad73e4ffab0c5d511107d58491540de24" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ad73e4ffab0c5d511107d58491540de24" kindref="member">tell_all</ref>(<ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>ys,<sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>xs)<sp/>{</highlight></codeline>
<codeline lineno="293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1afeb20b9c89d465d55e43c1da48beba53" kindref="member">told</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>p<sp/>=<sp/>0;<sp/>p<sp/>&lt;<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref>;<sp/>p++)</highlight></codeline>
<codeline lineno="295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ac1703b5f2c650cf8da235ea475e17d6f" kindref="member">tell</ref>(ys(p),<sp/>xs.col(p));</highlight></codeline>
<codeline lineno="296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822ff0e80ba2c337ea65b4b361d7b332" kindref="member">computeArz</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a1529659459b814102415217b9ce822c6" kindref="member">stop</ref>;</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="299"><highlight class="normal"></highlight></codeline>
<codeline lineno="300" refid="classacmaes_1_1_acmaes_optimizer_1aaabb9e299b54d36fc3244bfc05184e27" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1aaabb9e299b54d36fc3244bfc05184e27" kindref="member">tell_all_asked</ref>(<ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>ys,<sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>xs)<sp/>{</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1afeb20b9c89d465d55e43c1da48beba53" kindref="member">told</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>p<sp/>=<sp/>0;<sp/>p<sp/>&lt;<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref>;<sp/>p++)</highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ac1703b5f2c650cf8da235ea475e17d6f" kindref="member">tell</ref>(ys(p),<sp/>xs.col(p));</highlight></codeline>
<codeline lineno="304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822ff0e80ba2c337ea65b4b361d7b332" kindref="member">computeArz</ref><sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a1529659459b814102415217b9ce822c6" kindref="member">stop</ref>;</highlight></codeline>
<codeline lineno="306"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight></codeline>
<codeline lineno="308" refid="classacmaes_1_1_acmaes_optimizer_1a7e8a9548f7c49fb789b98f6570d5ea7b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a7e8a9548f7c49fb789b98f6570d5ea7b" kindref="member">getPopulation</ref>()<sp/>{</highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>pop(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>,<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref>);</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>p<sp/>=<sp/>0;<sp/>p<sp/>&lt;<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref>;<sp/>p++)</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pop.col(p)<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>-&gt;decode(<ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>-&gt;getClosestFeasibleNormed(<ref refid="classacmaes_1_1_acmaes_optimizer_1a6d351621f77f58b69bdaedbd3f12c5e7" kindref="member">popX</ref>.col(p)));</highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pop;</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="314"><highlight class="normal"></highlight></codeline>
<codeline lineno="315" refid="classacmaes_1_1_acmaes_optimizer_1a76117dfd997b8f098304f5d4f0fbf52e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a76117dfd997b8f098304f5d4f0fbf52e" kindref="member">ask</ref>()<sp/>{</highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>ask<sp/>for<sp/>one<sp/>new<sp/>argument<sp/>vector.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>arz1<sp/>=<sp/><ref refid="evaluator_8h_1a5b652df2286e1f0c4dae7d4dd841bb8f" kindref="member">normalVec</ref>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>,<sp/>*<ref refid="classacmaes_1_1_acmaes_optimizer_1a6484fd82e910d1481f21c2c85a267f56" kindref="member">rs</ref>);</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>delta<sp/>=<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a28b375f6c8c9333a8d11169a4b4bbf51" kindref="member">BD</ref><sp/>*<sp/>arz1)<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a9290a3cb7cec20b03d78ccc1b53a06dc" kindref="member">sigma</ref>;</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>arx1<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>-&gt;getClosestFeasibleNormed(<ref refid="classacmaes_1_1_acmaes_optimizer_1a7824c6afa9a2633c7e24d71db2f52787" kindref="member">xmean</ref><sp/>+<sp/>delta);</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822ff0e80ba2c337ea65b4b361d7b332" kindref="member">computeArz</ref><sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>arx1;</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight></codeline>
<codeline lineno="324" refid="classacmaes_1_1_acmaes_optimizer_1ac1703b5f2c650cf8da235ea475e17d6f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ac1703b5f2c650cf8da235ea475e17d6f" kindref="member">tell</ref>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>y,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>&amp;x)<sp/>{</highlight></codeline>
<codeline lineno="325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//tell<sp/>function<sp/>value<sp/>for<sp/>a<sp/>argument<sp/>list<sp/>retrieved<sp/>by<sp/>ask_one().</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ae72ada0035312e1bb1edf6ad35204f71" kindref="member">fitness</ref>[<ref refid="classacmaes_1_1_acmaes_optimizer_1afeb20b9c89d465d55e43c1da48beba53" kindref="member">told</ref>]<sp/>=<sp/>isfinite(y)<sp/>?<sp/>y<sp/>:<sp/>DBL_MAX;</highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a54b9d653087f054270a377aeafa63e02" kindref="member">arx</ref>.col(<ref refid="classacmaes_1_1_acmaes_optimizer_1afeb20b9c89d465d55e43c1da48beba53" kindref="member">told</ref>)<sp/>=<sp/>x;</highlight></codeline>
<codeline lineno="328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1afeb20b9c89d465d55e43c1da48beba53" kindref="member">told</ref>++;</highlight></codeline>
<codeline lineno="329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1afeb20b9c89d465d55e43c1da48beba53" kindref="member">told</ref><sp/>&gt;=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref>)<sp/>{</highlight></codeline>
<codeline lineno="330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a7824c6afa9a2633c7e24d71db2f52787" kindref="member">xmean</ref><sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>-&gt;getClosestFeasibleNormed(<ref refid="classacmaes_1_1_acmaes_optimizer_1a7824c6afa9a2633c7e24d71db2f52787" kindref="member">xmean</ref>);</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a822ff0e80ba2c337ea65b4b361d7b332" kindref="member">computeArz</ref>)<sp/>{</highlight></codeline>
<codeline lineno="332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29fdebcd5e9fe0daa7d3ab4b6b4eaf66" kindref="member">arz</ref><sp/>=<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a28b375f6c8c9333a8d11169a4b4bbf51" kindref="member">BD</ref>.inverse()</highlight></codeline>
<codeline lineno="334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>((<ref refid="classacmaes_1_1_acmaes_optimizer_1a54b9d653087f054270a377aeafa63e02" kindref="member">arx</ref><sp/>-<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a7824c6afa9a2633c7e24d71db2f52787" kindref="member">xmean</ref>.replicate(1,<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref>))<sp/>/<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a9290a3cb7cec20b03d78ccc1b53a06dc" kindref="member">sigma</ref>));</highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(std::exception<sp/>&amp;e)<sp/>{</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29fdebcd5e9fe0daa7d3ab4b6b4eaf66" kindref="member">arz</ref><sp/>=<sp/><ref refid="evaluator_8h_1a231544ac51b3f9312c104a3b7a3c49a6" kindref="member">normal</ref>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>,<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref>,<sp/>*<ref refid="classacmaes_1_1_acmaes_optimizer_1a6484fd82e910d1481f21c2c85a267f56" kindref="member">rs</ref>);</highlight></codeline>
<codeline lineno="337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a36c0bd51d20f3c63e8cadf76421fc5d4" kindref="member">updateCMA</ref>();</highlight></codeline>
<codeline lineno="340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1afeb20b9c89d465d55e43c1da48beba53" kindref="member">told</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a2c9bbb5f803acf531a67986025d0e913" kindref="member">iterations</ref><sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a1529659459b814102415217b9ce822c6" kindref="member">stop</ref>;</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="345"><highlight class="normal"></highlight></codeline>
<codeline lineno="346" refid="classacmaes_1_1_acmaes_optimizer_1a36c0bd51d20f3c63e8cadf76421fc5d4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a36c0bd51d20f3c63e8cadf76421fc5d4" kindref="member">updateCMA</ref>()<sp/>{</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>sort<sp/>by<sp/>fitness<sp/>and<sp/>compute<sp/>weighted<sp/>mean<sp/>into<sp/>xmean</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d" kindref="member">ivec</ref><sp/>arindex<sp/>=<sp/><ref refid="evaluator_8h_1a7689f88ea48c85c22d9b34208decd67c" kindref="member">sort_index</ref>(<ref refid="classacmaes_1_1_acmaes_optimizer_1ae72ada0035312e1bb1edf6ad35204f71" kindref="member">fitness</ref>);</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>calculate<sp/>new<sp/>xmean,<sp/>this<sp/>is<sp/>selection<sp/>and<sp/>recombination</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>xold<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a7824c6afa9a2633c7e24d71db2f52787" kindref="member">xmean</ref>;<sp/></highlight><highlight class="comment">//<sp/>for<sp/>speed<sp/>up<sp/>of<sp/>Eq.<sp/>(2)<sp/>and<sp/>(3)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aa45a218a6a9d424e78898121d21f082d" kindref="member">ivec</ref><sp/>bestIndex<sp/>=<sp/>arindex.head(<ref refid="classacmaes_1_1_acmaes_optimizer_1a9fba5c1ce916fdda28b4e9af75ef693f" kindref="member">mu</ref>);</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>bestArx<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a54b9d653087f054270a377aeafa63e02" kindref="member">arx</ref>(Eigen::indexing::all,<sp/>bestIndex);</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a7824c6afa9a2633c7e24d71db2f52787" kindref="member">xmean</ref><sp/>=<sp/>bestArx<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a535998e869d050bac252c34d8b570b0f" kindref="member">weights</ref>;</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>bestArz<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29fdebcd5e9fe0daa7d3ab4b6b4eaf66" kindref="member">arz</ref>(Eigen::indexing::all,<sp/>bestIndex);</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>zmean<sp/>=<sp/>bestArz<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a535998e869d050bac252c34d8b570b0f" kindref="member">weights</ref>;</highlight></codeline>
<codeline lineno="356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>hsig<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ae9f3415b9bcc43366193e7d4b0beda87" kindref="member">updateEvolutionPaths</ref>(zmean,<sp/>xold);</highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>adapt<sp/>step<sp/>size<sp/>sigma</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a9290a3cb7cec20b03d78ccc1b53a06dc" kindref="member">sigma</ref><sp/>*=<sp/>exp(min(1.0,<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1adffd8b681b2402481801e0cc34b9d6e2" kindref="member">normps</ref><sp/>/<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a6bff526b6be45c84a7196b26f9c10375" kindref="member">chiN</ref><sp/>-<sp/>1.)<sp/>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ab72d93c09c86ab626df76157673b5d57" kindref="member">cs</ref><sp/>/<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a42ca377b32c9aba2a082b73203c7dddd" kindref="member">damps</ref>));</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>bestFitness<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ae72ada0035312e1bb1edf6ad35204f71" kindref="member">fitness</ref>(arindex(0));</highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>worstFitness<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ae72ada0035312e1bb1edf6ad35204f71" kindref="member">fitness</ref>(arindex(arindex.size()<sp/>-<sp/>1));</highlight></codeline>
<codeline lineno="361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a13682ca7e26ba1755a7a7b09d446ac8a" kindref="member">bestValue</ref><sp/>&gt;<sp/>bestFitness)<sp/>{</highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a13682ca7e26ba1755a7a7b09d446ac8a" kindref="member">bestValue</ref><sp/>=<sp/>bestFitness;</highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1acfda423e0a6771582cf79f67f0e66954" kindref="member">bestX</ref><sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>-&gt;decode(bestArx.col(0));</highlight></codeline>
<codeline lineno="364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(isfinite(<ref refid="classacmaes_1_1_acmaes_optimizer_1a8257d791e3d09fefa27942e2842a02f5" kindref="member">stopfitness</ref>)<sp/>&amp;&amp;<sp/>bestFitness<sp/>&lt;<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a8257d791e3d09fefa27942e2842a02f5" kindref="member">stopfitness</ref>)<sp/>{</highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a1529659459b814102415217b9ce822c6" kindref="member">stop</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a2c9bbb5f803acf531a67986025d0e913" kindref="member">iterations</ref><sp/>&gt;=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ad2efb063f4c0954c1870313b98667bd0" kindref="member">last_update</ref><sp/>+<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a56b024cd6dc9dfcc03b282918f905d4d" kindref="member">lazy_update_gap</ref>)<sp/>{</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ad2efb063f4c0954c1870313b98667bd0" kindref="member">last_update</ref><sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a2c9bbb5f803acf531a67986025d0e913" kindref="member">iterations</ref>;</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>negccov<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a911e67d9e8445b3a8be575f184341b8e" kindref="member">updateCovariance</ref>(hsig,<sp/>bestArx,<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29fdebcd5e9fe0daa7d3ab4b6b4eaf66" kindref="member">arz</ref>,<sp/>arindex,</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xold);</highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a6e1292651cf19abf87f9ece1aa9c92d7" kindref="member">updateBD</ref>(negccov);</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>handle<sp/>termination<sp/>criteria</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>sqrtDiagC<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1af0d9962901e706966ac55076a9123de0" kindref="member">diagC</ref>.cwiseSqrt();</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>pcCol<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a3b2ec952c9c29e2c8fe353a7eb7b3a6f" kindref="member">pc</ref>;</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a9290a3cb7cec20b03d78ccc1b53a06dc" kindref="member">sigma</ref><sp/>*<sp/>(max(abs(pcCol[i]),<sp/>sqrtDiagC[i]))<sp/>&gt;<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a676d55f32118eeb0bdf0546721f9ae23" kindref="member">stopTolX</ref>)</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&gt;=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref><sp/>-<sp/>1)</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a1529659459b814102415217b9ce822c6" kindref="member">stop</ref><sp/>=<sp/>2;</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a1529659459b814102415217b9ce822c6" kindref="member">stop</ref><sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>;<sp/>i++)</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a9290a3cb7cec20b03d78ccc1b53a06dc" kindref="member">sigma</ref><sp/>*<sp/>sqrtDiagC[i]<sp/>&gt;<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1acd6aa48f968c88bbf105a05bc2b66112" kindref="member">stopTolUpX</ref>)</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a1529659459b814102415217b9ce822c6" kindref="member">stop</ref><sp/>=<sp/>3;</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a1529659459b814102415217b9ce822c6" kindref="member">stop</ref><sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>historyBest<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a4f8eb45ad2bbe6ee494dc655173f2f86" kindref="member">fitnessHistory</ref>.minCoeff();</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>historyWorst<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a4f8eb45ad2bbe6ee494dc655173f2f86" kindref="member">fitnessHistory</ref>.maxCoeff();</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a2c9bbb5f803acf531a67986025d0e913" kindref="member">iterations</ref><sp/>&gt;<sp/>2</highlight></codeline>
<codeline lineno="394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>max(historyWorst,<sp/>worstFitness)</highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>min(historyBest,<sp/>bestFitness)<sp/>&lt;<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a14dd207015f4c247ca4a80c683a8b0f6" kindref="member">stopTolFun</ref>)<sp/>{</highlight></codeline>
<codeline lineno="396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a1529659459b814102415217b9ce822c6" kindref="member">stop</ref><sp/>=<sp/>4;</highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a2c9bbb5f803acf531a67986025d0e913" kindref="member">iterations</ref><sp/>&gt;<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a4f8eb45ad2bbe6ee494dc655173f2f86" kindref="member">fitnessHistory</ref>.size()</highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>historyWorst<sp/>-<sp/>historyBest<sp/>&lt;<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a93f72fbef497480928c9e7b04123e930" kindref="member">stopTolHistFun</ref>)<sp/>{</highlight></codeline>
<codeline lineno="401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a1529659459b814102415217b9ce822c6" kindref="member">stop</ref><sp/>=<sp/>5;</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>condition<sp/>number<sp/>of<sp/>the<sp/>covariance<sp/>matrix<sp/>exceeds<sp/>1e14</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref>.maxCoeff()<sp/>/<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref>.minCoeff()<sp/>&gt;<sp/>1e7<sp/>*<sp/>1.0<sp/>/<sp/>sqrt(<ref refid="classacmaes_1_1_acmaes_optimizer_1af49bb3ec0e42ef7f4cbfe3934abc026a" kindref="member">accuracy</ref>))<sp/>{</highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a1529659459b814102415217b9ce822c6" kindref="member">stop</ref><sp/>=<sp/>6;</highlight></codeline>
<codeline lineno="407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>adjust<sp/>step<sp/>size<sp/>in<sp/>case<sp/>of<sp/>equal<sp/>function<sp/>values<sp/>(flat<sp/>fitness)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a13682ca7e26ba1755a7a7b09d446ac8a" kindref="member">bestValue</ref><sp/>==<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ae72ada0035312e1bb1edf6ad35204f71" kindref="member">fitness</ref>[arindex[(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)<sp/>(0.1<sp/>+<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref><sp/>/<sp/>4.)]])<sp/>{</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a9290a3cb7cec20b03d78ccc1b53a06dc" kindref="member">sigma</ref><sp/>*=<sp/>exp(0.2<sp/>+<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ab72d93c09c86ab626df76157673b5d57" kindref="member">cs</ref><sp/>/<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a42ca377b32c9aba2a082b73203c7dddd" kindref="member">damps</ref>);</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a2c9bbb5f803acf531a67986025d0e913" kindref="member">iterations</ref><sp/>&gt;<sp/>2</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>max(historyWorst,<sp/>bestFitness)</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>std::min(historyBest,<sp/>bestFitness)<sp/>==<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a9290a3cb7cec20b03d78ccc1b53a06dc" kindref="member">sigma</ref><sp/>*=<sp/>::exp(0.2<sp/>+<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ab72d93c09c86ab626df76157673b5d57" kindref="member">cs</ref><sp/>/<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a42ca377b32c9aba2a082b73203c7dddd" kindref="member">damps</ref>);</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>store<sp/>best<sp/>in<sp/>history</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>1;<sp/>i<sp/>&lt;<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a4f8eb45ad2bbe6ee494dc655173f2f86" kindref="member">fitnessHistory</ref>.size();<sp/>i++)</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a4f8eb45ad2bbe6ee494dc655173f2f86" kindref="member">fitnessHistory</ref>[i]<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a4f8eb45ad2bbe6ee494dc655173f2f86" kindref="member">fitnessHistory</ref>[i<sp/>-<sp/>1];</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a4f8eb45ad2bbe6ee494dc655173f2f86" kindref="member">fitnessHistory</ref>[0]<sp/>=<sp/>bestFitness;</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="423"><highlight class="normal"></highlight></codeline>
<codeline lineno="424" refid="classacmaes_1_1_acmaes_optimizer_1a6ffd7f760692210629187fea1b98007c" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a6ffd7f760692210629187fea1b98007c" kindref="member">doOptimize</ref>()<sp/>{</highlight></codeline>
<codeline lineno="425"><highlight class="normal"></highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>--------------------<sp/>Generation<sp/>Loop<sp/>--------------------------------</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a2c9bbb5f803acf531a67986025d0e913" kindref="member">iterations</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>-&gt;resetEvaluations();</highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>-&gt;evaluations()<sp/>&lt;<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a64b1dc96aadfd73ac75ac18f602a4be5" kindref="member">maxEvaluations</ref><sp/>&amp;&amp;<sp/>!<ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>-&gt;terminate())<sp/>{</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>generate<sp/>and<sp/>evaluate<sp/>popsize<sp/>offspring</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>xs<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ae6ef63f98f9b5b9034438301df2ca323" kindref="member">ask_all</ref>();</highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>ys(<ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref>);</highlight></codeline>
<codeline lineno="433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>-&gt;values(xs,<sp/>ys);<sp/></highlight><highlight class="comment">//<sp/>decodes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1afeb20b9c89d465d55e43c1da48beba53" kindref="member">told</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>k<sp/>=<sp/>0;<sp/>k<sp/>&lt;<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref><sp/>&amp;&amp;<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a1529659459b814102415217b9ce822c6" kindref="member">stop</ref><sp/>==<sp/>0;<sp/>k++)</highlight></codeline>
<codeline lineno="436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ac1703b5f2c650cf8da235ea475e17d6f" kindref="member">tell</ref>(ys(k),<sp/>xs.col(k));<sp/></highlight><highlight class="comment">//<sp/>tell<sp/>encoded</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a1529659459b814102415217b9ce822c6" kindref="member">stop</ref><sp/>!=<sp/>0)</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>-&gt;evaluations();</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>-&gt;evaluations();</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="442"><highlight class="normal"></highlight></codeline>
<codeline lineno="443" refid="classacmaes_1_1_acmaes_optimizer_1ab3af1e3acb2561d4b0be23b402b232a9" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ab3af1e3acb2561d4b0be23b402b232a9" kindref="member">do_optimize_delayed_update</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>workers)<sp/>{</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a2c9bbb5f803acf531a67986025d0e913" kindref="member">iterations</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>-&gt;resetEvaluations();</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classevaluator" kindref="compound">evaluator</ref><sp/>eval(<ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>,<sp/>1,<sp/>workers);</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>evals_x[workers];</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>fill<sp/>eval<sp/>queue<sp/>with<sp/>initial<sp/>population</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>workers;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>x<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a76117dfd997b8f098304f5d4f0fbf52e" kindref="member">ask</ref>();</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>xdec<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>-&gt;decode(x);</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eval.<ref refid="classevaluator_1a62e9fb557b5a2ecfabc49a01eb7f59d5" kindref="member">evaluate</ref>(xdec,<sp/>i);</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>evals_x[i]<sp/>=<sp/>x;<sp/></highlight><highlight class="comment">//<sp/>encoded</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>-&gt;evaluations()<sp/>&lt;<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a64b1dc96aadfd73ac75ac18f602a4be5" kindref="member">maxEvaluations</ref>)<sp/>{</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="structvec__id" kindref="compound">vec_id</ref>*<sp/>vid<sp/>=<sp/>eval.<ref refid="classevaluator_1a71fc6fd970c9d9f19af8202500c51b05" kindref="member">result</ref>();</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>y<sp/>=<sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref>(vid-&gt;<ref refid="structvec__id_1af5bf436ff9f915e145a897a73e4cdac9" kindref="member">_v</ref>);</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>p<sp/>=<sp/>vid-&gt;<ref refid="structvec__id_1a126c3cb731d047e25c08742f735f0f13" kindref="member">_id</ref>;</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>vid;</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>x<sp/>=<sp/>evals_x[p];</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ac1703b5f2c650cf8da235ea475e17d6f" kindref="member">tell</ref>(y(0),<sp/>x);<sp/></highlight><highlight class="comment">//<sp/>tell<sp/>evaluated<sp/>encoded<sp/>x</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>-&gt;evaluations()<sp/>&gt;=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a64b1dc96aadfd73ac75ac18f602a4be5" kindref="member">maxEvaluations</ref><sp/>||<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a1529659459b814102415217b9ce822c6" kindref="member">stop</ref><sp/>!=<sp/>0)</highlight></codeline>
<codeline lineno="463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x<sp/>=<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a76117dfd997b8f098304f5d4f0fbf52e" kindref="member">ask</ref>();</highlight></codeline>
<codeline lineno="465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>eval.<ref refid="classevaluator_1a62e9fb557b5a2ecfabc49a01eb7f59d5" kindref="member">evaluate</ref>(x,<sp/>p);</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>evals_x[p]<sp/>=<sp/>x;</highlight></codeline>
<codeline lineno="467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>-&gt;evaluations();</highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="470"><highlight class="normal"></highlight></codeline>
<codeline lineno="471" refid="classacmaes_1_1_acmaes_optimizer_1ae23d2ccb359090f4e5c2c162b7d6a4bf" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ae23d2ccb359090f4e5c2c162b7d6a4bf" kindref="member">getBestX</ref>()<sp/>{</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1acfda423e0a6771582cf79f67f0e66954" kindref="member">bestX</ref>;</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="474"><highlight class="normal"></highlight></codeline>
<codeline lineno="475" refid="classacmaes_1_1_acmaes_optimizer_1a0d762f718e82fecd480762662f480e1a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a0d762f718e82fecd480762662f480e1a" kindref="member">getBestValue</ref>()<sp/>{</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a13682ca7e26ba1755a7a7b09d446ac8a" kindref="member">bestValue</ref>;</highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="478"><highlight class="normal"></highlight></codeline>
<codeline lineno="479" refid="classacmaes_1_1_acmaes_optimizer_1a60785f3698538af538a606d1eea6c908" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a60785f3698538af538a606d1eea6c908" kindref="member">getIterations</ref>()<sp/>{</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a2c9bbb5f803acf531a67986025d0e913" kindref="member">iterations</ref>;</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="482"><highlight class="normal"></highlight></codeline>
<codeline lineno="483" refid="classacmaes_1_1_acmaes_optimizer_1a1b182abe1e3428733780dc6fe0b669e0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a1b182abe1e3428733780dc6fe0b669e0" kindref="member">getStop</ref>()<sp/>{</highlight></codeline>
<codeline lineno="484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a1529659459b814102415217b9ce822c6" kindref="member">stop</ref>;</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="486"><highlight class="normal"></highlight></codeline>
<codeline lineno="487" refid="classacmaes_1_1_acmaes_optimizer_1a8f2c15cc704f0ce15f6cc875522e2d5e" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_fitness" kindref="compound">Fitness</ref>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a8f2c15cc704f0ce15f6cc875522e2d5e" kindref="member">getFitfun</ref>()<sp/>{</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>;</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="490"><highlight class="normal"></highlight></codeline>
<codeline lineno="491" refid="classacmaes_1_1_acmaes_optimizer_1ae9ccb84da924f3a0df38032ac09298a8" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ae9ccb84da924f3a0df38032ac09298a8" kindref="member">getDim</ref>()<sp/>{</highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>;</highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="494"><highlight class="normal"></highlight></codeline>
<codeline lineno="495" refid="classacmaes_1_1_acmaes_optimizer_1a224ece6966b6635c9912673e06457697" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a224ece6966b6635c9912673e06457697" kindref="member">getPopsize</ref>()<sp/>{</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref>;</highlight></codeline>
<codeline lineno="497"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="498"><highlight class="normal"></highlight></codeline>
<codeline lineno="499" refid="classacmaes_1_1_acmaes_optimizer_1aba0ace56e07ab7c89e6f380a168f88a1" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_fitness" kindref="compound">Fitness</ref>*<sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1aba0ace56e07ab7c89e6f380a168f88a1" kindref="member">getFitfunPar</ref>()<sp/>{</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>;</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="502"><highlight class="normal"></highlight></codeline>
<codeline lineno="503" refid="classacmaes_1_1_acmaes_optimizer_1a6d351621f77f58b69bdaedbd3f12c5e7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a6d351621f77f58b69bdaedbd3f12c5e7" kindref="member">popX</ref>;</highlight></codeline>
<codeline lineno="504"><highlight class="normal"></highlight></codeline>
<codeline lineno="505"><highlight class="normal"></highlight><highlight class="keyword">private</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="506" refid="classacmaes_1_1_acmaes_optimizer_1a755e250be4d7f61b3d813a4f13a25282" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a755e250be4d7f61b3d813a4f13a25282" kindref="member">runid</ref>;</highlight></codeline>
<codeline lineno="507" refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_fitness" kindref="compound">Fitness</ref><sp/>*<ref refid="classacmaes_1_1_acmaes_optimizer_1a94047d045c240637d027ceb4ef111a95" kindref="member">fitfun</ref>;</highlight></codeline>
<codeline lineno="508" refid="classacmaes_1_1_acmaes_optimizer_1a73710e1f7b550eb765980f6d8205acd2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a73710e1f7b550eb765980f6d8205acd2" kindref="member">guess</ref>;</highlight></codeline>
<codeline lineno="509" refid="classacmaes_1_1_acmaes_optimizer_1af49bb3ec0e42ef7f4cbfe3934abc026a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1af49bb3ec0e42ef7f4cbfe3934abc026a" kindref="member">accuracy</ref>;</highlight></codeline>
<codeline lineno="510" refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1abc8fbb4d336cd6525618902f212e9071" kindref="member">popsize</ref>;<sp/></highlight><highlight class="comment">//<sp/>population<sp/>size</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="511" refid="classacmaes_1_1_acmaes_optimizer_1aa64448926972de66e258f3eae95993d4" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1aa64448926972de66e258f3eae95993d4" kindref="member">inputSigma</ref>;</highlight></codeline>
<codeline lineno="512" refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29e0940b9fe073e2cf0879010ddd619a" kindref="member">dim</ref>;</highlight></codeline>
<codeline lineno="513" refid="classacmaes_1_1_acmaes_optimizer_1a64b1dc96aadfd73ac75ac18f602a4be5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a64b1dc96aadfd73ac75ac18f602a4be5" kindref="member">maxEvaluations</ref>;</highlight></codeline>
<codeline lineno="514" refid="classacmaes_1_1_acmaes_optimizer_1a8257d791e3d09fefa27942e2842a02f5" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a8257d791e3d09fefa27942e2842a02f5" kindref="member">stopfitness</ref>;</highlight></codeline>
<codeline lineno="515" refid="classacmaes_1_1_acmaes_optimizer_1acd6aa48f968c88bbf105a05bc2b66112" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1acd6aa48f968c88bbf105a05bc2b66112" kindref="member">stopTolUpX</ref>;</highlight></codeline>
<codeline lineno="516" refid="classacmaes_1_1_acmaes_optimizer_1a676d55f32118eeb0bdf0546721f9ae23" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a676d55f32118eeb0bdf0546721f9ae23" kindref="member">stopTolX</ref>;</highlight></codeline>
<codeline lineno="517" refid="classacmaes_1_1_acmaes_optimizer_1a14dd207015f4c247ca4a80c683a8b0f6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a14dd207015f4c247ca4a80c683a8b0f6" kindref="member">stopTolFun</ref>;</highlight></codeline>
<codeline lineno="518" refid="classacmaes_1_1_acmaes_optimizer_1a93f72fbef497480928c9e7b04123e930" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a93f72fbef497480928c9e7b04123e930" kindref="member">stopTolHistFun</ref>;</highlight></codeline>
<codeline lineno="519" refid="classacmaes_1_1_acmaes_optimizer_1a9fba5c1ce916fdda28b4e9af75ef693f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a9fba5c1ce916fdda28b4e9af75ef693f" kindref="member">mu</ref>;<sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="520" refid="classacmaes_1_1_acmaes_optimizer_1a535998e869d050bac252c34d8b570b0f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a535998e869d050bac252c34d8b570b0f" kindref="member">weights</ref>;</highlight></codeline>
<codeline lineno="521" refid="classacmaes_1_1_acmaes_optimizer_1a12077354f7b80409fe6506c29b4f9d05" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a12077354f7b80409fe6506c29b4f9d05" kindref="member">mueff</ref>;<sp/></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="522" refid="classacmaes_1_1_acmaes_optimizer_1a9290a3cb7cec20b03d78ccc1b53a06dc" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a9290a3cb7cec20b03d78ccc1b53a06dc" kindref="member">sigma</ref>;</highlight></codeline>
<codeline lineno="523" refid="classacmaes_1_1_acmaes_optimizer_1adda41c9a7372cec6cbe9277c09117829" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1adda41c9a7372cec6cbe9277c09117829" kindref="member">cc</ref>;</highlight></codeline>
<codeline lineno="524" refid="classacmaes_1_1_acmaes_optimizer_1ab72d93c09c86ab626df76157673b5d57" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ab72d93c09c86ab626df76157673b5d57" kindref="member">cs</ref>;</highlight></codeline>
<codeline lineno="525" refid="classacmaes_1_1_acmaes_optimizer_1a42ca377b32c9aba2a082b73203c7dddd" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a42ca377b32c9aba2a082b73203c7dddd" kindref="member">damps</ref>;</highlight></codeline>
<codeline lineno="526" refid="classacmaes_1_1_acmaes_optimizer_1a8a406c0b2eac5e1e7c775e6951858172" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a8a406c0b2eac5e1e7c775e6951858172" kindref="member">ccov1</ref>;</highlight></codeline>
<codeline lineno="527" refid="classacmaes_1_1_acmaes_optimizer_1ad5f6392eb25c1d4afeeab490c8d1556f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ad5f6392eb25c1d4afeeab490c8d1556f" kindref="member">ccovmu</ref>;</highlight></codeline>
<codeline lineno="528" refid="classacmaes_1_1_acmaes_optimizer_1a6bff526b6be45c84a7196b26f9c10375" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a6bff526b6be45c84a7196b26f9c10375" kindref="member">chiN</ref>;</highlight></codeline>
<codeline lineno="529" refid="classacmaes_1_1_acmaes_optimizer_1ab663ec0cbe33131f3d5c9b5f30236b8b" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ab663ec0cbe33131f3d5c9b5f30236b8b" kindref="member">ccov1Sep</ref>;</highlight></codeline>
<codeline lineno="530" refid="classacmaes_1_1_acmaes_optimizer_1ac2566f3a92b546f094a7bb8ec5d87de6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ac2566f3a92b546f094a7bb8ec5d87de6" kindref="member">ccovmuSep</ref>;</highlight></codeline>
<codeline lineno="531" refid="classacmaes_1_1_acmaes_optimizer_1a56b024cd6dc9dfcc03b282918f905d4d" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a56b024cd6dc9dfcc03b282918f905d4d" kindref="member">lazy_update_gap</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="532" refid="classacmaes_1_1_acmaes_optimizer_1a7824c6afa9a2633c7e24d71db2f52787" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a7824c6afa9a2633c7e24d71db2f52787" kindref="member">xmean</ref>;</highlight></codeline>
<codeline lineno="533" refid="classacmaes_1_1_acmaes_optimizer_1a3b2ec952c9c29e2c8fe353a7eb7b3a6f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a3b2ec952c9c29e2c8fe353a7eb7b3a6f" kindref="member">pc</ref>;</highlight></codeline>
<codeline lineno="534" refid="classacmaes_1_1_acmaes_optimizer_1a941f1cfcd98230d2022fb506e62b96df" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a941f1cfcd98230d2022fb506e62b96df" kindref="member">ps</ref>;</highlight></codeline>
<codeline lineno="535" refid="classacmaes_1_1_acmaes_optimizer_1adffd8b681b2402481801e0cc34b9d6e2" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1adffd8b681b2402481801e0cc34b9d6e2" kindref="member">normps</ref>;</highlight></codeline>
<codeline lineno="536" refid="classacmaes_1_1_acmaes_optimizer_1a326b26c7190938716b46310b7985fb1f" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a326b26c7190938716b46310b7985fb1f" kindref="member">B</ref>;</highlight></codeline>
<codeline lineno="537" refid="classacmaes_1_1_acmaes_optimizer_1a28b375f6c8c9333a8d11169a4b4bbf51" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a28b375f6c8c9333a8d11169a4b4bbf51" kindref="member">BD</ref>;</highlight></codeline>
<codeline lineno="538" refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822048c321fe48fe4615a8fcb92e31a7" kindref="member">diagD</ref>;</highlight></codeline>
<codeline lineno="539" refid="classacmaes_1_1_acmaes_optimizer_1aff3401adacb15732828daef99c6d7dab" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1aff3401adacb15732828daef99c6d7dab" kindref="member">C</ref>;</highlight></codeline>
<codeline lineno="540" refid="classacmaes_1_1_acmaes_optimizer_1af0d9962901e706966ac55076a9123de0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1af0d9962901e706966ac55076a9123de0" kindref="member">diagC</ref>;</highlight></codeline>
<codeline lineno="541" refid="classacmaes_1_1_acmaes_optimizer_1a29fdebcd5e9fe0daa7d3ab4b6b4eaf66" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a29fdebcd5e9fe0daa7d3ab4b6b4eaf66" kindref="member">arz</ref>;</highlight></codeline>
<codeline lineno="542" refid="classacmaes_1_1_acmaes_optimizer_1a54b9d653087f054270a377aeafa63e02" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a54b9d653087f054270a377aeafa63e02" kindref="member">arx</ref>;</highlight></codeline>
<codeline lineno="543" refid="classacmaes_1_1_acmaes_optimizer_1ae72ada0035312e1bb1edf6ad35204f71" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ae72ada0035312e1bb1edf6ad35204f71" kindref="member">fitness</ref>;</highlight></codeline>
<codeline lineno="544" refid="classacmaes_1_1_acmaes_optimizer_1a2c9bbb5f803acf531a67986025d0e913" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a2c9bbb5f803acf531a67986025d0e913" kindref="member">iterations</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="545" refid="classacmaes_1_1_acmaes_optimizer_1ad2efb063f4c0954c1870313b98667bd0" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1ad2efb063f4c0954c1870313b98667bd0" kindref="member">last_update</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="546" refid="classacmaes_1_1_acmaes_optimizer_1a4f8eb45ad2bbe6ee494dc655173f2f86" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a4f8eb45ad2bbe6ee494dc655173f2f86" kindref="member">fitnessHistory</ref>;</highlight></codeline>
<codeline lineno="547" refid="classacmaes_1_1_acmaes_optimizer_1a51907ba6ceea0937ac45997d424ca5ed" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a51907ba6ceea0937ac45997d424ca5ed" kindref="member">historySize</ref>;</highlight></codeline>
<codeline lineno="548" refid="classacmaes_1_1_acmaes_optimizer_1a13682ca7e26ba1755a7a7b09d446ac8a" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a13682ca7e26ba1755a7a7b09d446ac8a" kindref="member">bestValue</ref>;</highlight></codeline>
<codeline lineno="549" refid="classacmaes_1_1_acmaes_optimizer_1acfda423e0a6771582cf79f67f0e66954" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1acfda423e0a6771582cf79f67f0e66954" kindref="member">bestX</ref>;</highlight></codeline>
<codeline lineno="550" refid="classacmaes_1_1_acmaes_optimizer_1a1529659459b814102415217b9ce822c6" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a1529659459b814102415217b9ce822c6" kindref="member">stop</ref>;</highlight></codeline>
<codeline lineno="551" refid="classacmaes_1_1_acmaes_optimizer_1afeb20b9c89d465d55e43c1da48beba53" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1afeb20b9c89d465d55e43c1da48beba53" kindref="member">told</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="552" refid="classacmaes_1_1_acmaes_optimizer_1a6484fd82e910d1481f21c2c85a267f56" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/>pcg64<sp/>*<ref refid="classacmaes_1_1_acmaes_optimizer_1a6484fd82e910d1481f21c2c85a267f56" kindref="member">rs</ref>;</highlight></codeline>
<codeline lineno="553" refid="classacmaes_1_1_acmaes_optimizer_1a822ff0e80ba2c337ea65b4b361d7b332" refkind="member"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer_1a822ff0e80ba2c337ea65b4b361d7b332" kindref="member">computeArz</ref>;</highlight></codeline>
<codeline lineno="554"><highlight class="normal">};</highlight></codeline>
<codeline lineno="555"><highlight class="normal">}</highlight></codeline>
<codeline lineno="556"><highlight class="normal"></highlight></codeline>
<codeline lineno="557"><highlight class="normal"></highlight><highlight class="keyword">using<sp/>namespace<sp/></highlight><highlight class="normal"><ref refid="namespaceacmaes" kindref="compound">acmaes</ref>;</highlight></codeline>
<codeline lineno="558"><highlight class="normal"></highlight></codeline>
<codeline lineno="559"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;C&quot;</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="560" refid="acmaesoptimizer_8cpp_1afc81c91b36bdd348c03d272ec53f027a" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="acmaesoptimizer_8cpp_1afc81c91b36bdd348c03d272ec53f027a" kindref="member">optimizeACMA_C</ref>(</highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>runid,<sp/><ref refid="evaluator_8h_1af419da391481d5e767cbe038009da309" kindref="member">callback_type</ref><sp/>func,<sp/><ref refid="evaluator_8h_1a1adc681c70e547867358d25d5cf7eedc" kindref="member">callback_parallel</ref><sp/>func_par,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dim,</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*init,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*lower,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*upper,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*sigma,</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>maxEvals,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>stopfitness,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>stopTolHistFun,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>mu,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>popsize,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>accuracy,</highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>seed,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>normalize,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>use_delayed_update,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>update_gap,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>workers,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*<sp/>res)<sp/>{</highlight></codeline>
<codeline lineno="564"><highlight class="normal"></highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>guess(dim),<sp/>lower_limit(dim),<sp/>upper_limit(dim),<sp/>inputSigma(dim);</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>dim;<sp/>i++)<sp/>{</highlight><highlight class="comment">//<sp/>guess<sp/>is<sp/>mandatory</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>guess[i]<sp/>=<sp/>init[i];</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputSigma[i]<sp/>=<sp/>sigma[i];</highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(lower<sp/>!=<sp/>NULL<sp/>&amp;&amp;<sp/>upper<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>dim;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>guess[i]<sp/>=<sp/>init[i];</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lower_limit[i]<sp/>=<sp/>lower[i];</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upper_limit[i]<sp/>=<sp/>upper[i];</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lower_limit.resize(0);</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upper_limit.resize(0);</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>normalize<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="581"><highlight class="normal"></highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_fitness" kindref="compound">Fitness</ref><sp/>fitfun(func,<sp/>func_par,<sp/>dim,<sp/>1,<sp/>lower_limit,<sp/>upper_limit);</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/>fitfun.<ref refid="class_fitness_1a31beb7ecb5fa49ac03b43abe444ab9a6" kindref="member">setNormalize</ref>(normalize);</highlight></codeline>
<codeline lineno="584"><highlight class="normal"></highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer" kindref="compound">AcmaesOptimizer</ref><sp/>opt(runid,<sp/>&amp;fitfun,<sp/>popsize,<sp/>mu,<sp/>guess,<sp/>inputSigma,</highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>maxEvals,<sp/>accuracy,<sp/>stopfitness,<sp/>stopTolHistFun,<sp/>update_gap,<sp/>seed);</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>evals<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(workers<sp/>&gt;<sp/>1<sp/>&amp;&amp;<sp/>use_delayed_update)</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>evals<sp/>=<sp/>opt.do_optimize_delayed_update(workers);</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>evals<sp/>=<sp/>opt.doOptimize();</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>bestX<sp/>=<sp/>opt.getBestX();</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>bestY<sp/>=<sp/>opt.getBestValue();</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>dim;<sp/>i++)</highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res[i]<sp/>=<sp/>bestX[i];</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res[dim]<sp/>=<sp/>bestY;</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res[dim<sp/>+<sp/>1]<sp/>=<sp/>evals;</highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res[dim<sp/>+<sp/>2]<sp/>=<sp/>opt.getIterations();</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res[dim<sp/>+<sp/>3]<sp/>=<sp/>opt.getStop();</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(std::exception<sp/>&amp;e)<sp/>{</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cout<sp/>&lt;&lt;<sp/>e.what()<sp/>&lt;&lt;<sp/>endl;</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="604"><highlight class="normal">}</highlight></codeline>
<codeline lineno="605"><highlight class="normal"></highlight></codeline>
<codeline lineno="606" refid="acmaesoptimizer_8cpp_1ab128d45080b4023edb28550611997afe" refkind="member"><highlight class="normal">uintptr_t<sp/><ref refid="acmaesoptimizer_8cpp_1ab128d45080b4023edb28550611997afe" kindref="member">initACMA_C</ref>(</highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>runid,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dim,</highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*init,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*lower,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*upper,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>*sigma,</highlight></codeline>
<codeline lineno="608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>maxEvals,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>stopfitness,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>stopTolHistFun,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>mu,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>popsize,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>accuracy,</highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">long</highlight><highlight class="normal"><sp/>seed,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>normalize,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>use_delayed_update,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>update_gap)<sp/>{</highlight></codeline>
<codeline lineno="610"><highlight class="normal"></highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>guess(dim),<sp/>lower_limit(dim),<sp/>upper_limit(dim),<sp/>inputSigma(dim);</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>dim;<sp/>i++)<sp/>{</highlight><highlight class="comment">//<sp/>guess<sp/>is<sp/>mandatory</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>guess[i]<sp/>=<sp/>init[i];</highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>inputSigma[i]<sp/>=<sp/>sigma[i];</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(lower<sp/>!=<sp/>NULL<sp/>&amp;&amp;<sp/>upper<sp/>!=<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>dim;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>guess[i]<sp/>=<sp/>init[i];</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lower_limit[i]<sp/>=<sp/>lower[i];</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upper_limit[i]<sp/>=<sp/>upper[i];</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>lower_limit.resize(0);</highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>upper_limit.resize(0);</highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>normalize<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="627"><highlight class="normal"></highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_fitness" kindref="compound">Fitness</ref>*<sp/>fitfun<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="class_fitness" kindref="compound">Fitness</ref>(<ref refid="evaluator_8h_1ad0943ebd623281f526e5aee2aa818895" kindref="member">noop_callback</ref>,<sp/><ref refid="evaluator_8h_1ac05c49788a31e5f7cb8efbe8ca3b548e" kindref="member">noop_callback_par</ref>,<sp/>dim,<sp/>1,<sp/>lower_limit,<sp/>upper_limit);<sp/></highlight><highlight class="comment">//<sp/>never<sp/>used<sp/>here</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/>fitfun-&gt;<ref refid="class_fitness_1a31beb7ecb5fa49ac03b43abe444ab9a6" kindref="member">setNormalize</ref>(normalize);</highlight></codeline>
<codeline lineno="630"><highlight class="normal"></highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer" kindref="compound">AcmaesOptimizer</ref>*<sp/>opt<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="classacmaes_1_1_acmaes_optimizer" kindref="compound">AcmaesOptimizer</ref>(runid,<sp/>fitfun,<sp/>popsize,<sp/>mu,<sp/>guess,<sp/>inputSigma,</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>maxEvals,<sp/>accuracy,<sp/>stopfitness,<sp/>stopTolHistFun,<sp/>update_gap,<sp/>seed);</highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(uintptr_t)<sp/>opt;</highlight></codeline>
<codeline lineno="634"><highlight class="normal">}</highlight></codeline>
<codeline lineno="635"><highlight class="normal"></highlight></codeline>
<codeline lineno="636" refid="acmaesoptimizer_8cpp_1a7b2394fc01d8d5612733f943d54a8982" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="acmaesoptimizer_8cpp_1a7b2394fc01d8d5612733f943d54a8982" kindref="member">destroyACMA_C</ref>(uintptr_t<sp/>ptr)<sp/>{</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer" kindref="compound">AcmaesOptimizer</ref>*<sp/>opt<sp/>=<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer" kindref="compound">AcmaesOptimizer</ref>*)ptr;</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_fitness" kindref="compound">Fitness</ref>*<sp/>fitfun<sp/>=<sp/>opt-&gt;getFitfun();</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>fitfun;</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>opt;</highlight></codeline>
<codeline lineno="641"><highlight class="normal">}</highlight></codeline>
<codeline lineno="642"><highlight class="normal"></highlight></codeline>
<codeline lineno="643" refid="acmaesoptimizer_8cpp_1afd9ea227572135d9dd02fe7ec9d489e4" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="acmaesoptimizer_8cpp_1afd9ea227572135d9dd02fe7ec9d489e4" kindref="member">askACMA_C</ref>(uintptr_t<sp/>ptr,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*<sp/>xs)<sp/>{</highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer" kindref="compound">AcmaesOptimizer</ref><sp/>*opt<sp/>=<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer" kindref="compound">AcmaesOptimizer</ref>*)<sp/>ptr;</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n<sp/>=<sp/>opt-&gt;getDim();</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>popsize<sp/>=<sp/>opt-&gt;getPopsize();</highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/>opt-&gt;popX<sp/>=<sp/>opt-&gt;ask_all();</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_fitness" kindref="compound">Fitness</ref>*<sp/>fitfun<sp/>=<sp/>opt-&gt;getFitfun();</highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>p<sp/>=<sp/>0;<sp/>p<sp/>&lt;<sp/>popsize;<sp/>p++)<sp/>{</highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>x<sp/>=<sp/>fitfun-&gt;<ref refid="class_fitness_1a7fdca1fda75e3976b91e1e9e0eb12057" kindref="member">decode</ref>(opt-&gt;popX.col(p));</highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n;<sp/>i++)</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xs[p<sp/>*<sp/>n<sp/>+<sp/>i]<sp/>=<sp/>x[i];</highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="654"><highlight class="normal">}</highlight></codeline>
<codeline lineno="655"><highlight class="normal"></highlight></codeline>
<codeline lineno="656" refid="acmaesoptimizer_8cpp_1a2cb3fdf36ee5dee68f436f1efa6be820" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="acmaesoptimizer_8cpp_1a2cb3fdf36ee5dee68f436f1efa6be820" kindref="member">tellACMA_C</ref>(uintptr_t<sp/>ptr,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*<sp/>ys)<sp/>{</highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer" kindref="compound">AcmaesOptimizer</ref><sp/>*opt<sp/>=<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer" kindref="compound">AcmaesOptimizer</ref>*)<sp/>ptr;</highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>popsize<sp/>=<sp/>opt-&gt;getPopsize();</highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>vals(popsize);</highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>popsize;<sp/>i++)</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vals[i]<sp/>=<sp/>ys[i];</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/>opt-&gt;tell_all_asked(vals,<sp/>opt-&gt;popX);</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>opt-&gt;getStop();</highlight></codeline>
<codeline lineno="664"><highlight class="normal">}</highlight></codeline>
<codeline lineno="665"><highlight class="normal"></highlight></codeline>
<codeline lineno="666" refid="acmaesoptimizer_8cpp_1ac4c1234b83df26634971a6707db1809d" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="acmaesoptimizer_8cpp_1ac4c1234b83df26634971a6707db1809d" kindref="member">tellXACMA_C</ref>(uintptr_t<sp/>ptr,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*<sp/>ys,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*<sp/>xs)<sp/>{</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer" kindref="compound">AcmaesOptimizer</ref><sp/>*opt<sp/>=<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer" kindref="compound">AcmaesOptimizer</ref>*)<sp/>ptr;</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>popsize<sp/>=<sp/>opt-&gt;getPopsize();</highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dim<sp/>=<sp/>opt-&gt;getDim();</highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_fitness" kindref="compound">Fitness</ref>*<sp/>fitfun<sp/>=<sp/>opt-&gt;getFitfun();</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/>opt-&gt;popX<sp/>=<sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref>(dim,<sp/>popsize);</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>p<sp/>=<sp/>0;<sp/>p<sp/>&lt;<sp/>popsize;<sp/>p++)<sp/>{</highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>x(dim);</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>dim;<sp/>i++)</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x[i]<sp/>=<sp/>xs[p<sp/>*<sp/>dim<sp/>+<sp/>i];</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>opt-&gt;popX.col(p)<sp/>=<sp/>fitfun-&gt;<ref refid="class_fitness_1ab56956f8f382ffe1b9de9d35d156a65e" kindref="member">encode</ref>(x);</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>vals(popsize);</highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>popsize;<sp/>i++)</highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>vals[i]<sp/>=<sp/>ys[i];</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/>opt-&gt;tell_all(vals,<sp/>opt-&gt;popX);</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>opt-&gt;getStop();</highlight></codeline>
<codeline lineno="683"><highlight class="normal">}</highlight></codeline>
<codeline lineno="684"><highlight class="normal"></highlight></codeline>
<codeline lineno="685" refid="acmaesoptimizer_8cpp_1a76a358e67b1d48a0f0f7813dd201efdf" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="acmaesoptimizer_8cpp_1a76a358e67b1d48a0f0f7813dd201efdf" kindref="member">populationACMA_C</ref>(uintptr_t<sp/>ptr,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*<sp/>xs)<sp/>{</highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer" kindref="compound">AcmaesOptimizer</ref><sp/>*opt<sp/>=<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer" kindref="compound">AcmaesOptimizer</ref>*)<sp/>ptr;</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>dim<sp/>=<sp/>opt-&gt;getDim();</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>popsize<sp/>=<sp/>opt-&gt;getPopsize();</highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1af0f7533253586ad2aba962e9537d90bc" kindref="member">mat</ref><sp/>popX<sp/>=<sp/>opt-&gt;getPopulation();</highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>p<sp/>=<sp/>0;<sp/>p<sp/>&lt;<sp/>popsize;<sp/>p++)<sp/>{</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>x<sp/>=<sp/>popX.col(p);</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>dim;<sp/>i++)</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x[i]<sp/>=<sp/>xs[p<sp/>*<sp/>dim<sp/>+<sp/>i];</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>opt-&gt;getStop();</highlight></codeline>
<codeline lineno="696"><highlight class="normal">}</highlight></codeline>
<codeline lineno="697"><highlight class="normal"></highlight></codeline>
<codeline lineno="698" refid="acmaesoptimizer_8cpp_1abe96370a07bb4c8fff0bc6e13e105c29" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="acmaesoptimizer_8cpp_1abe96370a07bb4c8fff0bc6e13e105c29" kindref="member">resultACMA_C</ref>(uintptr_t<sp/>ptr,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*<sp/>res)<sp/>{</highlight></codeline>
<codeline lineno="699"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classacmaes_1_1_acmaes_optimizer" kindref="compound">AcmaesOptimizer</ref><sp/>*opt<sp/>=<sp/>(<ref refid="classacmaes_1_1_acmaes_optimizer" kindref="compound">AcmaesOptimizer</ref>*)<sp/>ptr;</highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="daoptimizer_8cpp_1aeb2fc0d8c764908dd0b77ed5ab437c3f" kindref="member">vec</ref><sp/>bestX<sp/>=<sp/>opt-&gt;getBestX();</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>bestY<sp/>=<sp/>opt-&gt;getBestValue();</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n<sp/>=<sp/>bestX.size();</highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>bestX.size();<sp/>i++)</highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res[i]<sp/>=<sp/>bestX[i];</highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/>res[n]<sp/>=<sp/>bestY;</highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="class_fitness" kindref="compound">Fitness</ref>*<sp/>fitfun<sp/>=<sp/>opt-&gt;getFitfun();</highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/>res[n<sp/>+<sp/>1]<sp/>=<sp/>fitfun-&gt;<ref refid="class_fitness_1aba60038eac4e0e15d995e57f4ba079e1" kindref="member">evaluations</ref>();</highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/>res[n<sp/>+<sp/>2]<sp/>=<sp/>opt-&gt;getIterations();</highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/>res[n<sp/>+<sp/>3]<sp/>=<sp/>opt-&gt;getStop();</highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>opt-&gt;getStop();</highlight></codeline>
<codeline lineno="711"><highlight class="normal">}</highlight></codeline>
<codeline lineno="712"><highlight class="normal"></highlight></codeline>
<codeline lineno="713" refid="acmaesoptimizer_8cpp_1a679cc7980203dbcbbe97d11014fdb5bf" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="acmaesoptimizer_8cpp_1a679cc7980203dbcbbe97d11014fdb5bf" kindref="member">testACMA_C</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n,<sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal">*<sp/>res)<sp/>{</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>n;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cout<sp/>&lt;&lt;<sp/>i<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;:<sp/>&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>res[i]<sp/>&lt;&lt;<sp/>endl;</highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>res[i]<sp/>=<sp/>-res[i];</highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>7;</highlight></codeline>
<codeline lineno="719"><highlight class="normal">}</highlight></codeline>
<codeline lineno="720"><highlight class="normal"></highlight></codeline>
<codeline lineno="721"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="_fcmaescpp/acmaesoptimizer.cpp"/>
  </compounddef>
</doxygen>
